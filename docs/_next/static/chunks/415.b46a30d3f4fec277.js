"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[415],{415:function(t,e,i){i.r(e),i.d(e,{default:function(){return gi}});var n=i(5893),o=Object.freeze({ResourceBaseUrl:"/game_sources/escape_game_1/assets/"}),r=i(8866),s=i(3631);function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loop=!1,this.played=!1,this.paused=!1,this.offset=0,this.playedAt=0,this.volumeRate=void 0,p.sharedContext&&(this.buffer=e,this.gainNode=p.sharedContext.createGain())}var e,i,n,o=t.prototype;return o.play=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=this,o=p.sharedContext;o&&(this.loop=t,this.source=o.createBufferSource(),this.source.loop=this.loop,this.source.loopStart=0,this.source.loopEnd=this.buffer.duration,this.source.buffer=this.buffer,this.source.onended=function(){return n.stop()},i?(this.gainNode.gain.value=t?p.bgmVolume*i:p.seVolume*i,this.volumeRate=i):this.gainNode.gain.value=t?p.bgmVolume:p.seVolume,this.gainNode.connect(o.destination),this.source.connect(this.gainNode),this.source.start(0,e),this.played=!0,this.playedAt=o.currentTime-e,this.paused=!1)},o.stop=function(){if(this.source&&this.played){this.source.disconnect();try{this.source.buffer=null}catch(t){}this.source.onended=null,this.source=null,this.paused=!1}},o.pause=function(){!this.paused&&this.played&&this.source&&(this.offset=this.elapsedTime,this.stop(),this.paused=!0)},o.resume=function(){this.paused&&this.played&&(this.play(this.loop,this.offset,this.volumeRate),this.paused=!1)},o.isPosed=function(){return this.paused},e=t,(i=[{key:"volume",get:function(){return this.gainNode?this.gainNode.gain.value:-1},set:function(t){this.gainNode&&(this.gainNode.gain.value=t)}},{key:"elapsedTime",get:function(){if(this.paused)return this.offset;var t=p.sharedContext;if(!this.source||!t)return 0;var e=t.currentTime-this.playedAt;if(this.loop){var i=this.source.loopEnd-this.source.loopStart;if(e>i)return e%i}return e}}])&&a(e.prototype,i),n&&a(e,n),t}();var c=window.indexedDB||window.webkitIndexedDB,l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.init=function(e,i){if(!c)throw new Error("indexed db is not supported");var n=c.open(t.dbName,t.dbVersion);n.onupgradeneeded=function(e){t.upgradeDB(e)},n.onsuccess=function(e){var n=e.target.result;t.db=n,i()},n.onerror=function(t){return e(t)}},t.put=function(e,i,n,o){var r=t.getStoreObject();if(r){var s=t.createRecordObject(e,i),a=r.put(s);n&&(a.onsuccess=function(t){n(t)}),o&&(a.onerror=function(t){o(t)})}else o&&o()},t.get=function(e,i,n){var o=t.getStoreObject();if(o){var r=o.get(e);r.onsuccess=function(t){var e=t.target.result;e?i(e.value,e.key):i(void 0,void 0)},n&&(r.onerror=function(t){n(t)})}else n&&n()},t.delete=function(e,i,n){var o=t.getStoreObject();if(o){var r=o.delete(e);i&&(r.onsuccess=function(t){i(t)}),n&&(r.onerror=function(t){n(t)})}else n&&n()},t.clear=function(e,i){var n=t.getStoreObject();if(n){var o=n.clear();e&&(o.onsuccess=function(t){e(t)}),i&&(o.onerror=function(t){i(t)})}else i&&i()},t.upgradeDB=function(e){var i=e.target.result,n=t.storeIndex,o=t.storeName;i.createObjectStore(o,{keyPath:n}).createIndex(n,n,{unique:!0})},t.getStoreObject=function(){if(!t.db)return null;var e=t.storeName;return t.db.transaction(e,"readwrite").objectStore(e)},t.createRecordObject=function(t,e){return{key:t,value:e}},t}();function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}l.dbName="escape-game-db",l.dbVersion=1,l.storeName="escape-game-store",l.storeIndex="key",l.db=null;var p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,n;return t.init=function(e){if(e)t.context=e;else{var i=window.AudioContext||window.webkitAudioContext;t.context=new i}var n=(0,s.qY)();n&&(t.setSoundInitializeEvent(n),t.useWebAudio(),t.setWindowLifeCycleEvent(n))},t.update=function(e){if(t.sharedContext){var i=t.killingSounds;if(i.length>0){var n=[],o=!0,r=!1,s=void 0;try{for(var a,u=i[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;t.sharedContext.currentTime>=c.endAt?c.sound.stop():n.push(c)}}catch(l){r=!0,s=l}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}t.killingSounds=n}}},t.useWebAudio=function(){if(!t.webAudioInitialized){var e=t.supportedExtensions,i=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var u=s.value,c=r.kCJ;c.setExtensionXhrType(u,c.XHR_RESPONSE_TYPE.BUFFER),c.setExtensionLoadType(u,c.LOAD_TYPE.XHR)}}catch(l){n=!0,o=l}finally{try{i||null==a.return||a.return()}finally{if(n)throw o}}f.game.loader.use(t.parsingMiddleware()),t.webAudioInitialized=!0}},t.parsingMiddleware=function(){return function(e,i){var n,o=t.supportedExtensions,r=e.url.split(".")[1];r&&-1!==o.indexOf(r)?null===(n=t.sharedContext)||void 0===n||n.decodeAudioData(e.data,(function(t){e.buffer=t,i()})):i()}},t.setSoundInitializeEvent=function(e){var i,n=void 0===document.ontouchend?"mousedown":"touched",o=e.version?e.version.split(".")[0]:"0";if("chrome"===e.name&&Number.parseInt(o,10)>=66)i=function(){t.sharedContext&&t.sharedContext.resume(),document.body.removeEventListener(n,i)};else{if("safari"!==e.name)return;i=function(){if(t.sharedContext){var e=t.sharedContext.createBufferSource();e.buffer=t.sharedContext.createBuffer(1,1,44100),e.connect(t.sharedContext.destination),e.start(0),e.disconnect()}document.body.removeEventListener(n,i)}}document.body.addEventListener(n,i)},t.setWindowLifeCycleEvent=function(e){"safari"===e.name?document.addEventListener("webkitvisibilitychange",(function(){document.webkitHidden?t.pauseBgm():t.resumeBgm()})):document.addEventListener("visibilitychange",(function(){document.hidden?t.pauseBgm():t.resumeBgm()}))},t.registerSound=function(e,i){t.managedSounds.set(e,i)},t.unregisterSound=function(e){t.managedSounds.delete(e)},t.getSound=function(e){return t.managedSounds.get(e)},t.createSound=function(e,i){var n=new u(i);return t.registerSound(e,n),n},t.hasSound=function(e){return t.managedSounds.has(e)},t.destroySound=function(e){var i=this.getSound(e);t.unregisterSound(e),null===i||void 0===i||i.stop()},t.pauseBgm=function(){t.paused||(t.paused=!0,t.managedSounds.forEach((function(t){t.pause()})))},t.resumeBgm=function(){t.sceneIsPaused||t.paused&&(t.paused=!1,t.managedSounds.forEach((function(t){t.resume()})))},t.fade=function(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.sharedContext){var r=t.sharedContext.currentTime+n;e.gainNode.gain.exponentialRampToValueAtTime(i,r),o&&t.killingSounds.push({sound:e,endAt:r})}},t.playBgm=function(e,i){var n=t.getSound(e);null===n||void 0===n||n.play(!0,0,i)},t.stopBgm=function(e){var i=t.getSound(e);null===i||void 0===i||i.stop()},t.playSe=function(e){var i=t.getSound(e);null===i||void 0===i||i.play()},t.setSoundVolume=function(e,i){t.managedSounds.forEach((function(t){t.loop?t.volume=e:t.volume=i}))},t.loadSoundOptionFromDB=function(){l.get("bgmVolume",(function(e){t.bgmVolume=0===e?0:e||.05})),l.get("seVolume",(function(e){t.seVolume=0===e?0:e||.5}))},e=t,n=[{key:"sharedContext",get:function(){return t.context}}],(i=null)&&h(e.prototype,i),n&&h(e,n),t}();p.supportedExtensions=["mp3"],p.webAudioInitialized=!1,p.context=null,p.paused=!1,p.killingSounds=[],p.managedSounds=new Map,p.sceneIsPaused=!1;var f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.start=function(e){t.game=new r.MxU(e),l.init((function(t){throw new Error("indexed db could not be initialized")}),(function(){p.loadSoundOptionFromDB()})),p.init();var i=document.getElementById("play-game");i&&(i.appendChild(t.game.view),t.game.loader.baseUrl=o.ResourceBaseUrl,t.game.ticker.add((function(e){var i;null===(i=t.currentScene)||void 0===i||i.update(e),p.update(e)})),t.resizeCanvas(),window.addEventListener("resize",t.resizeCanvas))},t.transitionInIfPossible=function(e){var i;return!(!t.sceneResourceLoaded||!t.sceneTransitionOutFinished)&&(null===(i=t.currentScene)||void 0===i||i.destroy(),t.currentScene=e,t.game.stage.addChild(e),e.beginTransitionIn((function(){})),!0)},t.loadScene=function(e){t.currentScene?(t.sceneResourceLoaded=!1,t.sceneTransitionOutFinished=!1,e.beginLoadResource((function(){t.sceneResourceLoaded=!0,t.transitionInIfPossible(e)})),t.currentScene.beginTransitionOut((function(){t.sceneTransitionOutFinished=!0,t.transitionInIfPossible(e)}))):(t.sceneTransitionOutFinished=!0,e.beginLoadResource((function(){t.sceneResourceLoaded=!0,t.transitionInIfPossible(e)})))},t.resizeCanvas=function(){var e,i,n=t.game,o=n.renderer,r=o.width/o.height;window.innerWidth/window.innerHeight>r?(e=window.innerHeight*(o.width/o.height),i=window.innerHeight):(e=window.innerWidth,i=window.innerWidth*(o.height/o.width)),(e>=500||i>=500)&&(e=500,i=500),n.view.style.width="".concat(e-20,"px"),n.view.style.height="".concat(i-20,"px")},t}();f.sceneTransitionOutFinished=!0,f.sceneResourceLoaded=!1;var d=i(4051),m=i.n(d);var y=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=new r.W20,this.overlay=new r.TCu,this.transitionBegan=!1,this.transitionFinished=!1,this.onTransitionFinished=function(){},this.afterFinishedVisible=!1,this.alphaFrom=e,this.alphaTo=i,this.alphaProgress=n;var o=f.game.view.width,s=f.game.view.height;this.overlay.beginFill(0),this.overlay.moveTo(0,0),this.overlay.lineTo(o,0),this.overlay.lineTo(o,s),this.overlay.lineTo(0,s),this.overlay.endFill(),this.overlay.alpha=this.alphaFrom,this.container.addChild(this.overlay)}var e=t.prototype;return e.getContainer=function(){return this.container},e.begin=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.afterFinishedVisible=t,this.container.visible=!0,this.overlay.alpha=this.alphaFrom,this.transitionBegan=!0,this.transitionFinished=!1},e.isBegan=function(){return this.transitionBegan},e.isFinished=function(){return this.transitionFinished},e.isActive=function(){return this.isBegan()&&!this.isFinished()},e.update=function(t){this.alphaTo<=this.alphaFrom&&this.overlay.alpha<=this.alphaTo||this.alphaTo>=this.alphaFrom&&this.overlay.alpha>=this.alphaTo?(this.afterFinishedVisible||(this.container.visible=!1),this.transitionBegan=!1,this.onTransitionFinished(),this.transitionFinished=!0):this.overlay.alpha+=this.alphaProgress},e.setCallback=function(t){this.onTransitionFinished=t},t}(),g=Object.freeze({NOTHING:0,CAR_KEY:1,DESK_KEY:2,BANANA:3,PENCIL:4,NAIL:5,SALT:6,TIN_STATUE:7,COIN:8,CROSSBOW:9,DETERGENT:10,HAND_MIRROR:11,DVD:12,FROZEN_BANANA:13,SHARPENED_PENCIL:14}),v=Object.freeze({NormalFloor:0,NormalWall:1,TileWithShadow:2}),b=Object.freeze({UI:{SceneUiGraph:function(t){return"ui_graph/".concat(t,".json")},EscapeSceneMessage:"ui_graph/escape_scene_message.json",EscapeSceneEnglishMessage:"ui_graph/escape_scene_message_english.json",EscapeSceneOption:"ui_graph/escape_scene_option.json",EscapeSceneEnglishOption:"ui_graph/escape_scene_option_english.json",EscapeSceneRoomObject:"ui_graph/escape_scene_room_object.json",Stage:"master/stage_master.json",PlayerAnimation:"master/player_animation_master.json",RoomObjectMaster:"master/room_object_master.json",Player:"player/player.json",TileFrame:"stage/tile_frame.png",Tiles:["stage/floor.png","stage/wall.png","stage/floor_with_shadow.png"],Items:["items/tin_statue.png","items/coin.png","items/banana.png","items/frozen_banana.png","items/salt.png","items/desk_key.png","items/pencil.png","items/sharpened_pencil.png","items/hand_mirror.png","items/detergent.png","items/car_key.png","items/crossbow.png","items/nail.png","items/dvd.png"],RoomObjects:["room_object/mirror.png","room_object/chair.png","room_object/pig2.png","room_object/clock_12_00.png"],MessageWindow:"ui/message_window.png",OptionFrame:"ui/option_frame.png",ItemSelectFrame:"ui/item_select_frame.png",ItemPanelFrame:"ui/item_panel_frame.png",MenuBar:"ui/menu_bar.png",MenuButton:"ui/menu_button.png"},Dynamic:{items:function(t){switch(t){case g.NOTHING:return"items/no_item.png";case g.TIN_STATUE:return"items/tin_statue.png";case g.COIN:return"items/coin.png";case g.BANANA:return"items/banana.png";case g.FROZEN_BANANA:return"items/frozen_banana.png";case g.SALT:return"items/salt.png";case g.PENCIL:return"items/pencil.png";case g.SHARPENED_PENCIL:return"items/sharpened_pencil.png";case g.NAIL:return"items/nail.png";case g.HAND_MIRROR:return"items/hand_mirror.png";case g.DVD:return"items/dvd.png";case g.DETERGENT:return"items/detergent.png";case g.DESK_KEY:return"items/desk_key.png";case g.CROSSBOW:return"items/crossbow.png";case g.CAR_KEY:return"items/car_key.png";default:return""}},tiles:function(t){switch(t){case v.NormalFloor:return"stage/floor.png";case v.NormalWall:return"stage/wall.png";case v.TileWithShadow:return"stage/floor_with_shadow.png";default:return""}}},AnimationTypes:{Player:Object.freeze({WAIT:"wait",WALKUP:"walk_up",WALKDOWN:"walk_down",WALKLEFT:"walk_left",WALKRIGHT:"walk_right",CHACKUP:"chack_up",CHACKDOWN:"chack_down",CHACKLEFT:"chack_left",CHACKRIGHT:"chack_right"})},SoundOptionIds:["sound_option_frame","bgm_volume","se_volume","bgm","se","bgm_volume_up","bgm_volume_down","se_volume_up","se_volume_down"],PinPadIds:["pin_pad","code_first","code_second","code_third","pad_cancel","pad_enter","pad_0","pad_1","pad_2","pad_3","pad_4","pad_5","pad_6","pad_7","pad_8","pad_9"],MenuOptionIds:["item_bag","return","sound_volume"],RoomObjects:{TV:"tv",DESK:"desk",DOOR:"door",BED:"bed",GAS_STOVE:"gas_stove",VENDING_MACHINE:"vending_machine",FREEZER:"freezer",CABINET:"cabinet",BARREL:"barrel",GRINDER:"grinder",CAR:"car",BALLOON:"balloon",MIRROR:"mirror",CHAIR:"chair",CLOCK:"clock",PIG:"pig",CLOSET:"closet",SAFE:"safe",BOOK_SHELF:"book_shelf"},MessageIds:{NothingSpecial:"nothing_special",BackToTitle:"back_to_title",ContinueGame:"continue_game"},Audio:{Bgm:{EscapeBGM:"audio/escape_bgm.mp3",EndingBGM:"audio/ending_bgm.mp3",TitleBgm:"audio/title_bgm.mp3"},Se:{ShowNextText:"audio/show_next_text.mp3",OptionTap:"audio/option_tap.mp3",TileTap:"audio/tile_tap.mp3"}},FontFamily:{Default:"MPLUS1p-Regular"}});function w(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function O(t){return function(t){if(Array.isArray(t))return w(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return w(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return w(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e=t.prototype;return e.createUiNode=function(t){return new r.W20},e.createUiNodeByGraphElement=function(t){var e=this.createUiNode(t.params);return e&&(e.name=t.id,e.position.set(t.position[0],t.position[1]),t.invisible&&(e.visible=!1),t.interactive&&(e.interactive=!0)),e},e.attachUiEventByGraphElement=function(t,e,i){var n=!0,o=!1,r=void 0;try{for(var s,a=function(t,n){var o,r=n.value,s=i[r.callback];if(!s)return"continue";e.on(r.type,(function(){return(o=s).call.apply(o,[i].concat(O(r.arguments)))}))},u=t[Symbol.iterator]();!(n=(s=u.next()).done);n=!0)a(0,s)}catch(c){o=!0,r=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw r}}},t}();function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function R(t,e){return!e||"object"!==C(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return _(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function x(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=T(t);if(e){var o=T(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return R(this,i)}}var P=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}(i,t);var e=x(i);function i(){return E(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e={};t&&(void 0!==t.family&&(e.fontFamily=t.family),void 0!==t.size&&(e.fontSize=t.size),void 0!==t.color&&(e.fill=t.color),void 0!==t.padding&&(e.padding=t.padding),void 0!==t.wordWrap&&(e.wordWrap=t.wordWrap),void 0!==t.wordWrapWidth&&(e.wordWrapWidth=t.wordWrapWidth));var i,n=new r.pn8(e),o=new r.xvT(t&&t.text?t.text:"",n);t&&void 0!==t.anchor&&(i=o.anchor).set.apply(i,j(t.anchor));return o},i}(S);function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function B(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function N(t,e){return!e||"object"!==M(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function U(t){return function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return A(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return A(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var M=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function G(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=D(t);if(e){var o=D(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return N(this,i)}}var W=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(i,t);var e=G(i);function i(){return B(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e=new r.jyi;if(t){var i,n,o=t.textureName;if(o&&r.P6Y.kN[o]&&(e.texture=r.P6Y.kN[o]),t.anchor)(i=e.anchor).set.apply(i,U(t.anchor));if(t.scale)(n=e.scale).set.apply(n,U(t.scale))}return e},i}(S);var L=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.getFactory=function(e){if(!t.cashedFactory[e]){var i;switch(e){case"text":case"message":case"language_option_text":case"confirmation_text":case"credit_text":case"menu_text":i=P;break;case"language_option_sprite":case"confirmation_sprite":case"sprite":i=W}if(!i)return null;t.cashedFactory[e]=new i}return t.cashedFactory[e]},t}();function F(t,e,i,n,o,r,s){try{var a=t[r](s),u=a.value}catch(c){return void i(c)}a.done?e(u):Promise.resolve(u).then(n,o)}function V(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H(t){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function z(t,e){return!e||"object"!==Y(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function K(t,e){return(K=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}L.cashedFactory={};var Y=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function q(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=H(t);if(e){var o=H(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return z(this,i)}}var J=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&K(t,e)}(i,t);var e=q(i);function i(){var t;return V(this,i),(t=e.apply(this,arguments)).transitionIn=new y(1,0,-.02),t.transitionOut=new y(0,1,.02),t.objectsToUpdate=[],t.elapsedFrameCount=0,t.uiGraphContainer=new r.W20,t.uiGraph=new Map,t.isOver=!1,t}var n=i.prototype;return n.update=function(t){this.elapsedFrameCount++,this.updateRegisteredObjects(t),this.transitionIn.isActive()?this.transitionIn.update(t):this.transitionOut.isActive()&&this.transitionOut.update(t)},n.registerUpdatingObject=function(t){this.objectsToUpdate.push(t)},n.updateRegisteredObjects=function(t){var e=[],i=!0,n=!1,o=void 0;try{for(var r,s=this.objectsToUpdate[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;a&&!a.isDestroyed()&&(a.update(t),e.push(a))}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}this.objectsToUpdate=e},n.beginTransitionIn=function(t,e){this.transitionIn.setCallback((function(){return t()}));var i=this.transitionIn.getContainer();i&&this.addChild(i),this.transitionIn.begin(e)},n.beginTransitionOut=function(t,e){this.transitionOut.setCallback((function(){return t()}));var i=this.transitionOut.getContainer();i&&this.addChild(i),this.transitionOut.begin(e)},n.createInitialResourceList=function(){return[]},n.beginLoadResource=function(t){var e,i=this;return(e=m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(t){i.loadInitialResource((function(){return t(null)}))}));case 2:return e.next=4,new Promise((function(t){var e=i.onInitialResourceLoaded();i.loadAdditionalResource(e,(function(){return t(null)}))}));case 4:i.onResourceLoaded(),t();case 6:case"end":return e.stop()}}),e)})),function(){var t=this,i=arguments;return new Promise((function(n,o){var r=e.apply(t,i);function s(t){F(r,n,o,s,a,"next",t)}function a(t){F(r,n,o,s,a,"throw",t)}s(void 0)}))})()},n.loadInitialResource=function(t){var e=this.createInitialResourceList(),i=b.UI.SceneUiGraph(this.sceneName);e.push(i);var n=this.filterLoadedAssets(e);n.length>0?f.game.loader.add(n).load(t):t()},n.onInitialResourceLoaded=function(){var t=[],e=b.UI.SceneUiGraph(this.sceneName),i=f.game.loader.resources[e],n=!0,o=!1,r=void 0;try{for(var s,a=i.data.nodes[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;"sprite"!==u.type&&"sprite_option"!==u.type&&"room_object"!==u.type&&"item_panel"!==u.type&&"language_option_sprite"!==u.type&&"confirmation_sprite"!==u.type||t.push({name:u.params.textureName,url:u.params.url})}}catch(c){o=!0,r=c}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}return t},n.loadAdditionalResource=function(t,e){f.game.loader.add(this.filterLoadedAssets(t)).load(e)},n.onResourceLoaded=function(){var t=b.UI.SceneUiGraph(this.sceneName),e=f.game.loader.resources[t].data;this.prepareUiGraphContainer(e)},n.filterLoadedAssets=function(t){var e=new Map,i=!0,n=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;"string"===typeof a?f.game.loader.resources[a]||e.has(a)||e.set(a,{name:a,url:a}):f.game.loader.resources[a.name]||e.has(a.name)||e.set(a.name,a)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return Array.from(e.values())},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=L.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),this.uiGraph.set(s.id,u),this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.getCustomUiGraphFactory=function(t){return null},n.destroySound=function(){var t=f.game.loader.resources,e=Object.keys(t),i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;t[a].buffer&&p.destroySound(a)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},i}(r.W20);function Z(t,e,i){return(Z="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=X(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function X(t){return(X=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $(t,e){return!e||"object"!==tt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Q(t,e){return(Q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function et(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=X(t);if(e){var o=X(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $(this,i)}}var it=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Q(t,e)}(i,t);var e=et(i);function i(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=e.call(this)).sceneName="option_scene",n.language=t,n.transitionIn=new y(1,0,-.02),n.transitionOut=new y(0,1,.02),n}var n=i.prototype;return n.onResourceLoaded=function(){Z(X(i.prototype),"onResourceLoaded",this).call(this),this.initVolumeGraph(),this.initLanguageButton(),this.addChild(this.uiGraphContainer)},n.initLanguageButton=function(){var t=this.uiGraph.get("japanese"),e=this.uiGraph.get("japanese_2"),i=this.uiGraph.get("english"),n=this.uiGraph.get("english_2");t&&e&&i&&n&&("japanese"===this.language?(t.visible=!0,e.visible=!1,i.visible=!1,n.visible=!0):(t.visible=!1,e.visible=!0,i.visible=!0,n.visible=!1))},n.onLanguageSelected=function(t){p.playSe(b.Audio.Se.OptionTap);var e=this.uiGraph.get("japanese"),i=this.uiGraph.get("japanese_2"),n=this.uiGraph.get("english"),o=this.uiGraph.get("english_2");e&&i&&n&&o&&("japanese"===t?(e.visible=!0,i.visible=!1,n.visible=!1,o.visible=!0):(e.visible=!1,i.visible=!0,n.visible=!0,o.visible=!1),this.saveLanguageToDB(t))},n.initVolumeGraph=function(){for(var t=p.bgmVolume,e=p.seVolume,i=Math.round(100*t)+1,n=Math.round(10*e)+1;i<=10;i++){var o="bgm_volume_".concat(i);this.uiGraph.get(o).visible=!1}for(;n<=10;n++){var r="se_volume_".concat(n);this.uiGraph.get(r).visible=!1}},n.showTitleScene=function(){this.transitionIn.isActive()||this.transitionOut.isActive()||(p.playSe(b.Audio.Se.OptionTap),f.loadScene(new oi))},n.onBgmArrowDown=function(t){var e=p.bgmVolume;if(t<0){if(0===e)return;var i="bgm_volume_".concat(Math.round(100*e));this.uiGraph.get(i).visible=!1}else{if(.1===e)return;var n="bgm_volume_".concat(Math.round(100*e+1));this.uiGraph.get(n).visible=!0}(e+=t)<.001?e=0:e>.0999&&(e=.1),p.bgmVolume=e,p.playSe(b.Audio.Se.OptionTap),this.saveBgmVolumeToDB(p.bgmVolume),p.setSoundVolume(p.bgmVolume,p.seVolume)},n.onSeArrowDown=function(t){var e=p.seVolume;if(t<0){if(0===e)return;var i="se_volume_".concat(Math.round(10*e));this.uiGraph.get(i).visible=!1}else{if(1===e)return;var n="se_volume_".concat(Math.round(10*e+1));this.uiGraph.get(n).visible=!0}(e+=t)<.001?e=0:e>.999&&(e=1),p.seVolume=e,p.playSe(b.Audio.Se.OptionTap),this.saveSeVolumeToDB(p.seVolume)},n.saveLanguageToDB=function(t){l.put("language",t)},n.saveBgmVolumeToDB=function(t){l.put("bgmVolume",t)},n.saveSeVolumeToDB=function(t){l.put("seVolume",t)},i}(J);function nt(t,e,i){return(nt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ot(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function ot(t){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rt(t,e){return!e||"object"!==at(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function st(t,e){return(st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var at=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ut(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ot(t);if(e){var o=ot(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return rt(this,i)}}var ct=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(i,t);var e=ut(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=e.call(this)).creditContainer=new r.W20,t.currentPage=0,t.currentPageNumber=1,t.sceneName="credit_scene",t.transitionIn=new y(1,0,-.02),t.transitionOut=new y(0,1,.02),t}var n=i.prototype;return n.onResourceLoaded=function(){nt(ot(i.prototype),"onResourceLoaded",this).call(this),this.addChild(this.uiGraphContainer),this.addChild(this.creditContainer)},n.changePage=function(t){p.playSe(b.Audio.Se.OptionTap),t<0?this.currentPageNumber+=1:this.currentPageNumber-=1,this.currentPage=this.currentPage+t,this.currentPage<-6?(this.currentPage=0,this.currentPageNumber=1):this.currentPage>0&&(this.currentPage=-6,this.currentPageNumber=7),this.creditContainer.position.x=640*this.currentPage;var e=this.uiGraph.get("page_number");e&&(e.text=this.currentPageNumber.toString())},n.showTitleScene=function(){this.transitionIn.isActive()||this.transitionOut.isActive()||(p.playSe(b.Audio.Se.OptionTap),f.loadScene(new oi))},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=L.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),this.uiGraph.set(s.id,u),"credit_text"===s.type?this.creditContainer.addChild(u):this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},i}(J);var lt=function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state=0,this.walkDirection=null,this.walkSpeed=4,this.walkCount=0,this.distanceRow=0,this.distanceColumn=0,this.checkingObject=null,this.items=[],this.positionRow=e,this.positionColumn=i},ht=Object.freeze({NONE:0,OBJECT:1,GOAL:2}),pt=Object.freeze({UP:0,LEFT:1,DOWN:2,RIGHT:3});var ft=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.init=function(e){t.map=e,t.states=[],t.policy.clear(),t.direction.clear();for(var i=0;i<e.length;i++)for(var n=0;n<e[0].length;n++)t.states.push([i,n]);var o=!0,r=!1,s=void 0;try{for(var a,u=t.states[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;t.value.set(c,0);var l=!0,h=!1,p=void 0;try{for(var f,d=t.actions[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value;t.policy.set([c,m],0)}}catch(y){h=!0,p=y}finally{try{l||null==d.return||d.return()}finally{if(h)throw p}}}}catch(y){r=!0,s=y}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}t.direction.set(t.actions[0],pt.UP),t.direction.set(t.actions[1],pt.LEFT),t.direction.set(t.actions[2],pt.DOWN),t.direction.set(t.actions[3],pt.RIGHT)},t.move=function(e,i){if(e[0]===t.goal[0]&&e[1]===t.goal[1])return[0,e];var n=[e[0]+i[0],e[1]+i[1]];return n[0]<0||n[1]<0||n[0]>=t.map.length||n[1]>=t.map[0].length||t.map[n[0]][n[1]]===ht.OBJECT?[-1,e]:[-1,n]},t.policyUpdate=function(e){var i,n=-Math.pow(10,10),o=!0,r=!1,s=void 0;try{for(var a,u=t.actions[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value,l=t.move(e,c),h=0,p=!0,f=!1,d=void 0;try{for(var m,y=t.states[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var g=m.value;g[0]===l[1][0]&&g[1]===l[1][1]&&(h=l[0]+t.value.get(g))}}catch(v){f=!0,d=v}finally{try{p||null==y.return||y.return()}finally{if(f)throw d}}h>n&&(n=h,i=c)}}catch(v){r=!0,s=v}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}return t.policy.forEach((function(n,o){o[0][0]===e[0]&&o[0][1]===e[1]&&o[1][0]===i[0]&&o[1][1]===i[1]?t.policy.set(o,1):o[0][0]===e[0]&&o[0][1]===e[1]&&t.policy.set(o,0)})),n},t.valueIteration=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.01,i=0;;){var n=0,o=!0,r=!1,s=void 0;try{for(var a,u=t.states[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;if(1!==t.map[c[0]][c[1]]){var l=t.policyUpdate(c);n=Math.max(n,Math.abs(t.value.get(c)-l)),t.value.set(c,l)}}}catch(h){r=!0,s=h}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}if(++i>=t.maxIterate)break;if(n<e)break}},t.createBestPolicy=function(){t.policy.forEach((function(e,i){if(1===e){var n=t.direction.get(i[1]);t.bestPolicy.set(i[0],n)}}))},t.getRoutePlan=function(e,i){t.goal=i,t.valueIteration(),t.createBestPolicy();for(var n=[],o=e,r=!1,s=0;!r;){if(++s>=t.maxIterate)return[];var a=!0,u=!1,c=void 0;try{for(var l,h=t.states[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var p=l.value;if(p[0]===o[0]&&p[1]===o[1]){var f=t.bestPolicy.get(p);switch(f){case 0:o[0]=o[0]-1;break;case 1:o[1]=o[1]-1;break;case 2:o[0]=o[0]+1;break;case 3:o[1]=o[1]+1}o[0]===i[0]&&o[1]===i[1]&&(r=!0),n.push(f);break}}}catch(d){u=!0,c=d}finally{try{a||null==h.return||h.return()}finally{if(u)throw c}}}return n},t}();ft.states=[],ft.actions=[[-1,0],[0,-1],[1,0],[0,1]],ft.policy=new Map,ft.bestPolicy=new Map,ft.value=new Map,ft.direction=new Map,ft.maxIterate=100;var dt=Object.freeze({IDLE:0,WALK:1,CHECKING:2});var mt=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.states=[],this.id=e},yt=Object.freeze({CheckedUnderBed:0,UsedKey:1,HasNoPencil:2,CheckedUnderPillow:3,CheckedInCloset:4,JumpedOnBed:5,CheckedOnCloset:6,GotCarKey:7,Washed:8,HasNoDVD:9}),gt=Object.freeze({DoNoting:1,BackToTitle:6,ShowItems:7,ShowBackToTitle:8,ShowSoundVolume:9,ShowItemOption:10,JumpOnBed:11,CheckUnderBed:12,CheckUnderPillow:13,UseTinStatue:14,UseCoin:15,UseBanana:16,UseCarKey:17,UseNail:18,UseFrozenBanana:19,UseSalt:20,UseCrossBow:21,UseDetergent:22,UseHandMirror:23,UseDVD:24,UsePencil:25,GetSalt:26,UseDeskKey:27,CheckLeftDrawer:28,CheckRightDrawer:29,GetPenCil:30,UseShapenedPencil:31,CheckInCloset:32,CheckOnCloset:33,ShowPinPad:34,GetCrossbow:35,SetTime:36,Escape:37,MovePig:38,GetDVD:39,ReadHint:40,ReadHint1:41,ReadHint2:42});var vt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.walkRequests=[],this.roomObjectEntities=new Map}var e=t.prototype;return e.init=function(t){this.delegator=t.delegator,this.stageMaster=t.stageMaster,this.saveData=t.saveData,this.saveData.mapData?ft.init(this.saveData.mapData):ft.init(this.stageMaster.mapData),this.tileSize=this.stageMaster.tileSize,0!==this.saveData.roomObjectState.length?this.setRoomObjectEntities(this.saveData.roomObjectState):this.setRoomObjectEntities(t.roomObjectMaster),this.playerEntity=new lt(4,7),0!==this.saveData.playerItems.length&&(this.playerEntity.items=this.saveData.playerItems),this.delegator.onPlayerSpawned(this.playerEntity)},e.update=function(){this.updatePlayerDistance(),this.updatePlayerState()},e.updatePlayerState=function(){this.playerEntity.state===dt.WALK&&this.updateWalkState(),this.playerEntity.state===dt.IDLE&&this.updateIdleState(),this.playerEntity.state===dt.CHECKING&&this.updateChackingState()},e.updateIdleState=function(){0!==this.walkRequests.length&&(this.playerEntity.state=dt.WALK,this.delegator.onPlayerEntityStateChanged(this.playerEntity)),this.playerEntity.checkingObject&&(this.playerEntity.state=dt.CHECKING,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updateWalkState=function(){0===this.walkRequests.length&&this.playerEntity.walkCount*this.playerEntity.walkSpeed%this.tileSize===0&&(this.playerEntity.walkCount=0,this.playerEntity.state=dt.IDLE,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updateChackingState=function(){this.playerEntity.checkingObject||(this.playerEntity.state=dt.IDLE,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updatePlayerDistance=function(){if(this.playerEntity.state===dt.WALK){if(this.playerEntity.walkCount*this.playerEntity.walkSpeed%this.tileSize===0)switch(this.walkRequests.shift()){case pt.UP:this.playerEntity.walkDirection=pt.UP,this.playerEntity.positionRow+=-1;break;case pt.DOWN:this.playerEntity.walkDirection=pt.DOWN,this.playerEntity.positionRow+=1;break;case pt.LEFT:this.playerEntity.walkDirection=pt.LEFT,this.playerEntity.positionColumn+=-1;break;case pt.RIGHT:this.playerEntity.walkDirection=pt.RIGHT,this.playerEntity.positionColumn+=1}switch(this.playerEntity.walkDirection){case pt.UP:this.playerEntity.distanceRow-=this.playerEntity.walkSpeed;break;case pt.DOWN:this.playerEntity.distanceRow+=this.playerEntity.walkSpeed;break;case pt.LEFT:this.playerEntity.distanceColumn-=this.playerEntity.walkSpeed;break;case pt.RIGHT:this.playerEntity.distanceColumn+=this.playerEntity.walkSpeed}this.playerEntity.walkCount++,this.delegator.onPlayerEntityWalked(this.playerEntity)}},e.onRoomObjectTapped=function(t){this.playerEntity.checkingObject=t},e.onOptionSelected=function(t){if(this.playerEntity.checkingObject){var e=this.roomObjectEntities.get(this.playerEntity.checkingObject);if(e){if(t===gt.UseHandMirror&&this.delegator.onItemUsed(t,e),t===gt.UseShapenedPencil&&this.delegator.onItemUsed(t,e),t===gt.UseNail&&this.delegator.onItemUsed(t,e),t===gt.UseDVD&&this.delegator.onItemUsed(t,e),t===gt.CheckRightDrawer&&this.delegator.onRoomObjectOptionSelected(e,t),t===gt.CheckLeftDrawer&&this.delegator.onRoomObjectOptionSelected(e,t),t===gt.MovePig&&this.delegator.onRoomObjectOptionSelected(e,t),t===gt.ReadHint&&this.delegator.onRoomObjectOptionSelected(e,t),t===gt.ReadHint1&&this.delegator.onRoomObjectOptionSelected(e,t),t===gt.ReadHint2&&this.delegator.onRoomObjectOptionSelected(e,t),t===gt.Escape&&this.delegator.onGameOver(),t===gt.CheckUnderBed&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(yt.CheckedUnderBed)&&(this.playerEntity.items.push(g.TIN_STATUE),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(yt.CheckedUnderBed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===gt.CheckUnderPillow&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(yt.CheckedUnderPillow)&&(this.playerEntity.items.push(g.HAND_MIRROR),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(yt.CheckedUnderPillow),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===gt.JumpOnBed&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(yt.JumpedOnBed)&&(e.states.push(yt.JumpedOnBed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===gt.CheckInCloset&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(yt.CheckedInCloset)&&(this.playerEntity.items.push(g.DETERGENT),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(yt.CheckedInCloset),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===gt.CheckOnCloset&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(yt.CheckedOnCloset))){this.playerEntity.items.push(g.CAR_KEY),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(yt.CheckedOnCloset),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB();var i=this.roomObjectEntities.get(b.RoomObjects.BED);null===i||void 0===i||i.states.push(yt.GotCarKey),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()}if(t===gt.UseDetergent){if(this.playerEntity.checkingObject===b.RoomObjects.MIRROR){var n=this.playerEntity.items.indexOf(g.DETERGENT);this.playerEntity.items.splice(n,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(yt.Washed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()}this.delegator.onItemUsed(t,e)}if(t===gt.UseFrozenBanana)if(this.playerEntity.checkingObject===b.RoomObjects.CHAIR&&-1!==this.playerEntity.items.indexOf(g.NAIL)){this.delegator.onItemUsed(t,e,this.playerEntity.items);var o=this.playerEntity.items.indexOf(g.FROZEN_BANANA);this.playerEntity.items.splice(o,1);var r=this.playerEntity.items.indexOf(g.NAIL);this.playerEntity.items.splice(r,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}else this.delegator.onItemUsed(t,e,this.playerEntity.items);if(t===gt.UseTinStatue){if(this.playerEntity.checkingObject===b.RoomObjects.GAS_STOVE){var s=this.playerEntity.items.indexOf(g.TIN_STATUE);this.playerEntity.items.splice(s,1),this.playerEntity.items.push(g.COIN),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===gt.UseCoin){if(this.playerEntity.checkingObject===b.RoomObjects.VENDING_MACHINE){var a=this.playerEntity.items.indexOf(g.COIN);this.playerEntity.items.splice(a,1),this.playerEntity.items.push(g.BANANA),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===gt.UseBanana){if(this.playerEntity.checkingObject===b.RoomObjects.FREEZER){var u=this.playerEntity.items.indexOf(g.BANANA);this.playerEntity.items.splice(u,1),this.playerEntity.items.push(g.FROZEN_BANANA),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===gt.UseSalt){if(this.playerEntity.checkingObject===b.RoomObjects.BARREL){var c=this.playerEntity.items.indexOf(g.SALT);this.playerEntity.items.splice(c,1),this.playerEntity.items.push(g.DESK_KEY),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===gt.UseDeskKey){if(this.playerEntity.checkingObject===b.RoomObjects.DESK){var l=this.playerEntity.items.indexOf(g.DESK_KEY);this.playerEntity.items.splice(l,1),e.states.push(yt.UsedKey),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB(),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===gt.UsePencil){if(this.playerEntity.checkingObject===b.RoomObjects.GRINDER){var h=this.playerEntity.items.indexOf(g.PENCIL);this.playerEntity.items.splice(h,1),this.playerEntity.items.push(g.SHARPENED_PENCIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===gt.UseCrossBow)if(this.playerEntity.checkingObject===b.RoomObjects.BALLOON&&-1!==this.playerEntity.items.indexOf(g.SHARPENED_PENCIL)){this.delegator.onItemUsed(t,e,this.playerEntity.items);var p=this.playerEntity.items.indexOf(g.SHARPENED_PENCIL);this.playerEntity.items.splice(p,1);var f=this.playerEntity.items.indexOf(g.CROSSBOW);this.playerEntity.items.splice(f,1),this.playerEntity.items.push(g.NAIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}else this.delegator.onItemUsed(t,e,this.playerEntity.items);if(t===gt.UseCarKey){if(this.playerEntity.checkingObject===b.RoomObjects.CAR){var d=this.playerEntity.items.indexOf(g.CAR_KEY);this.playerEntity.items.splice(d,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items),ft.init(this.stageMaster.carMovedMapData),this.playerEntity.positionRow=7,this.playerEntity.positionColumn=7,this.playerEntity.distanceRow=192,this.playerEntity.distanceColumn=0}this.delegator.onItemUsed(t,e)}t===gt.GetSalt&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(g.SALT),this.delegator.onPlayerItemsChanged(this.playerEntity.items)),t===gt.GetCrossbow&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(g.CROSSBOW),this.delegator.onPlayerItemsChanged(this.playerEntity.items)),t===gt.GetPenCil&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(g.PENCIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(yt.HasNoPencil),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()),t===gt.GetDVD&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(g.DVD),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(yt.HasNoDVD),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()),t===gt.SetTime&&(ft.init(this.stageMaster.pigMovedMapData),this.delegator.onRoomObjectOptionSelected(e,t))}}},e.onChackingEnd=function(){this.playerEntity.checkingObject=null},e.setRoomObjectEntities=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=new mt(s.id);a.states=s.states.concat(),this.roomObjectEntities.set(s.id,a)}}catch(u){i=!0,n=u}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},e.requestWalk=function(t){this.walkRequests=ft.getRoutePlan([this.playerEntity.positionRow,this.playerEntity.positionColumn],t)},e.changeRoomObjectEntitiesIntoArray=function(){var t=[];return this.roomObjectEntities.forEach((function(e,i){var n={id:i,states:e.states};t.push(n)})),t},e.saveProgressToDB=function(){l.put("saveData",this.saveData)},t}(),bt=Object.freeze({LOADING_RESOURCES:1,RESOURCE_LOADED:2,READY:3,INGAME:4,FINISHED:5});var wt=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elapsedFrameCount=0,this.destroyed=!1,this.animationFrameId=0,this.requestedAnimationType=null,this.sprite=new r.jyi;var o=r.P6Y.kN[e.types.wait.frames[0]];this.sprite.texture=o,this.reSizeSprite(i);var s=i-this.sprite.width,a=i-this.sprite.height;this.sprite.position.set(n.x+s/2,n.y+a/2),this.spawnedPosition=new r.E9j(this.sprite.position.x,this.sprite.position.y),this.animationMaster=e,this.animationType=b.AnimationTypes.Player.WAIT}var e=t.prototype;return e.isDestroyed=function(){return this.destroyed},e.update=function(t){this.requestedAnimationType&&this.requestedAnimationType!==this.animationType&&(this.animationType=this.requestedAnimationType,this.resetAnimation()),this.updateAnimation()},e.requestAnimation=function(t){this.requestedAnimationType=t},e.resetAnimation=function(){this.requestedAnimationType=null,this.elapsedFrameCount=0,this.animationFrameId=0},e.updateAnimation=function(){var t=this.animationType,e=this.animationMaster.types[t];if(e){if(this.elapsedFrameCount%e.updateDuration===0){this.isAnimationLastFrameTime()&&this.resetAnimation();var i=e.frames[this.animationFrameId];this.sprite.texture=r.P6Y.kN[i],this.animationFrameId++}this.elapsedFrameCount++}},e.isAnimationLastFrameTime=function(){var t=this.animationType,e=this.animationMaster.types[t];if(!e)return!1;var i=e.updateDuration*e.frames.length;return this.elapsedFrameCount===i},e.destroy=function(){this.sprite.destroy(),this.destroyed=!0},e.reSizeSprite=function(t){t/t>this.sprite.width/this.sprite.height?(this.sprite.scale.x=t/this.sprite.width*(this.sprite.width/this.sprite.height),this.sprite.scale.y=t/this.sprite.height):(this.sprite.scale.x=t/this.sprite.width,this.sprite.scale.y=t/this.sprite.height*(this.sprite.height/this.sprite.width))},t}();function Ot(t){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function St(t,e){return!e||"object"!==Et(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _t(t,e){return(_t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Et=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Tt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ot(t);if(e){var o=Ot(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return St(this,i)}}var Rt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_t(t,e)}(i,t);var e=Tt(i);function i(t,n,o){var s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(s=e.call(this)).isActive=!1,s.touchable=!1,s.tilePosition=n,s.tileSprite=new r.jyi,s.tileFrameSprite=new r.jyi;var a=f.game.loader.resources[b.Dynamic.tiles(t)].texture,u=f.game.loader.resources[b.UI.TileFrame].texture;return a&&(s.tileSprite.texture=a),s.tileSprite.scale.set(o/s.tileSprite.width,o/s.tileSprite.height),u&&(s.tileFrameSprite.texture=u),s.tileFrameSprite.scale.set(o/s.tileFrameSprite.width,o/s.tileFrameSprite.height),s.tileFrameSprite.visible=!1,s.addChild(s.tileSprite),s.addChild(s.tileFrameSprite),s}return i.prototype.toggleFrame=function(){this.touchable&&(p.playSe(b.Audio.Se.TileTap),this.isActive=!this.isActive,this.tileFrameSprite.visible=!this.tileFrameSprite.visible)},i}(r.W20);function It(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function jt(t){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ct(t,e){return!e||"object"!==At(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xt(t,e){return(xt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Pt(t){return function(t){if(Array.isArray(t))return It(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return It(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return It(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var At=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Bt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=jt(t);if(e){var o=jt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ct(this,i)}}var Dt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xt(t,e)}(i,t);var e=Bt(i);function i(t,n){var o,s,a;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(o=e.call(this)).messageIds=o.copyMessageIds(n.messageIds),o.downTiles=n.downTiles.concat(),o.sprite=new r.jyi,o.sprite.texture=t,n.anchor)&&(s=o.sprite.anchor).set.apply(s,Pt(n.anchor));n.scale&&(a=o.sprite.scale).set.apply(a,Pt(n.scale));return o.addChild(o.sprite),o}return i.prototype.copyMessageIds=function(t){var e,i,n=[],o=!0,r=!1,s=void 0;try{for(var a,u=t[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;e=c,(null!=(i=String)&&"undefined"!==typeof Symbol&&i[Symbol.hasInstance]?i[Symbol.hasInstance](e):e instanceof i)?n.push(c):n.push(c.concat())}}catch(l){r=!0,s=l}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}return n},i}(r.W20);function Nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kt(t){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ut(t,e){return!e||"object"!==Gt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mt(t,e){return(Mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Wt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=kt(t);if(e){var o=kt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ut(this,i)}}var Lt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mt(t,e)}(i,t);var e=Wt(i);function i(){return Nt(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e;if(t){var i=t.textureName;i&&r.P6Y.kN[i]&&(e=r.P6Y.kN[i])}return e?new Dt(e,t):null},i}(S);function Ft(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Vt(t){return(Vt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ht(t,e){return!e||"object"!==Kt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function zt(t,e){return(zt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Kt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Yt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Vt(t);if(e){var o=Vt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ht(this,i)}}var qt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zt(t,e)}(i,t);var e=Yt(i);function i(t,n){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(o=e.call(this)).isActive=!1,o.optionButton=t,o.optionType=n,o.frameSprite=new r.jyi;var s,a,u=f.game.loader.resources[b.UI.OptionFrame].texture;return u&&(o.frameSprite.texture=u),s=t,(null!=(a=r.xvT)&&"undefined"!==typeof Symbol&&a[Symbol.hasInstance]?a[Symbol.hasInstance](s):s instanceof a)?o.frameSprite.scale.set((o.optionButton.width+40)/o.frameSprite.width,(o.optionButton.height+10)/o.frameSprite.height):o.frameSprite.scale.set(o.optionButton.texture.width/o.frameSprite.width,o.optionButton.texture.height/o.frameSprite.height),o.frameSprite.anchor.set(.5,.5),o.frameSprite.visible=!1,o.optionButton.addChild(o.frameSprite),o.addChild(o.optionButton),o}var n,o,s,a=i.prototype;return a.activate=function(){this.isActive=!0,this.frameSprite.visible=!0},a.deactivate=function(){this.isActive=!1,this.frameSprite.visible=!1},n=i,s=[{key:"resourceList",get:function(){return[b.UI.OptionFrame,b.UI.ItemSelectFrame]}}],(o=null)&&Ft(n.prototype,o),s&&Ft(n,s),i}(r.W20);function Jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Zt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xt(t){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $t(t,e){return!e||"object"!==ee(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Qt(t,e){return(Qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function te(t){return function(t){if(Array.isArray(t))return Jt(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return Jt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Jt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ee=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ie(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Xt(t);if(e){var o=Xt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return $t(this,i)}}var ne=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qt(t,e)}(i,t);var e=ie(i);function i(){return Zt(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e={};t&&(void 0!==t.family&&(e.fontFamily=t.family),void 0!==t.size&&(e.fontSize=t.size),void 0!==t.color&&(e.fill=t.color),void 0!==t.padding&&(e.padding=t.padding),void 0!==t.wordWrap&&(e.wordWrap=t.wordWrap),void 0!==t.wordWrapWidth&&(e.wordWrapWidth=t.wordWrapWidth));var i,n=new r.pn8(e),o=new r.xvT(t&&t.text?t.text:"",n);t&&void 0!==t.anchor&&(i=o.anchor).set.apply(i,te(t.anchor));var s=t.optionType;return new qt(o,s)},i}(S);function oe(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function re(t){return(re=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function se(t,e){return null!=e&&"undefined"!==typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function ae(t,e){return!e||"object"!==ce(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ue(t,e){return(ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ce=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function le(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=re(t);if(e){var o=re(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ae(this,i)}}var he=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ue(t,e)}(i,t);var e=le(i);function i(t,n){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(o=e.call(this)).currentTextIndex=0;var s=!0,a=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var h=c.value;if(!se(h,r.xvT)){var p=!0,d=!1,m=void 0;try{for(var y,g=function(t,e){var i=e.value;i.deactivate(),i.on("pointertap",(function(){o.onOptionButtonTapped(i)}))},v=h[Symbol.iterator]();!(p=(y=v.next()).done);p=!0)g(0,y)}catch(O){d=!0,m=O}finally{try{p||null==v.return||v.return()}finally{if(d)throw m}}h[0].activate()}}}catch(O){a=!0,u=O}finally{try{s||null==l.return||l.return()}finally{if(a)throw u}}o.delegate=n,o.textsAndOptions=t;var w=r.P6Y.kN[b.UI.MessageWindow];return o.window=new r.jyi(w),o.window.interactive=!0,o.window.on("pointertap",(function(){o.showNextText()})),o.window.scale.set((f.game.view.width-10)/o.window.width,(f.game.view.height/3-10)/o.window.height),o.window.anchor.set(.5,.5),o.window.position.set(f.game.view.width/2,f.game.view.height-o.window.height/2-5),o.windowScaleX=o.window.scale.x,o.windowScaleY=o.window.scale.y,o.windowSizeUpRateX=o.windowScaleX/i.WindowSizeUpFrame,o.windowSizeUpRateY=o.windowScaleY/i.WindowSizeUpFrame,o.window.scale.set(0,0),se(o.textsAndOptions[0],r.xvT)&&o.window.addChild(o.textsAndOptions[0]),o.addChild(o.window),o}var n,o,s,a=i.prototype;return a.isDestroyed=function(){return this._destroyed},a.update=function(t){this.isDestroyed()||this.window.scale.x===this.windowScaleX&&this.window.scale.y===this.windowScaleY||(this.window.scale.set(this.window.scale.x+this.windowSizeUpRateX,this.window.scale.y+this.windowSizeUpRateY),this.window.scale.x>=this.windowScaleX&&(this.window.scale.x=this.windowScaleX),this.window.scale.y>=this.windowScaleY&&(this.window.scale.y=this.windowScaleY))},a.showNextText=function(){if(p.playSe(b.Audio.Se.ShowNextText),this.window.interactive=!0,this.currentTextIndex!==this.textsAndOptions.length-1){var t=this.textsAndOptions[this.currentTextIndex];if(se(t,r.xvT))t.visible=!1;else{var e=!0,i=!1,n=void 0;try{for(var o,s=t[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){o.value.visible=!1}}catch(I){i=!0,n=I}finally{try{e||null==s.return||s.return()}finally{if(i)throw n}}}var a=this.textsAndOptions[++this.currentTextIndex];if(se(a,r.xvT))this.window.addChild(a);else{this.window.interactive=!1,2===a.length?(a[0].position.set(-190,0),a[1].position.set(190,0)):3===a.length?(a[0].position.set(-300,0),a[1].position.set(0,0),a[2].position.set(300,0)):4===a.length?(a[0].position.set(-190,-35),a[1].position.set(-190,35),a[2].position.set(190,-35),a[3].position.set(190,35)):5===a.length?(a[0].position.set(-300,-35),a[1].position.set(-300,35),a[2].position.set(0,-35),a[3].position.set(0,35),a[4].position.set(300,-35)):6===a.length?(a[0].position.set(-300,-35),a[1].position.set(-300,35),a[2].position.set(0,-35),a[3].position.set(0,35),a[4].position.set(300,-35),a[5].position.set(300,35)):a[0].position.set(0,0);var u=!0,c=!1,l=void 0;try{for(var h,f=a[Symbol.iterator]();!(u=(h=f.next()).done);u=!0){var d=h.value;d.visible=!0,this.window.addChild(d)}}catch(I){c=!0,l=I}finally{try{u||null==f.return||f.return()}finally{if(c)throw l}}}}else{this.delegate.onMessageWindowClosed();var m=!0,y=!1,g=void 0;try{for(var v,w=this.textsAndOptions[Symbol.iterator]();!(m=(v=w.next()).done);m=!0){var O=v.value;if(!se(O,r.xvT)){var S=!0,_=!1,E=void 0;try{for(var T,R=O[Symbol.iterator]();!(S=(T=R.next()).done);S=!0){T.value.removeListener("pointertap")}}catch(I){_=!0,E=I}finally{try{S||null==R.return||R.return()}finally{if(_)throw E}}}}}catch(I){y=!0,g=I}finally{try{m||null==w.return||w.return()}finally{if(y)throw g}}this.destroy()}},a.onOptionButtonTapped=function(t){if(t.isActive)t.optionType&&this.delegate.onOptionSelected(t.optionType),this.showNextText();else{var e=this.textsAndOptions[this.currentTextIndex];if(!se(e,r.xvT)){var i=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){s.value.deactivate()}}catch(u){n=!0,o=u}finally{try{i||null==a.return||a.return()}finally{if(n)throw o}}}p.playSe(b.Audio.Se.OptionTap),t.activate()}},a.addText=function(t,e){if(!se(t,r.xvT)){var i=!0,n=!1,o=void 0;try{for(var s,a=this,u=function(t,e){var i=e.value,n=a;i.removeListener("pointertap"),i.deactivate(),i.on("pointertap",(function(){n.onOptionButtonTapped(i)}))},c=t[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)u(0,s)}catch(l){n=!0,o=l}finally{try{i||null==c.return||c.return()}finally{if(n)throw o}}t[0].activate()}this.textsAndOptions.splice(this.currentTextIndex+e,0,t)},n=i,s=[{key:"resourceList",get:function(){return[b.UI.MessageWindow]}}],(o=null)&&oe(n.prototype,o),s&&oe(n,s),i}(r.W20);function pe(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function fe(t){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function de(t,e){return null!=e&&"undefined"!==typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function me(t,e){return!e||"object"!==ge(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ye(t,e){return(ye=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}he.WindowSizeUpFrame=10;var ge=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ve(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=fe(t);if(e){var o=fe(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return me(this,i)}}var be=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ye(t,e)}(i,t);var e=ve(i);function i(t,n,o,s,a){var u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(u=e.call(this)).isOpen=!1,u.menuOptionButtons=[],u.itemPanels=new Map,u.texts=new Map,u.optionButtons=new Map,u.delegate=a,u.menuOptionButtons=t,u.texts=s,u.soundOption=o,s.forEach((function(t,e){de(t,qt)&&u.optionButtons.set(e,t)}));var c=r.P6Y.kN[b.UI.MenuBar],l=r.P6Y.kN[b.UI.MenuButton],h=r.P6Y.kN[b.UI.ItemPanelFrame],p=r.P6Y.kN[b.UI.MessageWindow];return u.menuBar=new r.jyi(c),u.menuButton=new r.jyi(l),u.itemPanelFrame=new r.jyi(h),u.messageWindow=new r.jyi(p),u.initMenuBarAndMenuButton(),u.initItemPanelFrameAndItemPanels(n),u.initMessageWindow(s),u}var n,o,s,a=i.prototype;return a.initMessageWindow=function(t){var e=this;t.forEach((function(t,i){if(!de(t,r.xvT)){var n=e;t.on("pointertap",(function(){n.onOptionButtonTapped(t)}))}})),this.messageWindow.scale.set((.8*f.game.view.width+20)/this.messageWindow.width,f.game.view.height/6/this.messageWindow.height),this.messageWindow.anchor.set(.5,.5),this.messageWindow.position.x=367,t.forEach((function(t,i){t.visible=!1,e.messageWindow.addChild(t)})),this.messageWindow.visible=!1,this.addChild(this.messageWindow)},a.initItemPanelFrameAndItemPanels=function(t){this.itemPanelFrame.scale.set((.8*f.game.view.width+20)/this.itemPanelFrame.width,(f.game.view.height/4+30)/this.itemPanelFrame.height),this.itemPanelFrame.position.set(100,10);var e=!0,i=!1,n=void 0;try{for(var o,r=this,s=function(t,e){var i=e.value,n=r;i.on("pointertap",(function(){n.onItemPanelTapped(i)})),r.itemPanels.set(i.itemType,i),i.scale.set((r.itemPanelFrame.texture.width-8)/6/i.width,(r.itemPanelFrame.texture.height/2-5)/i.height),r.itemPanelFrame.addChild(i)},a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)s(0,o)}catch(u){i=!0,n=u}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}this.itemPanelFrame.visible=!1,this.addChild(this.itemPanelFrame)},a.initMenuBarAndMenuButton=function(){var t=this;this.menuButton.interactive=!0,this.menuButton.on("pointertap",(function(){t.onMenuButtonTapped()})),this.menuBar.scale.set(f.game.view.width/7/this.menuBar.width,f.game.view.height/2/this.menuBar.height),this.menuButton.scale.set(this.menuBar.width/this.menuButton.width,this.menuBar.height/6/this.menuButton.height),this.menuBar.scale.y=(f.game.view.height/2-this.menuButton.height)/this.menuBar.texture.height,this.menuBar.position.y=this.menuButton.height,this.menuMoveRate=this.menuBar.width/i.menuMoveFrame,this.menuBar.addChild(this.menuButton);var e=!0,n=!1,o=void 0;try{for(var r,s=this,a=function(t,e){var i=e.value,n=s;i.on("pointertap",(function(){n.onMenuOptionButtonTapped(i)})),i.position.x=s.menuBar.texture.width/2,i.interactive=!0,s.menuBar.addChild(i)},u=this.menuOptionButtons[Symbol.iterator]();!(e=(r=u.next()).done);e=!0)a(0,r)}catch(c){n=!0,o=c}finally{try{e||null==u.return||u.return()}finally{if(n)throw o}}this.addChild(this.menuBar),this.addChild(this.menuButton)},a.isDestroyed=function(){return this._destroyed},a.update=function(t){this.isDestroyed()||(this.isOpen&&this.menuBar.position.x<0&&(this.menuBar.position.x+=this.menuMoveRate),!this.isOpen&&this.menuBar.position.x>-this.menuBar.width&&(this.menuBar.position.x-=this.menuMoveRate))},a.updateItemPanels=function(t){this.itemPanels.forEach((function(t,e){t.removeItem()}));var e=!0,i=!1,n=void 0;try{for(var o,s=t[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){var a=o.value;if(a===g.FROZEN_BANANA){var u=this.itemPanels.get(g.BANANA);if(!u)continue;u.hasItem=!0;var c=r.P6Y.kN[b.Dynamic.items(g.FROZEN_BANANA)];u.optionButton.texture=c,u.itemType=g.FROZEN_BANANA,u.itemTextId="frozen_banana_text",u.optionId="use_frozen_banana"}if(a===g.SHARPENED_PENCIL){var l=this.itemPanels.get(g.PENCIL);if(!l)continue;l.hasItem=!0;var h=r.P6Y.kN[b.Dynamic.items(g.SHARPENED_PENCIL)];l.optionButton.texture=h,l.itemType=g.SHARPENED_PENCIL,l.itemTextId="sharpened_pencil_text",l.optionId="use_sharpened_pencil"}var p=this.itemPanels.get(a);p&&p.addItem()}}catch(f){i=!0,n=f}finally{try{e||null==s.return||s.return()}finally{if(i)throw n}}},a.onOptionButtonTapped=function(t){p.playSe(b.Audio.Se.OptionTap),t.isActive?(t.optionType===gt.DoNoting&&(this.messageWindow.visible=!1,this.menuOptionButtons.forEach((function(t,e){t.deactivate()}))),this.delegate.onOptionSelected(t.optionType)):(this.optionButtons.forEach((function(t,e){t.deactivate()})),t.activate())},a.onItemPanelTapped=function(t){if(p.playSe(b.Audio.Se.OptionTap),this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1})),this.messageWindow.visible=!1,t.activate(),t.hasItem){var e=this.texts.get(t.itemTextId);if(!e)return;this.messageWindow.position.y=260,this.messageWindow.visible=!0,e.visible=!0}},a.onMenuOptionButtonTapped=function(t){if(p.playSe(b.Audio.Se.OptionTap),t.isActive)t.deactivate(),this.toggleDisplay(t.optionType,!1);else{var e=this;this.menuOptionButtons.forEach((function(t,i){t.deactivate(),e.toggleDisplay(t.optionType,!1)})),this.toggleDisplay(t.optionType,!0),t.activate()}},a.onMenuButtonTapped=function(){if(p.playSe(b.Audio.Se.OptionTap),this.isOpen=!this.isOpen,!this.isOpen){var t=this;this.menuOptionButtons.forEach((function(e,i){e.deactivate(),t.toggleDisplay(e.optionType,!1)})),this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1})),this.messageWindow.visible=!1}},a.toggleDisplay=function(t,e){if(t===gt.ShowItems&&(this.itemPanelFrame.visible=e,e||(this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1,de(t,qt)&&t.deactivate()})),this.messageWindow.visible=!1)),t===gt.ShowBackToTitle){this.messageWindow.position.y=270,this.messageWindow.visible=e;var i=this.texts.get(b.MessageIds.BackToTitle),n=this.texts.get(b.MessageIds.ContinueGame);if(!i)return;if(!n)return;i.visible=e,de(i,qt)&&i.activate(),n.visible=e}t===gt.ShowSoundVolume&&(this.soundOption.visible=e)},n=i,s=[{key:"resourceList",get:function(){return[b.UI.MenuBar,b.UI.MenuButton,b.UI.ItemPanelFrame]}}],(o=null)&&pe(n.prototype,o),s&&pe(n,s),i}(r.W20);function we(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Oe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Se(t){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _e(t,e){return!e||"object"!==Re(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ee(t,e){return(Ee=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Te(t){return function(t){if(Array.isArray(t))return we(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return we(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return we(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}be.menuMoveFrame=10;var Re=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Ie(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Se(t);if(e){var o=Se(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return _e(this,i)}}var je=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ee(t,e)}(i,t);var e=Ie(i);function i(){return Oe(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e=new r.jyi;if(t){var i,n,o=t.textureName;if(o&&r.P6Y.kN[o]&&(e.texture=r.P6Y.kN[o]),t.anchor)(i=e.anchor).set.apply(i,Te(t.anchor));if(t.scale)(n=e.scale).set.apply(n,Te(t.scale))}var s=t.optionType;return new qt(e,s)},i}(S);function Ce(t){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xe(t,e){return!e||"object"!==Ae(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pe(t,e){return(Pe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ae=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Be(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ce(t);if(e){var o=Ce(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return xe(this,i)}}var De=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pe(t,e)}(i,t);var e=Be(i);function i(t,n,o,r,s){var a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(a=e.call(this,t,r)).hasItem=!1,a.itemType=n,a.optionButton=t,a.itemTextId=o,a.optionId=s;var u=f.game.loader.resources[b.UI.ItemSelectFrame].texture;return u&&(a.frameSprite.texture=u),a.frameSprite.scale.set(1,1),a}var n=i.prototype;return n.addItem=function(){this.hasItem=!0,this.optionButton.texture=r.P6Y.kN[b.Dynamic.items(this.itemType)]},n.removeItem=function(){this.hasItem=!1,this.optionButton.texture=r.P6Y.kN[b.Dynamic.items(0)]},i}(qt);function Ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function ke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ue(t){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Me(t,e){return!e||"object"!==Le(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ge(t,e){return(Ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function We(t){return function(t){if(Array.isArray(t))return Ne(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return Ne(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ne(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Le=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Fe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ue(t);if(e){var o=Ue(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Me(this,i)}}var Ve=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ge(t,e)}(i,t);var e=Fe(i);function i(){return ke(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e=new r.jyi;if(t){var i,n,o=t.textureName;if(o&&r.P6Y.kN[o]&&(e.texture=r.P6Y.kN[o]),t.anchor)(i=e.anchor).set.apply(i,We(t.anchor));if(t.scale)(n=e.scale).set.apply(n,We(t.scale))}return new De(e,t.itemType,t.itemTextId,t.optionType,t.optionId)},i}(S),He=Object.freeze({DownTiles:"downTiles",Position:"position",MessageIds:"messageIds",TextureName:"textureName",Visible:"visible"});function ze(t,e,i){return(ze="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ke(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function Ke(t){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ye(t,e){return!e||"object"!==Je(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qe(t,e){return(qe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Je=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Ze(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ke(t);if(e){var o=Ke(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ye(this,i)}}var Xe=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qe(t,e)}(i,t);var e=Ze(i);function i(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=e.call(this)).isPaused=!1,n.tiles=new Map,n.roomObjects=new Map,n.messages=new Map,n.options=new Map,n.messageWindow=null,n.itemPanels=[],n.menuTexts=new Map,n.soundOption=new r.W20,n.pinPad=new r.W20,n.code=[],n.correctCode=[],n.transitionIn=new y(1,0,-.02),n.transitionOut=new y(0,1,.02),n.state=bt.LOADING_RESOURCES,n.sceneName="escape_scene",n.language=t,n.saveData={roomObject:[],mapData:void 0,playerItems:[],roomObjectState:[],code:[],isBalloonExist:!0},n.gameLogic=new vt,n}var n=i.prototype;return n.beginTransitionIn=function(t,e){var n=this;ze(Ke(i.prototype),"beginTransitionIn",this).call(this,(function(){n.state===bt.RESOURCE_LOADED&&(n.state=bt.READY,t(n),p.playBgm(b.Audio.Bgm.EscapeBGM))}),e)},n.createInitialResourceList=function(){return ze(Ke(i.prototype),"createInitialResourceList",this).call(this).concat(b.UI.Tiles,b.UI.TileFrame,b.UI.PlayerAnimation,b.UI.Player,b.UI.RoomObjectMaster,b.UI.Items,b.UI.RoomObjects,he.resourceList,qt.resourceList,be.resourceList,[b.UI.Stage,b.Audio.Se.OptionTap,b.Audio.Se.ShowNextText,b.Audio.Se.TileTap,b.Audio.Bgm.EscapeBGM,b.Audio.Bgm.EndingBGM])},n.loadInitialResource=function(t){var e,i,n=this.createInitialResourceList(),o=b.UI.SceneUiGraph(this.sceneName);e="japanese"===this.language?b.UI.EscapeSceneMessage:b.UI.EscapeSceneEnglishMessage,i="japanese"===this.language?b.UI.EscapeSceneOption:b.UI.EscapeSceneEnglishOption;var r=b.UI.EscapeSceneRoomObject;n.push(o),n.push(e),n.push(i),n.push(r);var s=this.filterLoadedAssets(n);s.length>0?f.game.loader.add(s).load(t):t()},n.onInitialResourceLoaded=function(){var t,e=[],i=b.UI.SceneUiGraph(this.sceneName);t="japanese"===this.language?b.UI.EscapeSceneOption:b.UI.EscapeSceneEnglishOption;var n=b.UI.EscapeSceneRoomObject,o=f.game.loader.resources[i].data.nodes;o=(o=o.concat(f.game.loader.resources[t].data.nodes)).concat(f.game.loader.resources[n].data.nodes);var r=!0,s=!1,a=void 0;try{for(var u,c=o[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var l=u.value;"sprite"!==l.type&&"sprite_option"!==l.type&&"room_object"!==l.type&&"item_panel"!==l.type||e.push({name:l.params.textureName,url:l.params.url})}}catch(h){s=!0,a=h}finally{try{r||null==c.return||c.return()}finally{if(s)throw a}}return e},n.onResourceLoaded=function(){var t,e,i=f.game.loader.resources[b.UI.SceneUiGraph(this.sceneName)].data;t="japanese"===this.language?b.UI.EscapeSceneMessage:b.UI.EscapeSceneEnglishMessage,e="japanese"===this.language?b.UI.EscapeSceneOption:b.UI.EscapeSceneEnglishOption;var n=f.game.loader.resources[t].data,o=f.game.loader.resources[e].data,r=f.game.loader.resources[b.UI.EscapeSceneRoomObject].data;this.prepareUiGraphContainer(i),this.prepareUiGraphContainer(n),this.prepareUiGraphContainer(o),this.prepareUiGraphContainer(r);var s=f.game.loader.resources,a=s[b.UI.Stage].data,u=s[b.UI.RoomObjectMaster].data;this.playerAnimationMaster=s[b.UI.PlayerAnimation].data,this.tileSize=a.tileSize,this.initTiles(a,this.tileSize),this.uiGraphContainer.zIndex=1,this.addChild(this.uiGraphContainer),this.initSound(),this.initPinPad(),this.setHitArea(),this.initMenu(),this.initVolumeText(),this.initSoundOption(),this.loadSaveDataFromDB(a,u)},n.setHitArea=function(){var t=this.roomObjects.get("bowl");if(t){t.hitArea=new r.Cdc(t.width/2,t.height/2,30);var e=this.options.get("use_salt");e&&(e.hitArea=new r.AeJ(-75,-25,150,50))}},n.initMenu=function(){var t=[],e=!0,i=!1,n=void 0;try{for(var o,r=b.MenuOptionIds[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=this.options.get(s);a&&t.push(a)}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}var u=new be(t,this.itemPanels,this.soundOption,this.menuTexts,this);this.menu=u,this.menu.zIndex=3,this.registerUpdatingObject(u),this.addChild(this.menu)},n.initSoundOption=function(){var t=!0,e=!1,i=void 0;try{for(var n,o=b.SoundOptionIds[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var r=n.value,s=this.uiGraph.get(r);s&&this.soundOption.addChild(s)}}catch(a){e=!0,i=a}finally{try{t||null==o.return||o.return()}finally{if(e)throw i}}this.soundOption.visible=!1,this.soundOption.zIndex=3,this.addChild(this.soundOption)},n.initCode=function(){var t=this.messages.get("mirror_message_4");t&&("japanese"===this.language?t.text="\u624b\u93e1\u3067\u9996\u306e\u5f8c\u308d\u3092\u898b\u308b\u3068            \u5c0f\u3055\u304f\u300c".concat(this.correctCode[0].toString()+this.correctCode[1].toString()+this.correctCode[2].toString(),"\u300d\u3068\u66f8\u304b\u308c\u3066\u3044\u308b\u3002"):t.text="when you looked at the back of your neck             with the hand mirror, it was written as '".concat(this.correctCode[0].toString()+this.correctCode[1].toString()+this.correctCode[2].toString(),"'"))},n.initPinPad=function(){var t=!0,e=!1,i=void 0;try{for(var n,o=b.PinPadIds[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var r=n.value,s=this.uiGraph.get(r);s&&this.pinPad.addChild(s)}}catch(a){e=!0,i=a}finally{try{t||null==o.return||o.return()}finally{if(e)throw i}}this.pinPad.visible=!1,this.pinPad.zIndex=3,this.addChild(this.pinPad)},n.initVolumeText=function(){var t=Math.round(100*p.bgmVolume),e=Math.round(10*p.seVolume);this.uiGraph.get("bgm_volume").text=t.toString();this.uiGraph.get("se_volume").text=e.toString()},n.initSound=function(){var t=f.game.loader.resources,e=[b.Audio.Se.OptionTap,b.Audio.Se.ShowNextText,b.Audio.Se.TileTap,b.Audio.Bgm.EscapeBGM,b.Audio.Bgm.EndingBGM],i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;p.createSound(a,t[a].buffer)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},n.update=function(t){if(!this.isPaused)switch(this.state){case bt.LOADING_RESOURCES:break;case bt.READY:this.state=bt.INGAME;break;case bt.INGAME:case bt.FINISHED:this.gameLogic.update()}this.updateRegisteredObjects(t),this.transitionIn.isActive()?this.transitionIn.update(t):this.transitionOut.isActive()&&this.transitionOut.update(t)},n.onRoomObjectTapped=function(t){if(!this.messageWindow){p.playSe(b.Audio.Se.OptionTap),this.roomObjects.forEach((function(t,e){t.interactive=!1})),this.tiles.forEach((function(t,e){t.isActive&&t.toggleFrame(),t.interactive=!1}));var e=this.roomObjects.get(t);e&&(this.spawnMessageWindow(e.messageIds),this.gameLogic.onRoomObjectTapped(t))}},n.onPlayerSpawned=function(t){this.tiles.forEach((function(e){e.tilePosition[0]===t.positionRow&&e.tilePosition[1]===t.positionColumn&&(e.interactive=!1)})),this.player=new wt(this.playerAnimationMaster,this.tileSize,{x:t.positionColumn*this.tileSize,y:t.positionRow*this.tileSize-this.tileSize/3}),this.player.sprite.zIndex=2,this.addChild(this.player.sprite),this.registerUpdatingObject(this.player),this.sortChildren()},n.onPlayerEntityStateChanged=function(t){if(t.state===dt.IDLE&&(this.player.requestAnimation(b.AnimationTypes.Player.WAIT),this.tiles.forEach((function(e){t.positionRow===e.tilePosition[0]&&t.positionColumn===e.tilePosition[1]?e.interactive=!1:e.interactive=!0})),this.roomObjects.forEach((function(e,i){var n=!0,o=!1,r=void 0;try{for(var s,a=e.downTiles[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;(u[0]===t.positionRow-1&&u[1]===t.positionColumn||u[0]===t.positionRow+1&&u[1]===t.positionColumn||u[0]===t.positionRow&&u[1]===t.positionColumn-1||u[0]===t.positionRow&&u[1]===t.positionColumn+1)&&(e.interactive=!0)}}catch(c){o=!0,r=c}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}}))),t.state===dt.WALK&&this.roomObjects.forEach((function(t,e){t.interactive=!1})),t.state===dt.CHECKING){if(t.checkingObject===b.RoomObjects.CLOCK)return void this.player.requestAnimation(b.AnimationTypes.Player.CHACKUP);if(null===t.checkingObject)return;var e=this.roomObjects.get(t.checkingObject);if(!e)return;var i=0,n=0,o=0,r=0,s=!0,a=!1,u=void 0;try{for(var c,l=e.downTiles[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var h=c.value;h[0]<t.positionRow?i++:h[0]>t.positionRow&&n++,h[1]<t.positionColumn?o++:h[1]>t.positionColumn&&r++}}catch(p){a=!0,u=p}finally{try{s||null==l.return||l.return()}finally{if(a)throw u}}i===e.downTiles.length?this.player.requestAnimation(b.AnimationTypes.Player.CHACKUP):n===e.downTiles.length?this.player.requestAnimation(b.AnimationTypes.Player.CHACKDOWN):o===e.downTiles.length?this.player.requestAnimation(b.AnimationTypes.Player.CHACKLEFT):r===e.downTiles.length&&this.player.requestAnimation(b.AnimationTypes.Player.CHACKRIGHT)}},n.onBgmArrowTapped=function(t){var e=p.bgmVolume;(e+=t)<0?e=0:e>.1&&(e=.1);this.uiGraph.get("bgm_volume").text=Math.round(100*e).toString(),p.bgmVolume=e,p.playSe(b.Audio.Se.OptionTap),this.saveBgmVolumeToDB(p.bgmVolume),p.setSoundVolume(p.bgmVolume,p.seVolume)},n.onSeArrowTapped=function(t){var e=p.seVolume;(e+=t)<0?e=0:e>1&&(e=1);this.uiGraph.get("se_volume").text=Math.round(10*e).toString(),p.seVolume=e,p.playSe(b.Audio.Se.OptionTap),this.saveSeVolumeToDB(p.seVolume)},n.onPinPadTapped=function(t){if(p.playSe(b.Audio.Se.OptionTap),!(this.code.length>=3)){var e;this.code.push(t),e=1===this.code.length?"first":2===this.code.length?"second":"third";var i=this.uiGraph.get("code_".concat(e));i&&(i.text=t.toString())}},n.onPinPadCancelTapped=function(){if(p.playSe(b.Audio.Se.OptionTap),0!==this.code.length){var t;this.code.pop(),t=0===this.code.length?"first":1===this.code.length?"second":"third";var e=this.uiGraph.get("code_".concat(t));e&&(e.text="")}},n.onPinPadEnterTapped=function(){this.gameLogic.onRoomObjectTapped("safe"),p.playSe(b.Audio.Se.OptionTap),this.isPaused=!1;var t=this.uiGraph.get("code_first"),e=this.uiGraph.get("code_second"),i=this.uiGraph.get("code_third");if(t&&e&&i){if(t.text="",e.text="",i.text="",this.code[0]===this.correctCode[0]&&this.code[1]===this.correctCode[1]&&this.code[2]===this.correctCode[2]){this.spawnMessageWindow(["safe_opened","there_is_crossbow",["get_crossbow","do_nothing"]]);var n=this.roomObjects.get("safe");if(!n)return;n.messageIds.pop(),n.messageIds=["safe_message_1","there_is_crossbow",["get_crossbow","do_nothing"]],this.saveRoomObjectToDB(b.RoomObjects.SAFE,He.MessageIds,n.messageIds)}else{this.spawnMessageWindow(["wrong_code"])}this.pinPad.visible=!1,this.code=[]}},n.spawnMessageWindow=function(t){this.messages.forEach((function(t,e){t.visible=!0})),this.options.forEach((function(t,e){t.visible=!0}));var e=this.createMessages(t),i=new he(e,this);i.zIndex=3,this.messageWindow=i,this.addChild(i),this.registerUpdatingObject(i)},n.createMessages=function(t){var e=[],i=!0,n=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value,u=[];if("string"===typeof a){var c=this.messages.get(a);if(!c)continue;e.push(c)}else{var l=!0,h=!1,p=void 0;try{for(var f,d=a[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value,y=this.options.get(m);y&&u.push(y)}}catch(g){h=!0,p=g}finally{try{l||null==d.return||d.return()}finally{if(h)throw p}}e.push(u)}}}catch(g){n=!0,o=g}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return e},n.onMessageWindowClosed=function(){this.gameLogic.onChackingEnd(),this.messageWindow=null},n.onOptionSelected=function(t){if(t!==gt.DoNoting){if(t!==gt.ShowItemOption)return t===gt.ShowPinPad?(this.isPaused=!0,void(this.pinPad.visible=!0)):t===gt.BackToTitle?(this.visible=!1,void this.showTitleScene()):void this.gameLogic.onOptionSelected(t);var e=this,i=[];if(this.itemPanels.forEach((function(t,n){if(t.hasItem){var o=e.options.get(t.optionId);if(!o)return;i.push(o)}})),0===i.length){var n,o=this.messages.get("has_no_item");if(!o)return;null===(n=this.messageWindow)||void 0===n||n.addText(o,1)}else{var r;null===(r=this.messageWindow)||void 0===r||r.addText(i,1)}}},n.onItemUsed=function(t,e,i){var n=this.roomObjects.get(e.id);if(n)if(t===gt.UseTinStatue&&e.id===b.RoomObjects.GAS_STOVE){var o,s,a=this.messages.get("tin_statue_melted"),u=this.messages.get("get_coin");if(!a)return;if(!u)return;null===(o=this.messageWindow)||void 0===o||o.addText(a,1),null===(s=this.messageWindow)||void 0===s||s.addText(u,2),n.messageIds.pop(),n.messageIds.pop(),this.saveRoomObjectToDB(b.RoomObjects.GAS_STOVE,He.MessageIds,n.messageIds)}else if(t===gt.UseDVD&&e.id===b.RoomObjects.TV){var c,l,h=this.messages.get("serching"),p=this.messages.get("watched_dvd");if(!h)return;if(!p)return;null===(c=this.messageWindow)||void 0===c||c.addText(h,1),null===(l=this.messageWindow)||void 0===l||l.addText(p,2)}else if(t===gt.UseCoin&&e.id===b.RoomObjects.VENDING_MACHINE){var d,m=this.messages.get("get_banana");if(!m)return;null===(d=this.messageWindow)||void 0===d||d.addText(m,1),n.messageIds.pop(),this.saveRoomObjectToDB(b.RoomObjects.VENDING_MACHINE,He.MessageIds,n.messageIds)}else if(t===gt.UseBanana&&e.id===b.RoomObjects.FREEZER){var y,v=this.messages.get("freeze_banana");if(!v)return;null===(y=this.messageWindow)||void 0===y||y.addText(v,1),n.messageIds.pop(),this.saveRoomObjectToDB(b.RoomObjects.FREEZER,He.MessageIds,n.messageIds)}else if(t===gt.UseSalt&&e.id===b.RoomObjects.BARREL){var w,O,S=this.messages.get("put_salt_in_barrel"),_=this.messages.get("get_desk_key");if(!S)return;if(!_)return;null===(w=this.messageWindow)||void 0===w||w.addText(S,1),null===(O=this.messageWindow)||void 0===O||O.addText(_,2),n.messageIds.pop(),n.messageIds.pop(),this.saveRoomObjectToDB(b.RoomObjects.BARREL,He.MessageIds,n.messageIds)}else if(t===gt.UseDeskKey&&e.id===b.RoomObjects.DESK){var E,T,R,I=[],j=this.messages.get("unlock"),C=this.messages.get("there_is_pencil"),x=this.options.get("get_pencil"),P=this.options.get("do_nothing");if(!j)return;if(!C)return;if(!x)return;if(!P)return;I.push(x),I.push(P),null===(E=this.messageWindow)||void 0===E||E.addText(j,1),null===(T=this.messageWindow)||void 0===T||T.addText(C,2),null===(R=this.messageWindow)||void 0===R||R.addText(I,3)}else if(t===gt.UsePencil&&e.id===b.RoomObjects.GRINDER){var A,B,D=this.messages.get("grind_pencil"),N=this.messages.get("get_sharpened_pencil");if(!D)return;if(!N)return;null===(A=this.messageWindow)||void 0===A||A.addText(D,1),null===(B=this.messageWindow)||void 0===B||B.addText(N,2),n.messageIds.pop(),this.saveRoomObjectToDB(b.RoomObjects.GRINDER,He.MessageIds,n.messageIds)}else if(t===gt.UseDetergent&&e.id===b.RoomObjects.MIRROR){var k,U,M,G=[],W=this.messages.get("washed_mirror"),L=this.messages.get("mirror_message_3"),F=this.options.get("use_item"),V=this.options.get("do_nothing");if(!W)return;if(!L)return;if(!F)return;if(!V)return;G.push(F),G.push(V),null===(k=this.messageWindow)||void 0===k||k.addText(W,1),null===(U=this.messageWindow)||void 0===U||U.addText(L,2),null===(M=this.messageWindow)||void 0===M||M.addText(G,3),n.messageIds[1]="mirror_message_3",this.saveRoomObjectToDB(b.RoomObjects.MIRROR,He.MessageIds,n.messageIds);var H=r.P6Y.kN["room_object/mirror.png"];n.sprite.texture=H,this.saveRoomObjectToDB(b.RoomObjects.MIRROR,He.TextureName,"room_object/mirror.png")}else if(t===gt.UseHandMirror&&e.id===b.RoomObjects.MIRROR&&-1!==e.states.indexOf(yt.Washed)){var z,K=this.messages.get("mirror_message_4");if(!K)return;null===(z=this.messageWindow)||void 0===z||z.addText(K,1)}else if(t===gt.UseCarKey&&e.id===b.RoomObjects.CAR){var Y=this;this.isPaused=!0,this.beginTransitionOut((function(){Y.isPaused=!1,Y.player.sprite.position.set(456.4,426.6);var t=f.game.loader.resources[b.UI.Stage].data.carMovedMapData;Y.resetTiles(t),Y.saveData.mapData=t,Y.saveProgressToDB(),n.position.x=380,Y.saveRoomObjectToDB(b.RoomObjects.CAR,He.Position,[n.position.x,n.position.y]),n.downTiles=[[8,6],[8,7],[8,8],[9,6],[9,7],[9,8]],Y.saveRoomObjectToDB(b.RoomObjects.CAR,He.DownTiles,n.downTiles),Y.spawnMessageWindow(["moved_car"]),Y.beginTransitionIn((function(){})),n.messageIds.pop(),Y.saveRoomObjectToDB(b.RoomObjects.CAR,He.MessageIds,n.messageIds)}),!1)}else if(t===gt.UseCrossBow&&e.id===b.RoomObjects.BALLOON&&-1!==(null===i||void 0===i?void 0:i.indexOf(g.SHARPENED_PENCIL))){var q=this;this.isPaused=!0,this.beginTransitionOut((function(){q.isPaused=!1,n.sprite.visible=!1,q.saveRoomObjectToDB(b.RoomObjects.BALLOON,He.Visible,n.sprite.visible);var t=q.tiles.get(65);t&&(t.tileSprite.texture=r.P6Y.kN["stage/floor.png"],q.saveData.isBalloonExist=!1,q.saveProgressToDB(),q.spawnMessageWindow(["find_nail","get_nail"]),q.gameLogic.onRoomObjectTapped(b.RoomObjects.BALLOON),q.beginTransitionIn((function(){})))}),!1)}else if(t===gt.UseFrozenBanana&&e.id===b.RoomObjects.CHAIR&&-1!==(null===i||void 0===i?void 0:i.indexOf(g.NAIL))){var J=this;this.isPaused=!0,this.beginTransitionOut((function(){J.isPaused=!1;var t=r.P6Y.kN["room_object/chair.png"];n.sprite.texture=t,J.saveRoomObjectToDB(b.RoomObjects.CHAIR,He.TextureName,"room_object/chair.png"),n.position.set(205,85),J.saveRoomObjectToDB(b.RoomObjects.CHAIR,He.Position,[n.position.x,n.position.y]),n.messageIds=["chair_message_1"],J.saveRoomObjectToDB(b.RoomObjects.CHAIR,He.MessageIds,n.messageIds),J.spawnMessageWindow(["fix_chair"]),J.gameLogic.onRoomObjectTapped(b.RoomObjects.CHAIR),J.beginTransitionIn((function(){}))}),!1);var Z=this.roomObjects.get("clock");if(!Z)return;Z.messageIds=["clock_message_2","clock_message_3",["set_clock","do_nothing"]],this.saveRoomObjectToDB(b.RoomObjects.CLOCK,He.MessageIds,Z.messageIds)}else{var X,$=this.messages.get("can_not_use");if(!$)return;null===(X=this.messageWindow)||void 0===X||X.addText($,1)}},n.onPlayerItemsChanged=function(t){this.saveData.playerItems=t,this.saveProgressToDB(),this.menu.updateItemPanels(t)},n.onRoomObjectOptionSelected=function(t,e){var i=this.roomObjects.get(t.id);if(i){if(e===gt.CheckUnderBed)if(-1===t.states.indexOf(yt.CheckedUnderBed)){var n,o,s=this.messages.get("serching"),a=this.messages.get("get_tin_statue");if(!s)return;if(!a)return;null===(n=this.messageWindow)||void 0===n||n.addText(s,1),null===(o=this.messageWindow)||void 0===o||o.addText(a,2)}else{var u,c=this.messages.get(b.MessageIds.NothingSpecial);if(!c)return;null===(u=this.messageWindow)||void 0===u||u.addText(c,1)}if(e===gt.CheckUnderPillow)if(-1===t.states.indexOf(yt.CheckedUnderPillow)){var l,h,p=this.messages.get("serching"),d=this.messages.get("get_hand_mirror");if(!p)return;if(!d)return;null===(l=this.messageWindow)||void 0===l||l.addText(p,1),null===(h=this.messageWindow)||void 0===h||h.addText(d,2)}else{var m,y=this.messages.get(b.MessageIds.NothingSpecial);if(!y)return;null===(m=this.messageWindow)||void 0===m||m.addText(y,1)}if(e===gt.JumpOnBed)if(-1===t.states.indexOf(yt.JumpedOnBed)){var g,v=this.messages.get("something_on_closet");if(!v)return;null===(g=this.messageWindow)||void 0===g||g.addText(v,1);var w=this.roomObjects.get(b.RoomObjects.CLOSET),O=null===w||void 0===w?void 0:w.messageIds[w.messageIds.length-1];R=O,(null!=(I=Array)&&"undefined"!==typeof Symbol&&I[Symbol.hasInstance]?I[Symbol.hasInstance](R):R instanceof I)&&O.unshift("check_on_closet"),this.saveRoomObjectToDB(b.RoomObjects.CLOSET,He.MessageIds,null===w||void 0===w?void 0:w.messageIds)}else if(-1===t.states.indexOf(yt.GotCarKey)){var S,_=this.messages.get("something_on_closet");if(!_)return;null===(S=this.messageWindow)||void 0===S||S.addText(_,1)}else{var E,T=this.messages.get("have_a_fun");if(!T)return;null===(E=this.messageWindow)||void 0===E||E.addText(T,1)}var R,I;if(e===gt.CheckInCloset)if(-1===t.states.indexOf(yt.CheckedInCloset)){var j,C,x=this.messages.get("serching"),P=this.messages.get("get_detergent");if(!x)return;if(!P)return;null===(j=this.messageWindow)||void 0===j||j.addText(x,1),null===(C=this.messageWindow)||void 0===C||C.addText(P,2)}else{var A,B=this.messages.get(b.MessageIds.NothingSpecial);if(!B)return;null===(A=this.messageWindow)||void 0===A||A.addText(B,1)}if(e===gt.CheckOnCloset)if(-1===t.states.indexOf(yt.CheckedOnCloset)){var D,N,k=this.messages.get("serching"),U=this.messages.get("get_car_key");if(!k)return;if(!U)return;null===(D=this.messageWindow)||void 0===D||D.addText(k,1),null===(N=this.messageWindow)||void 0===N||N.addText(U,2)}else{var M,G=this.messages.get(b.MessageIds.NothingSpecial);if(!G)return;null===(M=this.messageWindow)||void 0===M||M.addText(G,1)}if(e===gt.GetSalt){var W,L=this.messages.get("get_salt");if(!L)return;null===(W=this.messageWindow)||void 0===W||W.addText(L,1),i.messageIds.pop(),i.messageIds.pop(),this.saveRoomObjectToDB(b.RoomObjects.CABINET,He.MessageIds,i.messageIds)}if(e===gt.GetCrossbow){var F,V=this.messages.get("get_crossbow");if(!V)return;null===(F=this.messageWindow)||void 0===F||F.addText(V,1),i.messageIds.pop(),i.messageIds.pop(),this.saveRoomObjectToDB(b.RoomObjects.SAFE,He.MessageIds,i.messageIds)}if(e===gt.GetDVD){var H,z=this.messages.get("get_dvd");if(!z)return;null===(H=this.messageWindow)||void 0===H||H.addText(z,1)}if(e===gt.CheckRightDrawer)if(-1===t.states.indexOf(yt.UsedKey)){var K,Y,q=[],J=this.messages.get("locked"),Z=this.options.get("use_item"),X=this.options.get("do_nothing");if(!J)return;if(!Z)return;if(!X)return;q.push(Z),q.push(X),null===(K=this.messageWindow)||void 0===K||K.addText(J,1),null===(Y=this.messageWindow)||void 0===Y||Y.addText(q,2)}else if(-1===t.states.indexOf(yt.HasNoPencil)){var $,Q,tt=[],et=this.messages.get("there_is_pencil"),it=this.options.get("get_pencil"),nt=this.options.get("do_nothing");if(!et)return;if(!it)return;if(!nt)return;tt.push(it),tt.push(nt),null===($=this.messageWindow)||void 0===$||$.addText(et,1),null===(Q=this.messageWindow)||void 0===Q||Q.addText(tt,2)}else{var ot,rt=this.messages.get(b.MessageIds.NothingSpecial);if(!rt)return;null===(ot=this.messageWindow)||void 0===ot||ot.addText(rt,1)}if(e===gt.CheckLeftDrawer)if(-1===t.states.indexOf(yt.HasNoDVD)){var st,at,ut=[],ct=this.messages.get("there_is_dvd"),lt=this.options.get("get_dvd"),ht=this.options.get("do_nothing");if(!ct)return;if(!lt)return;if(!ht)return;ut.push(lt),ut.push(ht),null===(st=this.messageWindow)||void 0===st||st.addText(ct,1),null===(at=this.messageWindow)||void 0===at||at.addText(ut,2)}else{var pt,ft=this.messages.get(b.MessageIds.NothingSpecial);if(!ft)return;null===(pt=this.messageWindow)||void 0===pt||pt.addText(ft,1)}if(e===gt.GetPenCil){var dt,mt=this.messages.get("get_pencil");if(!mt)return;null===(dt=this.messageWindow)||void 0===dt||dt.addText(mt,1)}if(e===gt.MovePig){var vt,bt=this.messages.get("not_move");if(!bt)return;null===(vt=this.messageWindow)||void 0===vt||vt.addText(bt,1)}if(e===gt.ReadHint){var wt,Ot=[],St=this.options.get("hint_1"),_t=this.options.get("hint_2");if(!St)return;if(!_t)return;Ot.push(St),Ot.push(_t),null===(wt=this.messageWindow)||void 0===wt||wt.addText(Ot,1)}if(e===gt.ReadHint1){var Et,Tt=this.messages.get("hint_1");if(!Tt)return;null===(Et=this.messageWindow)||void 0===Et||Et.addText(Tt,1)}if(e===gt.ReadHint2){var Rt,It=this.messages.get("hint_2");if(!It)return;null===(Rt=this.messageWindow)||void 0===Rt||Rt.addText(It,1)}if(e===gt.SetTime){var jt=this;this.isPaused=!0,this.beginTransitionOut((function(){jt.isPaused=!1;var t=f.game.loader.resources[b.UI.Stage].data.pigMovedMapData;jt.resetTiles(t),jt.saveData.mapData=t,jt.saveProgressToDB();var e=jt.roomObjects.get("pig");if(e){var n=r.P6Y.kN["room_object/pig2.png"],o=r.P6Y.kN["room_object/clock_12_00.png"];e.sprite.texture=n,jt.saveRoomObjectToDB(b.RoomObjects.PIG,He.TextureName,"room_object/pig2.png"),i.sprite.texture=o,jt.saveRoomObjectToDB(b.RoomObjects.CLOCK,He.TextureName,"room_object/clock_12_00.png"),e.position.set(40,565),jt.saveRoomObjectToDB(b.RoomObjects.PIG,He.Position,[e.position.x,e.position.y]),e.downTiles=[[9,1]],jt.saveRoomObjectToDB(b.RoomObjects.PIG,He.DownTiles,e.downTiles),e.messageIds=["pig_message_2"],jt.saveRoomObjectToDB(b.RoomObjects.PIG,He.MessageIds,e.messageIds),jt.spawnMessageWindow(["moved_pig"]),jt.beginTransitionIn((function(){})),i.messageIds.pop(),i.messageIds.pop(),jt.saveRoomObjectToDB(b.RoomObjects.CLOCK,He.MessageIds,i.messageIds)}}),!1)}}},n.onPlayerEntityWalked=function(t){switch(t.walkDirection){case pt.UP:this.player.requestAnimation(b.AnimationTypes.Player.WALKUP);break;case pt.DOWN:this.player.requestAnimation(b.AnimationTypes.Player.WALKDOWN);break;case pt.LEFT:this.player.requestAnimation(b.AnimationTypes.Player.WALKLEFT);break;case pt.RIGHT:this.player.requestAnimation(b.AnimationTypes.Player.WALKRIGHT)}if(this.tiles.forEach((function(e){t.positionRow===e.tilePosition[0]&&t.positionColumn===e.tilePosition[1]?e.interactive=!1:e.interactive=!0})),t.walkDirection===pt.UP||t.walkDirection===pt.DOWN?this.player.sprite.y=this.player.spawnedPosition.y+t.distanceRow:this.player.sprite.x=this.player.spawnedPosition.x+t.distanceColumn,3===t.positionRow&&4===t.positionColumn||3===t.positionRow&&5===t.positionColumn||3===t.positionRow&&6===t.positionColumn||4===t.positionRow&&4===t.positionColumn||4===t.positionRow&&5===t.positionColumn||4===t.positionRow&&6===t.positionColumn||5===t.positionRow&&5===t.positionColumn){if(0===this.player.sprite.zIndex)return;this.player.sprite.zIndex=0,this.sortChildren()}else{if(2===this.player.sprite.zIndex)return;this.player.sprite.zIndex=2,this.sortChildren()}},n.onTileTapped=function(t){var e=this;if(!this.isPaused&&!this.messageWindow){var i=!1;this.tiles.forEach((function(n){n.isActive&&t.tilePosition[0]===n.tilePosition[0]&&t.tilePosition[1]===n.tilePosition[1]?(e.gameLogic.requestWalk(t.tilePosition),t.toggleFrame(),i=!0):n.isActive&&(n.toggleFrame(),i=!0)})),!1===i&&t.toggleFrame()}},n.initRoomObject=function(t){var e=!0,i=!1,n=void 0;try{for(var o,s=t[Symbol.iterator]();!(e=(o=s.next()).done);e=!0){var a=o.value,u=this.roomObjects.get(a.id);if(!u)return;if(a.downTiles&&(u.downTiles=a.downTiles),a.messageIds&&(u.messageIds=a.messageIds),a.position&&u.position.set(a.position[0],a.position[1]),a.textureName){var c=r.P6Y.kN[a.textureName];u.sprite.texture=c}void 0!==a.visible&&(u.sprite.visible=a.visible)}}catch(l){i=!0,n=l}finally{try{e||null==s.return||s.return()}finally{if(i)throw n}}},n.initTiles=function(t,e){for(var i=this,n=function(n){for(var r=i,s=function(i){var o=r,s=a[i],u=new Rt(s,[n,i],e);u.position.set(i*r.tileSize,n*r.tileSize),1!==t.mapData[n][i]&&(u.touchable=!0,u.interactive=!0),u.on("pointertap",(function(){o.onTileTapped(u)}));var c=n.toString(),l=i.toString();r.tiles.set(Number(c+l),u),r.addChild(u)},a=o[n],u=0;u<a.length;u++)s(u)},o=t.tileData,r=0;r<o.length;r++)n(r)},n.onGameOver=function(){var t=this;this.isPaused=!0,this.menu.visible=!1,this.soundOption.visible=!1,this.deleteSaveData(),p.destroySound(b.Audio.Bgm.EscapeBGM),this.beginTransitionOut((function(){p.playBgm(b.Audio.Bgm.EndingBGM,6),t.spawnMessageWindow(["serching","wake_message_1","wake_message_2","wake_message_3","thanks_message",["back_to_title_2"]])})),this.state=bt.FINISHED},n.getCustomUiGraphFactory=function(t){return"room_object"===t?new Lt:"text_option"===t||"menu_text_option"===t?new ne:"sprite_option"===t?new je:"item_panel"===t?new Ve:null},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=L.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),"room_object"===s.type?(this.roomObjects.set(s.id,u),this.saveData.roomObject.push({id:s.id})):"message"===s.type?this.messages.set(s.id,u):"menu_text"===s.type||"menu_text_option"===s.type?this.menuTexts.set(s.id,u):"text_option"===s.type||"sprite_option"===s.type?this.options.set(s.id,u):"item_panel"===s.type?this.itemPanels.push(u):this.uiGraph.set(s.id,u),"room_object"===s.type&&this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.resetTiles=function(t){for(var e=0;e<t.length;e++)for(var i=t[e],n=0;n<i.length;n++){var o=t[e][n],r=e.toString(),s=n.toString(),a=this.tiles.get(Number(r+s));a&&(0===o?(a.touchable=!0,a.interactive=!0):(a.touchable=!1,a.interactive=!1))}},n.showTitleScene=function(){p.paused=!1,p.sceneIsPaused=!1,this.destroySound(),f.loadScene(new oi)},n.saveRoomObjectToDB=function(t,e,i){var n=!0,o=!1,r=void 0;try{for(var s,a=this.saveData.roomObject[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;if(u.id===t)switch(e){case"downTiles":u.downTiles=i;break;case"messageIds":u.messageIds=i;break;case"position":u.position=i;break;case"textureName":u.textureName=i;break;case"visible":u.visible=i}}}catch(c){o=!0,r=c}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}this.saveProgressToDB()},n.saveProgressToDB=function(){l.put("saveData",this.saveData)},n.loadSaveDataFromDB=function(t,e){var i=this;l.get("saveData",(function(n){if(n){if(i.saveData=n,i.initRoomObject(i.saveData.roomObject),void 0!==i.saveData.mapData&&i.resetTiles(i.saveData.mapData),0!==i.saveData.playerItems.length&&i.menu.updateItemPanels(i.saveData.playerItems),0!==i.saveData.code.length&&(i.correctCode=i.saveData.code),!i.saveData.isBalloonExist){var o=i.tiles.get(65);if(!o)return;o.tileSprite.texture=r.P6Y.kN["stage/floor.png"]}}else{i.spawnMessageWindow(["start_escape"]);for(var s=0;s<3;s++){var a=Math.floor(10*Math.random());i.correctCode.push(a)}i.saveData.code=i.correctCode,i.saveProgressToDB()}i.initCode(),i.gameLogic.init({delegator:i,stageMaster:t,roomObjectMaster:e,saveData:i.saveData}),i.transitionIn.isFinished()?i.state=bt.READY:i.state=bt.RESOURCE_LOADED}))},n.saveBgmVolumeToDB=function(t){l.put("bgmVolume",t)},n.saveSeVolumeToDB=function(t){l.put("seVolume",t)},n.deleteSaveData=function(){l.delete("saveData")},i}(J);function $e(t,e,i){return($e="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Qe(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function Qe(t){return(Qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ti(t,e){return!e||"object"!==ii(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ei(t,e){return(ei=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ii=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ni(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Qe(t);if(e){var o=Qe(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ti(this,i)}}var oi=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ei(t,e)}(i,t);var e=ni(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=e.call(this)).title1MoveRate=0,t.title2MoveRate=0,t.title3MoveRate=0,t.languageOption=new r.W20,t.confirmation=new r.W20,t.hasSaveData=!1,t.sceneName="title_scene",t.transitionIn=new y(1,0,-.02),t.transitionOut=new y(0,1,.02),t.loadSaveDataFromDB(),t}var n=i.prototype;return n.createInitialResourceList=function(){var t=$e(Qe(i.prototype),"createInitialResourceList",this).call(this);return t.push(b.Audio.Bgm.TitleBgm),t.push(b.Audio.Se.OptionTap),t},n.update=function(t){$e(Qe(i.prototype),"update",this).call(this,t),this.language?(this.updateTitles(),this.updateButtons()):this.elapsedFrameCount=0,90===this.elapsedFrameCount&&this.playBgmIfNeeded()},n.onResourceLoaded=function(){$e(Qe(i.prototype),"onResourceLoaded",this).call(this),this.setTitleMoveDistance(),this.languageOption.visible=!1,this.confirmation.visible=!1,this.uiGraphContainer.addChild(this.languageOption),this.uiGraphContainer.addChild(this.confirmation),this.addChild(this.uiGraphContainer),this.loadLanguageFromDB(),this.initSound()},n.initSound=function(){var t=f.game.loader.resources,e=[b.Audio.Se.OptionTap],i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;p.createSound(a,t[a].buffer)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},n.onLanguageSelected=function(t){p.playSe(b.Audio.Se.OptionTap);var e=this.uiGraph.get("new_game"),i=this.uiGraph.get("continue"),n=this.uiGraph.get("option"),o=this.uiGraph.get("credit");e&&i&&n&&o&&(e.interactive=!0,i.interactive=!0,n.interactive=!0,o.interactive=!0,this.languageOption.visible=!1,this.language=t,this.saveLanguageToDB(t))},n.easeOutQuint=function(t){return 1-Math.pow(1-t,5)},n.updateTitles=function(){var t=this.uiGraph.get("title_1"),e=this.uiGraph.get("title_2"),i=this.uiGraph.get("title_3");t&&e&&i&&(t.position.x===this.title1MoveDistance&&e.position.x===this.title2MoveDistance&&i.position.x===this.title3MoveDistance||(t.position.x>=this.title1MoveDistance?t.position.x=this.title1MoveDistance:(this.title1MoveRate+=10/this.title1MoveDistance,t.position.x=this.title1MoveDistance*this.easeOutQuint(this.title1MoveRate)),e.position.x>=this.title2MoveDistance?e.position.x=this.title2MoveDistance:this.elapsedFrameCount>=20&&(this.title2MoveRate+=10/this.title2MoveDistance,e.position.x=this.title2MoveDistance*this.easeOutQuint(this.title2MoveRate)),i.position.x>=this.title3MoveDistance?i.position.x=this.title3MoveDistance:this.elapsedFrameCount>=40&&(this.title3MoveRate+=10/this.title3MoveDistance,i.position.x=this.title3MoveDistance*this.easeOutQuint(this.title3MoveRate))))},n.updateButtons=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("continue_2"),n=this.uiGraph.get("option"),o=this.uiGraph.get("credit");t&&e&&i&&n&&o&&(t.visible&&e.visible||i.visible&&n.visible&&o.visible||this.elapsedFrameCount>=80&&(t.visible=!0,this.hasSaveData?e.visible=!0:i.visible=!0,n.visible=!0,o.visible=!0))},n.setTitleMoveDistance=function(){var t=this.uiGraph.get("title_1"),e=this.uiGraph.get("title_2"),i=this.uiGraph.get("title_3");t&&e&&i&&(this.title1MoveDistance=320+t.width/2,this.title2MoveDistance=320+e.width/2,this.title3MoveDistance=320+i.width/2)},n.newGame=function(){this.isOver||(p.playSe(b.Audio.Se.OptionTap),this.deleteSaveData(),this.onContinueButtonTouched())},n.cancelNewGame=function(){if(!this.isOver){p.playSe(b.Audio.Se.OptionTap);var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("option"),n=this.uiGraph.get("credit");t&&e&&i&&n&&(t.interactive=!0,e.interactive=!0,i.interactive=!0,n.interactive=!0,this.confirmation.visible=!1)}},n.onNewGameButtonTouched=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(p.playSe(b.Audio.Se.OptionTap),this.hasSaveData?this.showConfirmation():this.onContinueButtonTouched())},n.onContinueButtonTouched=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(p.destroySound(b.Audio.Bgm.TitleBgm),p.playSe(b.Audio.Se.OptionTap),f.loadScene(new Xe(this.language)),this.isOver=!0)},n.showOptionScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,p.playSe(b.Audio.Se.OptionTap),f.loadScene(new it(this.language)))},n.showCreditScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,p.playSe(b.Audio.Se.OptionTap),f.loadScene(new ct))},n.showLanguageOption=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("option"),n=this.uiGraph.get("credit");t&&e&&i&&n&&(t.interactive=!1,e.interactive=!1,i.interactive=!1,n.interactive=!1,this.languageOption.visible=!0)},n.showConfirmation=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("option"),n=this.uiGraph.get("credit");t&&e&&i&&n&&(t.interactive=!1,e.interactive=!1,i.interactive=!1,n.interactive=!1,this.confirmation.visible=!0)},n.saveLanguageToDB=function(t){l.put("language",t)},n.loadLanguageFromDB=function(){var t=this;l.get("language",(function(e){if(e?t.language=e:t.showLanguageOption(),"japanese"===e){var i=t.uiGraph.get("confirm_message_english");if(!i)return;i.visible=!1}else{var n=t.uiGraph.get("confirm_message");if(!n)return;n.visible=!1}}))},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=L.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),this.uiGraph.set(s.id,u),"language_option_sprite"===s.type||"language_option_text"===s.type?this.languageOption.addChild(u):"confirmation_sprite"===s.type||"confirmation_text"===s.type?this.confirmation.addChild(u):this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.playBgmIfNeeded=function(){var t=b.Audio.Bgm.TitleBgm;if(!p.hasSound(t)){var e=f.game.loader.resources[t];p.createSound(t,e.buffer),p.playBgm(t,1.5)}},n.loadSaveDataFromDB=function(){var t=this;l.get("saveData",(function(e){e&&(t.hasSaveData=!0)}))},n.deleteSaveData=function(){l.delete("saveData")},i}(J);function ri(t,e,i){return(ri="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=si(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function si(t){return(si=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ai(t,e){return!e||"object"!==ci(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ui(t,e){return(ui=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ci=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function li(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=si(t);if(e){var o=si(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ai(this,i)}}var hi=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ui(t,e)}(i,t);var e=li(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=e.call(this)).sceneName="start_scene",t.transitionIn=new y(1,0,-.02),t.transitionOut=new y(0,1,.02),t.interactive=!0,t.on("pointerdown",(function(){t.showTitleScene()})),t}var n=i.prototype;return n.createInitialResourceList=function(){var t=ri(si(i.prototype),"createInitialResourceList",this).call(this);return t.push(b.Audio.Se.OptionTap),t},n.update=function(t){ri(si(i.prototype),"update",this).call(this,t),this.elapsedFrameCount%40===0&&(this.startButton.visible=!this.startButton.visible)},n.onResourceLoaded=function(){ri(si(i.prototype),"onResourceLoaded",this).call(this),this.addChild(this.uiGraphContainer);var t=this.uiGraph.get("start_button");t&&(this.startButton=t,this.initSound())},n.initSound=function(){var t=f.game.loader.resources,e=[b.Audio.Se.OptionTap],i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;p.createSound(a,t[a].buffer)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},n.showTitleScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,p.playSe(b.Audio.Se.OptionTap),f.loadScene(new oi))},i}(J),pi=i(5933);var fi=(0,i(1752).default)(),di=(fi.serverRuntimeConfig,fi.publicRuntimeConfig),mi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.startGame=function(){pi.load({custom:{families:[b.FontFamily.Default],urls:["".concat(di.staticFolder,"/font.css")]},active:function(){t.initGame()},timeout:15e3})},t.initGame=function(){f.start({width:640,height:640,backgroundColor:0}),f.loadScene(new hi)},t}(),yi=i(7294);function gi(){return(0,yi.useEffect)((function(){mi.startGame()})),(0,n.jsx)("div",{id:"play-game"})}}}]);