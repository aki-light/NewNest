"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[415],{415:function(t,e,i){i.r(e),i.d(e,{default:function(){return wi}});var n=i(5893),o=i(1752),r=(0,o.default)(),s=(r.serverRuntimeConfig,r.publicRuntimeConfig),a=Object.freeze({ResourceBaseUrl:"".concat(s.staticFolder,"/game_sources/escape_game_1/assets/")}),u=i(8866),c=i(3631);function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loop=!1,this.played=!1,this.paused=!1,this.offset=0,this.playedAt=0,this.volumeRate=void 0,m.sharedContext&&(this.buffer=e,this.gainNode=m.sharedContext.createGain())}var e,i,n,o=t.prototype;return o.play=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=this,o=m.sharedContext;o&&(this.loop=t,this.source=o.createBufferSource(),this.source.loop=this.loop,this.source.loopStart=0,this.source.loopEnd=this.buffer.duration,this.source.buffer=this.buffer,this.source.onended=function(){return n.stop()},i?(this.gainNode.gain.value=t?m.bgmVolume*i:m.seVolume*i,this.volumeRate=i):this.gainNode.gain.value=t?m.bgmVolume:m.seVolume,this.gainNode.connect(o.destination),this.source.connect(this.gainNode),this.source.start(0,e),this.played=!0,this.playedAt=o.currentTime-e,this.paused=!1)},o.stop=function(){if(this.source&&this.played){this.source.disconnect();try{this.source.buffer=null}catch(t){}this.source.onended=null,this.source=null,this.paused=!1}},o.pause=function(){!this.paused&&this.played&&this.source&&(this.offset=this.elapsedTime,this.stop(),this.paused=!0)},o.resume=function(){this.paused&&this.played&&(this.play(this.loop,this.offset,this.volumeRate),this.paused=!1)},o.isPosed=function(){return this.paused},e=t,(i=[{key:"volume",get:function(){return this.gainNode?this.gainNode.gain.value:-1},set:function(t){this.gainNode&&(this.gainNode.gain.value=t)}},{key:"elapsedTime",get:function(){if(this.paused)return this.offset;var t=m.sharedContext;if(!this.source||!t)return 0;var e=t.currentTime-this.playedAt;if(this.loop){var i=this.source.loopEnd-this.source.loopStart;if(e>i)return e%i}return e}}])&&l(e.prototype,i),n&&l(e,n),t}();var p=window.indexedDB||window.webkitIndexedDB,f=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.init=function(e,i){if(!p)throw new Error("indexed db is not supported");var n=p.open(t.dbName,t.dbVersion);n.onupgradeneeded=function(e){t.upgradeDB(e)},n.onsuccess=function(e){var n=e.target.result;t.db=n,i()},n.onerror=function(t){return e(t)}},t.put=function(e,i,n,o){var r=t.getStoreObject();if(r){var s=t.createRecordObject(e,i),a=r.put(s);n&&(a.onsuccess=function(t){n(t)}),o&&(a.onerror=function(t){o(t)})}else o&&o()},t.get=function(e,i,n){var o=t.getStoreObject();if(o){var r=o.get(e);r.onsuccess=function(t){var e=t.target.result;e?i(e.value,e.key):i(void 0,void 0)},n&&(r.onerror=function(t){n(t)})}else n&&n()},t.delete=function(e,i,n){var o=t.getStoreObject();if(o){var r=o.delete(e);i&&(r.onsuccess=function(t){i(t)}),n&&(r.onerror=function(t){n(t)})}else n&&n()},t.clear=function(e,i){var n=t.getStoreObject();if(n){var o=n.clear();e&&(o.onsuccess=function(t){e(t)}),i&&(o.onerror=function(t){i(t)})}else i&&i()},t.upgradeDB=function(e){var i=e.target.result,n=t.storeIndex,o=t.storeName;i.createObjectStore(o,{keyPath:n}).createIndex(n,n,{unique:!0})},t.getStoreObject=function(){if(!t.db)return null;var e=t.storeName;return t.db.transaction(e,"readwrite").objectStore(e)},t.createRecordObject=function(t,e){return{key:t,value:e}},t}();function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}f.dbName="escape-game-db",f.dbVersion=1,f.storeName="escape-game-store",f.storeIndex="key",f.db=null;var m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,n;return t.init=function(e){if(e)t.context=e;else{var i=window.AudioContext||window.webkitAudioContext;t.context=new i}var n=(0,c.qY)();n&&(t.setSoundInitializeEvent(n),t.useWebAudio(),t.setWindowLifeCycleEvent(n))},t.update=function(e){if(t.sharedContext){var i=t.killingSounds;if(i.length>0){var n=[],o=!0,r=!1,s=void 0;try{for(var a,u=i[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;t.sharedContext.currentTime>=c.endAt?c.sound.stop():n.push(c)}}catch(l){r=!0,s=l}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}t.killingSounds=n}}},t.useWebAudio=function(){if(!t.webAudioInitialized){var e=t.supportedExtensions,i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value,c=u.kCJ;c.setExtensionXhrType(a,c.XHR_RESPONSE_TYPE.BUFFER),c.setExtensionLoadType(a,c.LOAD_TYPE.XHR)}}catch(l){n=!0,o=l}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}y.game.loader.use(t.parsingMiddleware()),t.webAudioInitialized=!0}},t.parsingMiddleware=function(){return function(e,i){var n,o=t.supportedExtensions,r=e.url.split(".")[1];r&&-1!==o.indexOf(r)?null===(n=t.sharedContext)||void 0===n||n.decodeAudioData(e.data,(function(t){e.buffer=t,i()})):i()}},t.setSoundInitializeEvent=function(e){var i,n=void 0===document.ontouchend?"mousedown":"touched",o=e.version?e.version.split(".")[0]:"0";if("chrome"===e.name&&Number.parseInt(o,10)>=66)i=function(){t.sharedContext&&t.sharedContext.resume(),document.body.removeEventListener(n,i)};else{if("safari"!==e.name)return;i=function(){if(t.sharedContext){var e=t.sharedContext.createBufferSource();e.buffer=t.sharedContext.createBuffer(1,1,44100),e.connect(t.sharedContext.destination),e.start(0),e.disconnect()}document.body.removeEventListener(n,i)}}document.body.addEventListener(n,i)},t.setWindowLifeCycleEvent=function(e){"safari"===e.name?document.addEventListener("webkitvisibilitychange",(function(){document.webkitHidden?t.pauseBgm():t.resumeBgm()})):document.addEventListener("visibilitychange",(function(){document.hidden?t.pauseBgm():t.resumeBgm()}))},t.registerSound=function(e,i){t.managedSounds.set(e,i)},t.unregisterSound=function(e){t.managedSounds.delete(e)},t.getSound=function(e){return t.managedSounds.get(e)},t.createSound=function(e,i){var n=new h(i);return t.registerSound(e,n),n},t.hasSound=function(e){return t.managedSounds.has(e)},t.destroySound=function(e){var i=this.getSound(e);t.unregisterSound(e),null===i||void 0===i||i.stop()},t.pauseBgm=function(){t.paused||(t.paused=!0,t.managedSounds.forEach((function(t){t.pause()})))},t.resumeBgm=function(){t.sceneIsPaused||t.paused&&(t.paused=!1,t.managedSounds.forEach((function(t){t.resume()})))},t.fade=function(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.sharedContext){var r=t.sharedContext.currentTime+n;e.gainNode.gain.exponentialRampToValueAtTime(i,r),o&&t.killingSounds.push({sound:e,endAt:r})}},t.playBgm=function(e,i){var n=t.getSound(e);null===n||void 0===n||n.play(!0,0,i)},t.stopBgm=function(e){var i=t.getSound(e);null===i||void 0===i||i.stop()},t.playSe=function(e){var i=t.getSound(e);null===i||void 0===i||i.play()},t.setSoundVolume=function(e,i){t.managedSounds.forEach((function(t){t.loop?t.volume=e:t.volume=i}))},t.loadSoundOptionFromDB=function(){f.get("bgmVolume",(function(e){t.bgmVolume=0===e?0:e||.05})),f.get("seVolume",(function(e){t.seVolume=0===e?0:e||.5}))},e=t,n=[{key:"sharedContext",get:function(){return t.context}}],(i=null)&&d(e.prototype,i),n&&d(e,n),t}();m.supportedExtensions=["mp3"],m.webAudioInitialized=!1,m.context=null,m.paused=!1,m.killingSounds=[],m.managedSounds=new Map,m.sceneIsPaused=!1;var y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.start=function(e){t.game=new u.MxU(e),f.init((function(t){throw new Error("indexed db could not be initialized")}),(function(){m.loadSoundOptionFromDB()})),m.init();var i=document.getElementById("play-game");i&&(i.appendChild(t.game.view),t.game.loader.baseUrl=a.ResourceBaseUrl,t.game.ticker.add((function(e){var i;null===(i=t.currentScene)||void 0===i||i.update(e),m.update(e)})),t.resizeCanvas(),window.addEventListener("resize",t.resizeCanvas))},t.transitionInIfPossible=function(e){var i;return!(!t.sceneResourceLoaded||!t.sceneTransitionOutFinished)&&(null===(i=t.currentScene)||void 0===i||i.destroy(),t.currentScene=e,t.game.stage.addChild(e),e.beginTransitionIn((function(){})),!0)},t.loadScene=function(e){t.currentScene?(t.sceneResourceLoaded=!1,t.sceneTransitionOutFinished=!1,e.beginLoadResource((function(){t.sceneResourceLoaded=!0,t.transitionInIfPossible(e)})),t.currentScene.beginTransitionOut((function(){t.sceneTransitionOutFinished=!0,t.transitionInIfPossible(e)}))):(t.sceneTransitionOutFinished=!0,e.beginLoadResource((function(){t.sceneResourceLoaded=!0,t.transitionInIfPossible(e)})))},t.resizeCanvas=function(){var e,i,n=t.game,o=n.renderer,r=o.width/o.height;window.innerWidth/window.innerHeight>r?(e=window.innerHeight*(o.width/o.height),i=window.innerHeight):(e=window.innerWidth,i=window.innerWidth*(o.height/o.width)),(e>=500||i>=500)&&(e=500,i=500),n.view.style.width="".concat(e-20,"px"),n.view.style.height="".concat(i-20,"px")},t}();y.sceneTransitionOutFinished=!0,y.sceneResourceLoaded=!1;var g=i(4051),v=i.n(g);var b=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=new u.W20,this.overlay=new u.TCu,this.transitionBegan=!1,this.transitionFinished=!1,this.onTransitionFinished=function(){},this.afterFinishedVisible=!1,this.alphaFrom=e,this.alphaTo=i,this.alphaProgress=n;var o=y.game.view.width,r=y.game.view.height;this.overlay.beginFill(0),this.overlay.moveTo(0,0),this.overlay.lineTo(o,0),this.overlay.lineTo(o,r),this.overlay.lineTo(0,r),this.overlay.endFill(),this.overlay.alpha=this.alphaFrom,this.container.addChild(this.overlay)}var e=t.prototype;return e.getContainer=function(){return this.container},e.begin=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.afterFinishedVisible=t,this.container.visible=!0,this.overlay.alpha=this.alphaFrom,this.transitionBegan=!0,this.transitionFinished=!1},e.isBegan=function(){return this.transitionBegan},e.isFinished=function(){return this.transitionFinished},e.isActive=function(){return this.isBegan()&&!this.isFinished()},e.update=function(t){this.alphaTo<=this.alphaFrom&&this.overlay.alpha<=this.alphaTo||this.alphaTo>=this.alphaFrom&&this.overlay.alpha>=this.alphaTo?(this.afterFinishedVisible||(this.container.visible=!1),this.transitionBegan=!1,this.onTransitionFinished(),this.transitionFinished=!0):this.overlay.alpha+=this.alphaProgress},e.setCallback=function(t){this.onTransitionFinished=t},t}(),w=Object.freeze({NOTHING:0,CAR_KEY:1,DESK_KEY:2,BANANA:3,PENCIL:4,NAIL:5,SALT:6,TIN_STATUE:7,COIN:8,CROSSBOW:9,DETERGENT:10,HAND_MIRROR:11,DVD:12,FROZEN_BANANA:13,SHARPENED_PENCIL:14}),O=Object.freeze({NormalFloor:0,NormalWall:1,TileWithShadow:2}),S=Object.freeze({UI:{SceneUiGraph:function(t){return"ui_graph/".concat(t,".json")},EscapeSceneMessage:"ui_graph/escape_scene_message.json",EscapeSceneEnglishMessage:"ui_graph/escape_scene_message_english.json",EscapeSceneOption:"ui_graph/escape_scene_option.json",EscapeSceneEnglishOption:"ui_graph/escape_scene_option_english.json",EscapeSceneRoomObject:"ui_graph/escape_scene_room_object.json",Stage:"master/stage_master.json",PlayerAnimation:"master/player_animation_master.json",RoomObjectMaster:"master/room_object_master.json",Player:"player/player.json",TileFrame:"stage/tile_frame.png",Tiles:["stage/floor.png","stage/wall.png","stage/floor_with_shadow.png"],Items:["items/tin_statue.png","items/coin.png","items/banana.png","items/frozen_banana.png","items/salt.png","items/desk_key.png","items/pencil.png","items/sharpened_pencil.png","items/hand_mirror.png","items/detergent.png","items/car_key.png","items/crossbow.png","items/nail.png","items/dvd.png"],RoomObjects:["room_object/mirror.png","room_object/chair.png","room_object/pig2.png","room_object/clock_12_00.png"],MessageWindow:"ui/message_window.png",OptionFrame:"ui/option_frame.png",ItemSelectFrame:"ui/item_select_frame.png",ItemPanelFrame:"ui/item_panel_frame.png",MenuBar:"ui/menu_bar.png",MenuButton:"ui/menu_button.png"},Dynamic:{items:function(t){switch(t){case w.NOTHING:return"items/no_item.png";case w.TIN_STATUE:return"items/tin_statue.png";case w.COIN:return"items/coin.png";case w.BANANA:return"items/banana.png";case w.FROZEN_BANANA:return"items/frozen_banana.png";case w.SALT:return"items/salt.png";case w.PENCIL:return"items/pencil.png";case w.SHARPENED_PENCIL:return"items/sharpened_pencil.png";case w.NAIL:return"items/nail.png";case w.HAND_MIRROR:return"items/hand_mirror.png";case w.DVD:return"items/dvd.png";case w.DETERGENT:return"items/detergent.png";case w.DESK_KEY:return"items/desk_key.png";case w.CROSSBOW:return"items/crossbow.png";case w.CAR_KEY:return"items/car_key.png";default:return""}},tiles:function(t){switch(t){case O.NormalFloor:return"stage/floor.png";case O.NormalWall:return"stage/wall.png";case O.TileWithShadow:return"stage/floor_with_shadow.png";default:return""}}},AnimationTypes:{Player:Object.freeze({WAIT:"wait",WALKUP:"walk_up",WALKDOWN:"walk_down",WALKLEFT:"walk_left",WALKRIGHT:"walk_right",CHACKUP:"chack_up",CHACKDOWN:"chack_down",CHACKLEFT:"chack_left",CHACKRIGHT:"chack_right"})},SoundOptionIds:["sound_option_frame","bgm_volume","se_volume","bgm","se","bgm_volume_up","bgm_volume_down","se_volume_up","se_volume_down"],PinPadIds:["pin_pad","code_first","code_second","code_third","pad_cancel","pad_enter","pad_0","pad_1","pad_2","pad_3","pad_4","pad_5","pad_6","pad_7","pad_8","pad_9"],MenuOptionIds:["item_bag","return","sound_volume"],RoomObjects:{TV:"tv",DESK:"desk",DOOR:"door",BED:"bed",GAS_STOVE:"gas_stove",VENDING_MACHINE:"vending_machine",FREEZER:"freezer",CABINET:"cabinet",BARREL:"barrel",GRINDER:"grinder",CAR:"car",BALLOON:"balloon",MIRROR:"mirror",CHAIR:"chair",CLOCK:"clock",PIG:"pig",CLOSET:"closet",SAFE:"safe",BOOK_SHELF:"book_shelf"},MessageIds:{NothingSpecial:"nothing_special",BackToTitle:"back_to_title",ContinueGame:"continue_game"},Audio:{Bgm:{EscapeBGM:"audio/escape_bgm.mp3",EndingBGM:"audio/ending_bgm.mp3",TitleBgm:"audio/title_bgm.mp3"},Se:{ShowNextText:"audio/show_next_text.mp3",OptionTap:"audio/option_tap.mp3",TileTap:"audio/tile_tap.mp3"}},FontFamily:{Default:"MPLUS1p-Regular"}});function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function E(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return _(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var T=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e=t.prototype;return e.createUiNode=function(t){return new u.W20},e.createUiNodeByGraphElement=function(t){var e=this.createUiNode(t.params);return e&&(e.name=t.id,e.position.set(t.position[0],t.position[1]),t.invisible&&(e.visible=!1),t.interactive&&(e.interactive=!0)),e},e.attachUiEventByGraphElement=function(t,e,i){var n=!0,o=!1,r=void 0;try{for(var s,a=function(t,n){var o,r=n.value,s=i[r.callback];if(!s)return"continue";e.on(r.type,(function(){return(o=s).call.apply(o,[i].concat(E(r.arguments)))}))},u=t[Symbol.iterator]();!(n=(s=u.next()).done);n=!0)a(0,s)}catch(c){o=!0,r=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw r}}},t}();function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function I(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function C(t,e){return!e||"object"!==A(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function x(t,e){return(x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function P(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return R(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return R(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var A=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function B(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=j(t);if(e){var o=j(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return C(this,i)}}var D=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(i,t);var e=B(i);function i(){return I(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e={};t&&(void 0!==t.family&&(e.fontFamily=t.family),void 0!==t.size&&(e.fontSize=t.size),void 0!==t.color&&(e.fill=t.color),void 0!==t.padding&&(e.padding=t.padding),void 0!==t.wordWrap&&(e.wordWrap=t.wordWrap),void 0!==t.wordWrapWidth&&(e.wordWrapWidth=t.wordWrapWidth));var i,n=new u.pn8(e),o=new u.xvT(t&&t.text?t.text:"",n);t&&void 0!==t.anchor&&(i=o.anchor).set.apply(i,P(t.anchor));return o},i}(T);function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){return!e||"object"!==L(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function G(t,e){return(G=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function W(t){return function(t){if(Array.isArray(t))return N(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return N(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return N(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var L=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function F(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=U(t);if(e){var o=U(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return M(this,i)}}var V=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&G(t,e)}(i,t);var e=F(i);function i(){return k(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e=new u.jyi;if(t){var i,n,o=t.textureName;if(o&&u.P6Y.kN[o]&&(e.texture=u.P6Y.kN[o]),t.anchor)(i=e.anchor).set.apply(i,W(t.anchor));if(t.scale)(n=e.scale).set.apply(n,W(t.scale))}return e},i}(T);var H=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.getFactory=function(e){if(!t.cashedFactory[e]){var i;switch(e){case"text":case"message":case"language_option_text":case"confirmation_text":case"credit_text":case"menu_text":i=D;break;case"language_option_sprite":case"confirmation_sprite":case"sprite":i=V}if(!i)return null;t.cashedFactory[e]=new i}return t.cashedFactory[e]},t}();function z(t,e,i,n,o,r,s){try{var a=t[r](s),u=a.value}catch(c){return void i(c)}a.done?e(u):Promise.resolve(u).then(n,o)}function K(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y(t){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function q(t,e){return!e||"object"!==Z(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function J(t,e){return(J=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}H.cashedFactory={};var Z=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function X(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Y(t);if(e){var o=Y(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return q(this,i)}}var $=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&J(t,e)}(i,t);var e=X(i);function i(){var t;return K(this,i),(t=e.apply(this,arguments)).transitionIn=new b(1,0,-.02),t.transitionOut=new b(0,1,.02),t.objectsToUpdate=[],t.elapsedFrameCount=0,t.uiGraphContainer=new u.W20,t.uiGraph=new Map,t.isOver=!1,t}var n=i.prototype;return n.update=function(t){this.elapsedFrameCount++,this.updateRegisteredObjects(t),this.transitionIn.isActive()?this.transitionIn.update(t):this.transitionOut.isActive()&&this.transitionOut.update(t)},n.registerUpdatingObject=function(t){this.objectsToUpdate.push(t)},n.updateRegisteredObjects=function(t){var e=[],i=!0,n=!1,o=void 0;try{for(var r,s=this.objectsToUpdate[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;a&&!a.isDestroyed()&&(a.update(t),e.push(a))}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}this.objectsToUpdate=e},n.beginTransitionIn=function(t,e){this.transitionIn.setCallback((function(){return t()}));var i=this.transitionIn.getContainer();i&&this.addChild(i),this.transitionIn.begin(e)},n.beginTransitionOut=function(t,e){this.transitionOut.setCallback((function(){return t()}));var i=this.transitionOut.getContainer();i&&this.addChild(i),this.transitionOut.begin(e)},n.createInitialResourceList=function(){return[]},n.beginLoadResource=function(t){var e,i=this;return(e=v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(t){i.loadInitialResource((function(){return t(null)}))}));case 2:return e.next=4,new Promise((function(t){var e=i.onInitialResourceLoaded();i.loadAdditionalResource(e,(function(){return t(null)}))}));case 4:i.onResourceLoaded(),t();case 6:case"end":return e.stop()}}),e)})),function(){var t=this,i=arguments;return new Promise((function(n,o){var r=e.apply(t,i);function s(t){z(r,n,o,s,a,"next",t)}function a(t){z(r,n,o,s,a,"throw",t)}s(void 0)}))})()},n.loadInitialResource=function(t){var e=this.createInitialResourceList(),i=S.UI.SceneUiGraph(this.sceneName);e.push(i);var n=this.filterLoadedAssets(e);n.length>0?y.game.loader.add(n).load(t):t()},n.onInitialResourceLoaded=function(){var t=[],e=S.UI.SceneUiGraph(this.sceneName),i=y.game.loader.resources[e],n=!0,o=!1,r=void 0;try{for(var s,a=i.data.nodes[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;"sprite"!==u.type&&"sprite_option"!==u.type&&"room_object"!==u.type&&"item_panel"!==u.type&&"language_option_sprite"!==u.type&&"confirmation_sprite"!==u.type||t.push({name:u.params.textureName,url:u.params.url})}}catch(c){o=!0,r=c}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}return t},n.loadAdditionalResource=function(t,e){y.game.loader.add(this.filterLoadedAssets(t)).load(e)},n.onResourceLoaded=function(){var t=S.UI.SceneUiGraph(this.sceneName),e=y.game.loader.resources[t].data;this.prepareUiGraphContainer(e)},n.filterLoadedAssets=function(t){var e=new Map,i=!0,n=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;"string"===typeof a?y.game.loader.resources[a]||e.has(a)||e.set(a,{name:a,url:a}):y.game.loader.resources[a.name]||e.has(a.name)||e.set(a.name,a)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return Array.from(e.values())},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=H.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),this.uiGraph.set(s.id,u),this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.getCustomUiGraphFactory=function(t){return null},n.destroySound=function(){var t=y.game.loader.resources,e=Object.keys(t),i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;t[a].buffer&&m.destroySound(a)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},i}(u.W20);function Q(t,e,i){return(Q="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){return!e||"object"!==nt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var nt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ot(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=tt(t);if(e){var o=tt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return et(this,i)}}var rt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}(i,t);var e=ot(i);function i(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=e.call(this)).sceneName="option_scene",n.language=t,n.transitionIn=new b(1,0,-.02),n.transitionOut=new b(0,1,.02),n}var n=i.prototype;return n.onResourceLoaded=function(){Q(tt(i.prototype),"onResourceLoaded",this).call(this),this.initVolumeGraph(),this.initLanguageButton(),this.addChild(this.uiGraphContainer)},n.initLanguageButton=function(){var t=this.uiGraph.get("japanese"),e=this.uiGraph.get("japanese_2"),i=this.uiGraph.get("english"),n=this.uiGraph.get("english_2");t&&e&&i&&n&&("japanese"===this.language?(t.visible=!0,e.visible=!1,i.visible=!1,n.visible=!0):(t.visible=!1,e.visible=!0,i.visible=!0,n.visible=!1))},n.onLanguageSelected=function(t){m.playSe(S.Audio.Se.OptionTap);var e=this.uiGraph.get("japanese"),i=this.uiGraph.get("japanese_2"),n=this.uiGraph.get("english"),o=this.uiGraph.get("english_2");e&&i&&n&&o&&("japanese"===t?(e.visible=!0,i.visible=!1,n.visible=!1,o.visible=!0):(e.visible=!1,i.visible=!0,n.visible=!0,o.visible=!1),this.saveLanguageToDB(t))},n.initVolumeGraph=function(){for(var t=m.bgmVolume,e=m.seVolume,i=Math.round(100*t)+1,n=Math.round(10*e)+1;i<=10;i++){var o="bgm_volume_".concat(i);this.uiGraph.get(o).visible=!1}for(;n<=10;n++){var r="se_volume_".concat(n);this.uiGraph.get(r).visible=!1}},n.showTitleScene=function(){this.transitionIn.isActive()||this.transitionOut.isActive()||(m.playSe(S.Audio.Se.OptionTap),y.loadScene(new ai))},n.onBgmArrowDown=function(t){var e=m.bgmVolume;if(t<0){if(0===e)return;var i="bgm_volume_".concat(Math.round(100*e));this.uiGraph.get(i).visible=!1}else{if(.1===e)return;var n="bgm_volume_".concat(Math.round(100*e+1));this.uiGraph.get(n).visible=!0}(e+=t)<.001?e=0:e>.0999&&(e=.1),m.bgmVolume=e,m.playSe(S.Audio.Se.OptionTap),this.saveBgmVolumeToDB(m.bgmVolume),m.setSoundVolume(m.bgmVolume,m.seVolume)},n.onSeArrowDown=function(t){var e=m.seVolume;if(t<0){if(0===e)return;var i="se_volume_".concat(Math.round(10*e));this.uiGraph.get(i).visible=!1}else{if(1===e)return;var n="se_volume_".concat(Math.round(10*e+1));this.uiGraph.get(n).visible=!0}(e+=t)<.001?e=0:e>.999&&(e=1),m.seVolume=e,m.playSe(S.Audio.Se.OptionTap),this.saveSeVolumeToDB(m.seVolume)},n.saveLanguageToDB=function(t){f.put("language",t)},n.saveBgmVolumeToDB=function(t){f.put("bgmVolume",t)},n.saveSeVolumeToDB=function(t){f.put("seVolume",t)},i}($);function st(t,e,i){return(st="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=at(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function at(t){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ut(t,e){return!e||"object"!==lt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ct(t,e){return(ct=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ht(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=at(t);if(e){var o=at(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ut(this,i)}}var pt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ct(t,e)}(i,t);var e=ht(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=e.call(this)).creditContainer=new u.W20,t.currentPage=0,t.currentPageNumber=1,t.sceneName="credit_scene",t.transitionIn=new b(1,0,-.02),t.transitionOut=new b(0,1,.02),t}var n=i.prototype;return n.onResourceLoaded=function(){st(at(i.prototype),"onResourceLoaded",this).call(this),this.addChild(this.uiGraphContainer),this.addChild(this.creditContainer)},n.changePage=function(t){m.playSe(S.Audio.Se.OptionTap),t<0?this.currentPageNumber+=1:this.currentPageNumber-=1,this.currentPage=this.currentPage+t,this.currentPage<-6?(this.currentPage=0,this.currentPageNumber=1):this.currentPage>0&&(this.currentPage=-6,this.currentPageNumber=7),this.creditContainer.position.x=640*this.currentPage;var e=this.uiGraph.get("page_number");e&&(e.text=this.currentPageNumber.toString())},n.showTitleScene=function(){this.transitionIn.isActive()||this.transitionOut.isActive()||(m.playSe(S.Audio.Se.OptionTap),y.loadScene(new ai))},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=H.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),this.uiGraph.set(s.id,u),"credit_text"===s.type?this.creditContainer.addChild(u):this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},i}($);var ft=function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state=0,this.walkDirection=null,this.walkSpeed=4,this.walkCount=0,this.distanceRow=0,this.distanceColumn=0,this.checkingObject=null,this.items=[],this.positionRow=e,this.positionColumn=i},dt=Object.freeze({NONE:0,OBJECT:1,GOAL:2}),mt=Object.freeze({UP:0,LEFT:1,DOWN:2,RIGHT:3});var yt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.init=function(e){t.map=e,t.states=[],t.policy.clear(),t.direction.clear();for(var i=0;i<e.length;i++)for(var n=0;n<e[0].length;n++)t.states.push([i,n]);var o=!0,r=!1,s=void 0;try{for(var a,u=t.states[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;t.value.set(c,0);var l=!0,h=!1,p=void 0;try{for(var f,d=t.actions[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value;t.policy.set([c,m],0)}}catch(y){h=!0,p=y}finally{try{l||null==d.return||d.return()}finally{if(h)throw p}}}}catch(y){r=!0,s=y}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}t.direction.set(t.actions[0],mt.UP),t.direction.set(t.actions[1],mt.LEFT),t.direction.set(t.actions[2],mt.DOWN),t.direction.set(t.actions[3],mt.RIGHT)},t.move=function(e,i){if(e[0]===t.goal[0]&&e[1]===t.goal[1])return[0,e];var n=[e[0]+i[0],e[1]+i[1]];return n[0]<0||n[1]<0||n[0]>=t.map.length||n[1]>=t.map[0].length||t.map[n[0]][n[1]]===dt.OBJECT?[-1,e]:[-1,n]},t.policyUpdate=function(e){var i,n=-Math.pow(10,10),o=!0,r=!1,s=void 0;try{for(var a,u=t.actions[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value,l=t.move(e,c),h=0,p=!0,f=!1,d=void 0;try{for(var m,y=t.states[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var g=m.value;g[0]===l[1][0]&&g[1]===l[1][1]&&(h=l[0]+t.value.get(g))}}catch(v){f=!0,d=v}finally{try{p||null==y.return||y.return()}finally{if(f)throw d}}h>n&&(n=h,i=c)}}catch(v){r=!0,s=v}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}return t.policy.forEach((function(n,o){o[0][0]===e[0]&&o[0][1]===e[1]&&o[1][0]===i[0]&&o[1][1]===i[1]?t.policy.set(o,1):o[0][0]===e[0]&&o[0][1]===e[1]&&t.policy.set(o,0)})),n},t.valueIteration=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.01,i=0;;){var n=0,o=!0,r=!1,s=void 0;try{for(var a,u=t.states[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;if(1!==t.map[c[0]][c[1]]){var l=t.policyUpdate(c);n=Math.max(n,Math.abs(t.value.get(c)-l)),t.value.set(c,l)}}}catch(h){r=!0,s=h}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}if(++i>=t.maxIterate)break;if(n<e)break}},t.createBestPolicy=function(){t.policy.forEach((function(e,i){if(1===e){var n=t.direction.get(i[1]);t.bestPolicy.set(i[0],n)}}))},t.getRoutePlan=function(e,i){t.goal=i,t.valueIteration(),t.createBestPolicy();for(var n=[],o=e,r=!1,s=0;!r;){if(++s>=t.maxIterate)return[];var a=!0,u=!1,c=void 0;try{for(var l,h=t.states[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var p=l.value;if(p[0]===o[0]&&p[1]===o[1]){var f=t.bestPolicy.get(p);switch(f){case 0:o[0]=o[0]-1;break;case 1:o[1]=o[1]-1;break;case 2:o[0]=o[0]+1;break;case 3:o[1]=o[1]+1}o[0]===i[0]&&o[1]===i[1]&&(r=!0),n.push(f);break}}}catch(d){u=!0,c=d}finally{try{a||null==h.return||h.return()}finally{if(u)throw c}}}return n},t}();yt.states=[],yt.actions=[[-1,0],[0,-1],[1,0],[0,1]],yt.policy=new Map,yt.bestPolicy=new Map,yt.value=new Map,yt.direction=new Map,yt.maxIterate=100;var gt=Object.freeze({IDLE:0,WALK:1,CHECKING:2});var vt=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.states=[],this.id=e},bt=Object.freeze({CheckedUnderBed:0,UsedKey:1,HasNoPencil:2,CheckedUnderPillow:3,CheckedInCloset:4,JumpedOnBed:5,CheckedOnCloset:6,GotCarKey:7,Washed:8,HasNoDVD:9}),wt=Object.freeze({DoNoting:1,BackToTitle:6,ShowItems:7,ShowBackToTitle:8,ShowSoundVolume:9,ShowItemOption:10,JumpOnBed:11,CheckUnderBed:12,CheckUnderPillow:13,UseTinStatue:14,UseCoin:15,UseBanana:16,UseCarKey:17,UseNail:18,UseFrozenBanana:19,UseSalt:20,UseCrossBow:21,UseDetergent:22,UseHandMirror:23,UseDVD:24,UsePencil:25,GetSalt:26,UseDeskKey:27,CheckLeftDrawer:28,CheckRightDrawer:29,GetPenCil:30,UseShapenedPencil:31,CheckInCloset:32,CheckOnCloset:33,ShowPinPad:34,GetCrossbow:35,SetTime:36,Escape:37,MovePig:38,GetDVD:39,ReadHint:40,ReadHint1:41,ReadHint2:42});var Ot=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.walkRequests=[],this.roomObjectEntities=new Map}var e=t.prototype;return e.init=function(t){this.delegator=t.delegator,this.stageMaster=t.stageMaster,this.saveData=t.saveData,this.saveData.mapData?yt.init(this.saveData.mapData):yt.init(this.stageMaster.mapData),this.tileSize=this.stageMaster.tileSize,0!==this.saveData.roomObjectState.length?this.setRoomObjectEntities(this.saveData.roomObjectState):this.setRoomObjectEntities(t.roomObjectMaster),this.playerEntity=new ft(4,7),0!==this.saveData.playerItems.length&&(this.playerEntity.items=this.saveData.playerItems),this.delegator.onPlayerSpawned(this.playerEntity)},e.update=function(){this.updatePlayerDistance(),this.updatePlayerState()},e.updatePlayerState=function(){this.playerEntity.state===gt.WALK&&this.updateWalkState(),this.playerEntity.state===gt.IDLE&&this.updateIdleState(),this.playerEntity.state===gt.CHECKING&&this.updateChackingState()},e.updateIdleState=function(){0!==this.walkRequests.length&&(this.playerEntity.state=gt.WALK,this.delegator.onPlayerEntityStateChanged(this.playerEntity)),this.playerEntity.checkingObject&&(this.playerEntity.state=gt.CHECKING,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updateWalkState=function(){0===this.walkRequests.length&&this.playerEntity.walkCount*this.playerEntity.walkSpeed%this.tileSize===0&&(this.playerEntity.walkCount=0,this.playerEntity.state=gt.IDLE,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updateChackingState=function(){this.playerEntity.checkingObject||(this.playerEntity.state=gt.IDLE,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updatePlayerDistance=function(){if(this.playerEntity.state===gt.WALK){if(this.playerEntity.walkCount*this.playerEntity.walkSpeed%this.tileSize===0)switch(this.walkRequests.shift()){case mt.UP:this.playerEntity.walkDirection=mt.UP,this.playerEntity.positionRow+=-1;break;case mt.DOWN:this.playerEntity.walkDirection=mt.DOWN,this.playerEntity.positionRow+=1;break;case mt.LEFT:this.playerEntity.walkDirection=mt.LEFT,this.playerEntity.positionColumn+=-1;break;case mt.RIGHT:this.playerEntity.walkDirection=mt.RIGHT,this.playerEntity.positionColumn+=1}switch(this.playerEntity.walkDirection){case mt.UP:this.playerEntity.distanceRow-=this.playerEntity.walkSpeed;break;case mt.DOWN:this.playerEntity.distanceRow+=this.playerEntity.walkSpeed;break;case mt.LEFT:this.playerEntity.distanceColumn-=this.playerEntity.walkSpeed;break;case mt.RIGHT:this.playerEntity.distanceColumn+=this.playerEntity.walkSpeed}this.playerEntity.walkCount++,this.delegator.onPlayerEntityWalked(this.playerEntity)}},e.onRoomObjectTapped=function(t){this.playerEntity.checkingObject=t},e.onOptionSelected=function(t){if(this.playerEntity.checkingObject){var e=this.roomObjectEntities.get(this.playerEntity.checkingObject);if(e){if(t===wt.UseHandMirror&&this.delegator.onItemUsed(t,e),t===wt.UseShapenedPencil&&this.delegator.onItemUsed(t,e),t===wt.UseNail&&this.delegator.onItemUsed(t,e),t===wt.UseDVD&&this.delegator.onItemUsed(t,e),t===wt.CheckRightDrawer&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.CheckLeftDrawer&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.MovePig&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.ReadHint&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.ReadHint1&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.ReadHint2&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.Escape&&this.delegator.onGameOver(),t===wt.CheckUnderBed&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(bt.CheckedUnderBed)&&(this.playerEntity.items.push(w.TIN_STATUE),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.CheckedUnderBed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===wt.CheckUnderPillow&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(bt.CheckedUnderPillow)&&(this.playerEntity.items.push(w.HAND_MIRROR),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.CheckedUnderPillow),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===wt.JumpOnBed&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(bt.JumpedOnBed)&&(e.states.push(bt.JumpedOnBed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===wt.CheckInCloset&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(bt.CheckedInCloset)&&(this.playerEntity.items.push(w.DETERGENT),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.CheckedInCloset),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===wt.CheckOnCloset&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(bt.CheckedOnCloset))){this.playerEntity.items.push(w.CAR_KEY),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.CheckedOnCloset),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB();var i=this.roomObjectEntities.get(S.RoomObjects.BED);null===i||void 0===i||i.states.push(bt.GotCarKey),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()}if(t===wt.UseDetergent){if(this.playerEntity.checkingObject===S.RoomObjects.MIRROR){var n=this.playerEntity.items.indexOf(w.DETERGENT);this.playerEntity.items.splice(n,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.Washed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()}this.delegator.onItemUsed(t,e)}if(t===wt.UseFrozenBanana)if(this.playerEntity.checkingObject===S.RoomObjects.CHAIR&&-1!==this.playerEntity.items.indexOf(w.NAIL)){this.delegator.onItemUsed(t,e,this.playerEntity.items);var o=this.playerEntity.items.indexOf(w.FROZEN_BANANA);this.playerEntity.items.splice(o,1);var r=this.playerEntity.items.indexOf(w.NAIL);this.playerEntity.items.splice(r,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}else this.delegator.onItemUsed(t,e,this.playerEntity.items);if(t===wt.UseTinStatue){if(this.playerEntity.checkingObject===S.RoomObjects.GAS_STOVE){var s=this.playerEntity.items.indexOf(w.TIN_STATUE);this.playerEntity.items.splice(s,1),this.playerEntity.items.push(w.COIN),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UseCoin){if(this.playerEntity.checkingObject===S.RoomObjects.VENDING_MACHINE){var a=this.playerEntity.items.indexOf(w.COIN);this.playerEntity.items.splice(a,1),this.playerEntity.items.push(w.BANANA),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UseBanana){if(this.playerEntity.checkingObject===S.RoomObjects.FREEZER){var u=this.playerEntity.items.indexOf(w.BANANA);this.playerEntity.items.splice(u,1),this.playerEntity.items.push(w.FROZEN_BANANA),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UseSalt){if(this.playerEntity.checkingObject===S.RoomObjects.BARREL){var c=this.playerEntity.items.indexOf(w.SALT);this.playerEntity.items.splice(c,1),this.playerEntity.items.push(w.DESK_KEY),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UseDeskKey){if(this.playerEntity.checkingObject===S.RoomObjects.DESK){var l=this.playerEntity.items.indexOf(w.DESK_KEY);this.playerEntity.items.splice(l,1),e.states.push(bt.UsedKey),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB(),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UsePencil){if(this.playerEntity.checkingObject===S.RoomObjects.GRINDER){var h=this.playerEntity.items.indexOf(w.PENCIL);this.playerEntity.items.splice(h,1),this.playerEntity.items.push(w.SHARPENED_PENCIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UseCrossBow)if(this.playerEntity.checkingObject===S.RoomObjects.BALLOON&&-1!==this.playerEntity.items.indexOf(w.SHARPENED_PENCIL)){this.delegator.onItemUsed(t,e,this.playerEntity.items);var p=this.playerEntity.items.indexOf(w.SHARPENED_PENCIL);this.playerEntity.items.splice(p,1);var f=this.playerEntity.items.indexOf(w.CROSSBOW);this.playerEntity.items.splice(f,1),this.playerEntity.items.push(w.NAIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}else this.delegator.onItemUsed(t,e,this.playerEntity.items);if(t===wt.UseCarKey){if(this.playerEntity.checkingObject===S.RoomObjects.CAR){var d=this.playerEntity.items.indexOf(w.CAR_KEY);this.playerEntity.items.splice(d,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items),yt.init(this.stageMaster.carMovedMapData),this.playerEntity.positionRow=7,this.playerEntity.positionColumn=7,this.playerEntity.distanceRow=192,this.playerEntity.distanceColumn=0}this.delegator.onItemUsed(t,e)}t===wt.GetSalt&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(w.SALT),this.delegator.onPlayerItemsChanged(this.playerEntity.items)),t===wt.GetCrossbow&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(w.CROSSBOW),this.delegator.onPlayerItemsChanged(this.playerEntity.items)),t===wt.GetPenCil&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(w.PENCIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.HasNoPencil),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()),t===wt.GetDVD&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(w.DVD),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.HasNoDVD),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()),t===wt.SetTime&&(yt.init(this.stageMaster.pigMovedMapData),this.delegator.onRoomObjectOptionSelected(e,t))}}},e.onChackingEnd=function(){this.playerEntity.checkingObject=null},e.setRoomObjectEntities=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=new vt(s.id);a.states=s.states.concat(),this.roomObjectEntities.set(s.id,a)}}catch(u){i=!0,n=u}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},e.requestWalk=function(t){this.walkRequests=yt.getRoutePlan([this.playerEntity.positionRow,this.playerEntity.positionColumn],t)},e.changeRoomObjectEntitiesIntoArray=function(){var t=[];return this.roomObjectEntities.forEach((function(e,i){var n={id:i,states:e.states};t.push(n)})),t},e.saveProgressToDB=function(){f.put("saveData",this.saveData)},t}(),St=Object.freeze({LOADING_RESOURCES:1,RESOURCE_LOADED:2,READY:3,INGAME:4,FINISHED:5});var _t=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elapsedFrameCount=0,this.destroyed=!1,this.animationFrameId=0,this.requestedAnimationType=null,this.sprite=new u.jyi;var o=u.P6Y.kN[e.types.wait.frames[0]];this.sprite.texture=o,this.reSizeSprite(i);var r=i-this.sprite.width,s=i-this.sprite.height;this.sprite.position.set(n.x+r/2,n.y+s/2),this.spawnedPosition=new u.E9j(this.sprite.position.x,this.sprite.position.y),this.animationMaster=e,this.animationType=S.AnimationTypes.Player.WAIT}var e=t.prototype;return e.isDestroyed=function(){return this.destroyed},e.update=function(t){this.requestedAnimationType&&this.requestedAnimationType!==this.animationType&&(this.animationType=this.requestedAnimationType,this.resetAnimation()),this.updateAnimation()},e.requestAnimation=function(t){this.requestedAnimationType=t},e.resetAnimation=function(){this.requestedAnimationType=null,this.elapsedFrameCount=0,this.animationFrameId=0},e.updateAnimation=function(){var t=this.animationType,e=this.animationMaster.types[t];if(e){if(this.elapsedFrameCount%e.updateDuration===0){this.isAnimationLastFrameTime()&&this.resetAnimation();var i=e.frames[this.animationFrameId];this.sprite.texture=u.P6Y.kN[i],this.animationFrameId++}this.elapsedFrameCount++}},e.isAnimationLastFrameTime=function(){var t=this.animationType,e=this.animationMaster.types[t];if(!e)return!1;var i=e.updateDuration*e.frames.length;return this.elapsedFrameCount===i},e.destroy=function(){this.sprite.destroy(),this.destroyed=!0},e.reSizeSprite=function(t){t/t>this.sprite.width/this.sprite.height?(this.sprite.scale.x=t/this.sprite.width*(this.sprite.width/this.sprite.height),this.sprite.scale.y=t/this.sprite.height):(this.sprite.scale.x=t/this.sprite.width,this.sprite.scale.y=t/this.sprite.height*(this.sprite.height/this.sprite.width))},t}();function Et(t){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Tt(t,e){return!e||"object"!==It(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rt(t,e){return(Rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var It=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function jt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Et(t);if(e){var o=Et(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Tt(this,i)}}var Ct=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rt(t,e)}(i,t);var e=jt(i);function i(t,n,o){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=e.call(this)).isActive=!1,r.touchable=!1,r.tilePosition=n,r.tileSprite=new u.jyi,r.tileFrameSprite=new u.jyi;var s=y.game.loader.resources[S.Dynamic.tiles(t)].texture,a=y.game.loader.resources[S.UI.TileFrame].texture;return s&&(r.tileSprite.texture=s),r.tileSprite.scale.set(o/r.tileSprite.width,o/r.tileSprite.height),a&&(r.tileFrameSprite.texture=a),r.tileFrameSprite.scale.set(o/r.tileFrameSprite.width,o/r.tileFrameSprite.height),r.tileFrameSprite.visible=!1,r.addChild(r.tileSprite),r.addChild(r.tileFrameSprite),r}return i.prototype.toggleFrame=function(){this.touchable&&(m.playSe(S.Audio.Se.TileTap),this.isActive=!this.isActive,this.tileFrameSprite.visible=!this.tileFrameSprite.visible)},i}(u.W20);function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function At(t,e){return!e||"object"!==Nt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dt(t){return function(t){if(Array.isArray(t))return xt(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return xt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return xt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Nt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function kt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Pt(t);if(e){var o=Pt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return At(this,i)}}var Ut=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bt(t,e)}(i,t);var e=kt(i);function i(t,n){var o,r,s;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(o=e.call(this)).messageIds=o.copyMessageIds(n.messageIds),o.downTiles=n.downTiles.concat(),o.sprite=new u.jyi,o.sprite.texture=t,n.anchor)&&(r=o.sprite.anchor).set.apply(r,Dt(n.anchor));n.scale&&(s=o.sprite.scale).set.apply(s,Dt(n.scale));return o.addChild(o.sprite),o}return i.prototype.copyMessageIds=function(t){var e,i,n=[],o=!0,r=!1,s=void 0;try{for(var a,u=t[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;e=c,(null!=(i=String)&&"undefined"!==typeof Symbol&&i[Symbol.hasInstance]?i[Symbol.hasInstance](e):e instanceof i)?n.push(c):n.push(c.concat())}}catch(l){r=!0,s=l}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}return n},i}(u.W20);function Mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gt(t){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wt(t,e){return!e||"object"!==Ft(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lt(t,e){return(Lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ft=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Vt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Gt(t);if(e){var o=Gt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Wt(this,i)}}var Ht=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lt(t,e)}(i,t);var e=Vt(i);function i(){return Mt(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e;if(t){var i=t.textureName;i&&u.P6Y.kN[i]&&(e=u.P6Y.kN[i])}return e?new Ut(e,t):null},i}(T);function zt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Kt(t){return(Kt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yt(t,e){return!e||"object"!==Jt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qt(t,e){return(qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Zt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Kt(t);if(e){var o=Kt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Yt(this,i)}}var Xt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qt(t,e)}(i,t);var e=Zt(i);function i(t,n){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(o=e.call(this)).isActive=!1,o.optionButton=t,o.optionType=n,o.frameSprite=new u.jyi;var r,s,a=y.game.loader.resources[S.UI.OptionFrame].texture;return a&&(o.frameSprite.texture=a),r=t,(null!=(s=u.xvT)&&"undefined"!==typeof Symbol&&s[Symbol.hasInstance]?s[Symbol.hasInstance](r):r instanceof s)?o.frameSprite.scale.set((o.optionButton.width+40)/o.frameSprite.width,(o.optionButton.height+10)/o.frameSprite.height):o.frameSprite.scale.set(o.optionButton.texture.width/o.frameSprite.width,o.optionButton.texture.height/o.frameSprite.height),o.frameSprite.anchor.set(.5,.5),o.frameSprite.visible=!1,o.optionButton.addChild(o.frameSprite),o.addChild(o.optionButton),o}var n,o,r,s=i.prototype;return s.activate=function(){this.isActive=!0,this.frameSprite.visible=!0},s.deactivate=function(){this.isActive=!1,this.frameSprite.visible=!1},n=i,r=[{key:"resourceList",get:function(){return[S.UI.OptionFrame,S.UI.ItemSelectFrame]}}],(o=null)&&zt(n.prototype,o),r&&zt(n,r),i}(u.W20);function $t(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Qt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function te(t){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ee(t,e){return!e||"object"!==oe(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ie(t,e){return(ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ne(t){return function(t){if(Array.isArray(t))return $t(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return $t(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return $t(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var oe=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function re(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=te(t);if(e){var o=te(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ee(this,i)}}var se=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ie(t,e)}(i,t);var e=re(i);function i(){return Qt(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e={};t&&(void 0!==t.family&&(e.fontFamily=t.family),void 0!==t.size&&(e.fontSize=t.size),void 0!==t.color&&(e.fill=t.color),void 0!==t.padding&&(e.padding=t.padding),void 0!==t.wordWrap&&(e.wordWrap=t.wordWrap),void 0!==t.wordWrapWidth&&(e.wordWrapWidth=t.wordWrapWidth));var i,n=new u.pn8(e),o=new u.xvT(t&&t.text?t.text:"",n);t&&void 0!==t.anchor&&(i=o.anchor).set.apply(i,ne(t.anchor));var r=t.optionType;return new Xt(o,r)},i}(T);function ae(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ue(t){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ce(t,e){return null!=e&&"undefined"!==typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function le(t,e){return!e||"object"!==pe(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function he(t,e){return(he=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pe=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function fe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ue(t);if(e){var o=ue(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return le(this,i)}}var de=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&he(t,e)}(i,t);var e=fe(i);function i(t,n){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(o=e.call(this)).currentTextIndex=0;var r=!0,s=!1,a=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var h=c.value;if(!ce(h,u.xvT)){var p=!0,f=!1,d=void 0;try{for(var m,g=function(t,e){var i=e.value;i.deactivate(),i.on("pointertap",(function(){o.onOptionButtonTapped(i)}))},v=h[Symbol.iterator]();!(p=(m=v.next()).done);p=!0)g(0,m)}catch(w){f=!0,d=w}finally{try{p||null==v.return||v.return()}finally{if(f)throw d}}h[0].activate()}}}catch(w){s=!0,a=w}finally{try{r||null==l.return||l.return()}finally{if(s)throw a}}o.delegate=n,o.textsAndOptions=t;var b=u.P6Y.kN[S.UI.MessageWindow];return o.window=new u.jyi(b),o.window.interactive=!0,o.window.on("pointertap",(function(){o.showNextText()})),o.window.scale.set((y.game.view.width-10)/o.window.width,(y.game.view.height/3-10)/o.window.height),o.window.anchor.set(.5,.5),o.window.position.set(y.game.view.width/2,y.game.view.height-o.window.height/2-5),o.windowScaleX=o.window.scale.x,o.windowScaleY=o.window.scale.y,o.windowSizeUpRateX=o.windowScaleX/i.WindowSizeUpFrame,o.windowSizeUpRateY=o.windowScaleY/i.WindowSizeUpFrame,o.window.scale.set(0,0),ce(o.textsAndOptions[0],u.xvT)&&o.window.addChild(o.textsAndOptions[0]),o.addChild(o.window),o}var n,o,r,s=i.prototype;return s.isDestroyed=function(){return this._destroyed},s.update=function(t){this.isDestroyed()||this.window.scale.x===this.windowScaleX&&this.window.scale.y===this.windowScaleY||(this.window.scale.set(this.window.scale.x+this.windowSizeUpRateX,this.window.scale.y+this.windowSizeUpRateY),this.window.scale.x>=this.windowScaleX&&(this.window.scale.x=this.windowScaleX),this.window.scale.y>=this.windowScaleY&&(this.window.scale.y=this.windowScaleY))},s.showNextText=function(){if(m.playSe(S.Audio.Se.ShowNextText),this.window.interactive=!0,this.currentTextIndex!==this.textsAndOptions.length-1){var t=this.textsAndOptions[this.currentTextIndex];if(ce(t,u.xvT))t.visible=!1;else{var e=!0,i=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){o.value.visible=!1}}catch(I){i=!0,n=I}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}}var s=this.textsAndOptions[++this.currentTextIndex];if(ce(s,u.xvT))this.window.addChild(s);else{this.window.interactive=!1,2===s.length?(s[0].position.set(-190,0),s[1].position.set(190,0)):3===s.length?(s[0].position.set(-300,0),s[1].position.set(0,0),s[2].position.set(300,0)):4===s.length?(s[0].position.set(-190,-35),s[1].position.set(-190,35),s[2].position.set(190,-35),s[3].position.set(190,35)):5===s.length?(s[0].position.set(-300,-35),s[1].position.set(-300,35),s[2].position.set(0,-35),s[3].position.set(0,35),s[4].position.set(300,-35)):6===s.length?(s[0].position.set(-300,-35),s[1].position.set(-300,35),s[2].position.set(0,-35),s[3].position.set(0,35),s[4].position.set(300,-35),s[5].position.set(300,35)):s[0].position.set(0,0);var a=!0,c=!1,l=void 0;try{for(var h,p=s[Symbol.iterator]();!(a=(h=p.next()).done);a=!0){var f=h.value;f.visible=!0,this.window.addChild(f)}}catch(I){c=!0,l=I}finally{try{a||null==p.return||p.return()}finally{if(c)throw l}}}}else{this.delegate.onMessageWindowClosed();var d=!0,y=!1,g=void 0;try{for(var v,b=this.textsAndOptions[Symbol.iterator]();!(d=(v=b.next()).done);d=!0){var w=v.value;if(!ce(w,u.xvT)){var O=!0,_=!1,E=void 0;try{for(var T,R=w[Symbol.iterator]();!(O=(T=R.next()).done);O=!0){T.value.removeListener("pointertap")}}catch(I){_=!0,E=I}finally{try{O||null==R.return||R.return()}finally{if(_)throw E}}}}}catch(I){y=!0,g=I}finally{try{d||null==b.return||b.return()}finally{if(y)throw g}}this.destroy()}},s.onOptionButtonTapped=function(t){if(t.isActive)t.optionType&&this.delegate.onOptionSelected(t.optionType),this.showNextText();else{var e=this.textsAndOptions[this.currentTextIndex];if(!ce(e,u.xvT)){var i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){r.value.deactivate()}}catch(a){n=!0,o=a}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}}m.playSe(S.Audio.Se.OptionTap),t.activate()}},s.addText=function(t,e){if(!ce(t,u.xvT)){var i=!0,n=!1,o=void 0;try{for(var r,s=this,a=function(t,e){var i=e.value,n=s;i.removeListener("pointertap"),i.deactivate(),i.on("pointertap",(function(){n.onOptionButtonTapped(i)}))},c=t[Symbol.iterator]();!(i=(r=c.next()).done);i=!0)a(0,r)}catch(l){n=!0,o=l}finally{try{i||null==c.return||c.return()}finally{if(n)throw o}}t[0].activate()}this.textsAndOptions.splice(this.currentTextIndex+e,0,t)},n=i,r=[{key:"resourceList",get:function(){return[S.UI.MessageWindow]}}],(o=null)&&ae(n.prototype,o),r&&ae(n,r),i}(u.W20);function me(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ge(t,e){return null!=e&&"undefined"!==typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function ve(t,e){return!e||"object"!==we(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function be(t,e){return(be=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}de.WindowSizeUpFrame=10;var we=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Oe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ye(t);if(e){var o=ye(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ve(this,i)}}var Se=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&be(t,e)}(i,t);var e=Oe(i);function i(t,n,o,r,s){var a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(a=e.call(this)).isOpen=!1,a.menuOptionButtons=[],a.itemPanels=new Map,a.texts=new Map,a.optionButtons=new Map,a.delegate=s,a.menuOptionButtons=t,a.texts=r,a.soundOption=o,r.forEach((function(t,e){ge(t,Xt)&&a.optionButtons.set(e,t)}));var c=u.P6Y.kN[S.UI.MenuBar],l=u.P6Y.kN[S.UI.MenuButton],h=u.P6Y.kN[S.UI.ItemPanelFrame],p=u.P6Y.kN[S.UI.MessageWindow];return a.menuBar=new u.jyi(c),a.menuButton=new u.jyi(l),a.itemPanelFrame=new u.jyi(h),a.messageWindow=new u.jyi(p),a.initMenuBarAndMenuButton(),a.initItemPanelFrameAndItemPanels(n),a.initMessageWindow(r),a}var n,o,r,s=i.prototype;return s.initMessageWindow=function(t){var e=this;t.forEach((function(t,i){if(!ge(t,u.xvT)){var n=e;t.on("pointertap",(function(){n.onOptionButtonTapped(t)}))}})),this.messageWindow.scale.set((.8*y.game.view.width+20)/this.messageWindow.width,y.game.view.height/6/this.messageWindow.height),this.messageWindow.anchor.set(.5,.5),this.messageWindow.position.x=367,t.forEach((function(t,i){t.visible=!1,e.messageWindow.addChild(t)})),this.messageWindow.visible=!1,this.addChild(this.messageWindow)},s.initItemPanelFrameAndItemPanels=function(t){this.itemPanelFrame.scale.set((.8*y.game.view.width+20)/this.itemPanelFrame.width,(y.game.view.height/4+30)/this.itemPanelFrame.height),this.itemPanelFrame.position.set(100,10);var e=!0,i=!1,n=void 0;try{for(var o,r=this,s=function(t,e){var i=e.value,n=r;i.on("pointertap",(function(){n.onItemPanelTapped(i)})),r.itemPanels.set(i.itemType,i),i.scale.set((r.itemPanelFrame.texture.width-8)/6/i.width,(r.itemPanelFrame.texture.height/2-5)/i.height),r.itemPanelFrame.addChild(i)},a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)s(0,o)}catch(u){i=!0,n=u}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}this.itemPanelFrame.visible=!1,this.addChild(this.itemPanelFrame)},s.initMenuBarAndMenuButton=function(){var t=this;this.menuButton.interactive=!0,this.menuButton.on("pointertap",(function(){t.onMenuButtonTapped()})),this.menuBar.scale.set(y.game.view.width/7/this.menuBar.width,y.game.view.height/2/this.menuBar.height),this.menuButton.scale.set(this.menuBar.width/this.menuButton.width,this.menuBar.height/6/this.menuButton.height),this.menuBar.scale.y=(y.game.view.height/2-this.menuButton.height)/this.menuBar.texture.height,this.menuBar.position.y=this.menuButton.height,this.menuMoveRate=this.menuBar.width/i.menuMoveFrame,this.menuBar.addChild(this.menuButton);var e=!0,n=!1,o=void 0;try{for(var r,s=this,a=function(t,e){var i=e.value,n=s;i.on("pointertap",(function(){n.onMenuOptionButtonTapped(i)})),i.position.x=s.menuBar.texture.width/2,i.interactive=!0,s.menuBar.addChild(i)},u=this.menuOptionButtons[Symbol.iterator]();!(e=(r=u.next()).done);e=!0)a(0,r)}catch(c){n=!0,o=c}finally{try{e||null==u.return||u.return()}finally{if(n)throw o}}this.addChild(this.menuBar),this.addChild(this.menuButton)},s.isDestroyed=function(){return this._destroyed},s.update=function(t){this.isDestroyed()||(this.isOpen&&this.menuBar.position.x<0&&(this.menuBar.position.x+=this.menuMoveRate),!this.isOpen&&this.menuBar.position.x>-this.menuBar.width&&(this.menuBar.position.x-=this.menuMoveRate))},s.updateItemPanels=function(t){this.itemPanels.forEach((function(t,e){t.removeItem()}));var e=!0,i=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value;if(s===w.FROZEN_BANANA){var a=this.itemPanels.get(w.BANANA);if(!a)continue;a.hasItem=!0;var c=u.P6Y.kN[S.Dynamic.items(w.FROZEN_BANANA)];a.optionButton.texture=c,a.itemType=w.FROZEN_BANANA,a.itemTextId="frozen_banana_text",a.optionId="use_frozen_banana"}if(s===w.SHARPENED_PENCIL){var l=this.itemPanels.get(w.PENCIL);if(!l)continue;l.hasItem=!0;var h=u.P6Y.kN[S.Dynamic.items(w.SHARPENED_PENCIL)];l.optionButton.texture=h,l.itemType=w.SHARPENED_PENCIL,l.itemTextId="sharpened_pencil_text",l.optionId="use_sharpened_pencil"}var p=this.itemPanels.get(s);p&&p.addItem()}}catch(f){i=!0,n=f}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},s.onOptionButtonTapped=function(t){m.playSe(S.Audio.Se.OptionTap),t.isActive?(t.optionType===wt.DoNoting&&(this.messageWindow.visible=!1,this.menuOptionButtons.forEach((function(t,e){t.deactivate()}))),this.delegate.onOptionSelected(t.optionType)):(this.optionButtons.forEach((function(t,e){t.deactivate()})),t.activate())},s.onItemPanelTapped=function(t){if(m.playSe(S.Audio.Se.OptionTap),this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1})),this.messageWindow.visible=!1,t.activate(),t.hasItem){var e=this.texts.get(t.itemTextId);if(!e)return;this.messageWindow.position.y=260,this.messageWindow.visible=!0,e.visible=!0}},s.onMenuOptionButtonTapped=function(t){if(m.playSe(S.Audio.Se.OptionTap),t.isActive)t.deactivate(),this.toggleDisplay(t.optionType,!1);else{var e=this;this.menuOptionButtons.forEach((function(t,i){t.deactivate(),e.toggleDisplay(t.optionType,!1)})),this.toggleDisplay(t.optionType,!0),t.activate()}},s.onMenuButtonTapped=function(){if(m.playSe(S.Audio.Se.OptionTap),this.isOpen=!this.isOpen,!this.isOpen){var t=this;this.menuOptionButtons.forEach((function(e,i){e.deactivate(),t.toggleDisplay(e.optionType,!1)})),this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1})),this.messageWindow.visible=!1}},s.toggleDisplay=function(t,e){if(t===wt.ShowItems&&(this.itemPanelFrame.visible=e,e||(this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1,ge(t,Xt)&&t.deactivate()})),this.messageWindow.visible=!1)),t===wt.ShowBackToTitle){this.messageWindow.position.y=270,this.messageWindow.visible=e;var i=this.texts.get(S.MessageIds.BackToTitle),n=this.texts.get(S.MessageIds.ContinueGame);if(!i)return;if(!n)return;i.visible=e,ge(i,Xt)&&i.activate(),n.visible=e}t===wt.ShowSoundVolume&&(this.soundOption.visible=e)},n=i,r=[{key:"resourceList",get:function(){return[S.UI.MenuBar,S.UI.MenuButton,S.UI.ItemPanelFrame]}}],(o=null)&&me(n.prototype,o),r&&me(n,r),i}(u.W20);function _e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Te(t){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Re(t,e){return!e||"object"!==Ce(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ie(t,e){return(Ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function je(t){return function(t){if(Array.isArray(t))return _e(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return _e(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _e(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Se.menuMoveFrame=10;var Ce=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function xe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Te(t);if(e){var o=Te(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Re(this,i)}}var Pe=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ie(t,e)}(i,t);var e=xe(i);function i(){return Ee(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e=new u.jyi;if(t){var i,n,o=t.textureName;if(o&&u.P6Y.kN[o]&&(e.texture=u.P6Y.kN[o]),t.anchor)(i=e.anchor).set.apply(i,je(t.anchor));if(t.scale)(n=e.scale).set.apply(n,je(t.scale))}var r=t.optionType;return new Xt(e,r)},i}(T);function Ae(t){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Be(t,e){return!e||"object"!==Ne(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function De(t,e){return(De=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ne=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ke(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ae(t);if(e){var o=Ae(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Be(this,i)}}var Ue=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&De(t,e)}(i,t);var e=ke(i);function i(t,n,o,r,s){var a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(a=e.call(this,t,r)).hasItem=!1,a.itemType=n,a.optionButton=t,a.itemTextId=o,a.optionId=s;var u=y.game.loader.resources[S.UI.ItemSelectFrame].texture;return u&&(a.frameSprite.texture=u),a.frameSprite.scale.set(1,1),a}var n=i.prototype;return n.addItem=function(){this.hasItem=!0,this.optionButton.texture=u.P6Y.kN[S.Dynamic.items(this.itemType)]},n.removeItem=function(){this.hasItem=!1,this.optionButton.texture=u.P6Y.kN[S.Dynamic.items(0)]},i}(Xt);function Me(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Ge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function We(t){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Le(t,e){return!e||"object"!==He(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fe(t,e){return(Fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ve(t){return function(t){if(Array.isArray(t))return Me(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return Me(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Me(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var He=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ze(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=We(t);if(e){var o=We(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Le(this,i)}}var Ke=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fe(t,e)}(i,t);var e=ze(i);function i(){return Ge(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e=new u.jyi;if(t){var i,n,o=t.textureName;if(o&&u.P6Y.kN[o]&&(e.texture=u.P6Y.kN[o]),t.anchor)(i=e.anchor).set.apply(i,Ve(t.anchor));if(t.scale)(n=e.scale).set.apply(n,Ve(t.scale))}return new Ue(e,t.itemType,t.itemTextId,t.optionType,t.optionId)},i}(T),Ye=Object.freeze({DownTiles:"downTiles",Position:"position",MessageIds:"messageIds",TextureName:"textureName",Visible:"visible"});function qe(t,e,i){return(qe="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Je(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function Je(t){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ze(t,e){return!e||"object"!==$e(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Xe(t,e){return(Xe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $e=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Qe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Je(t);if(e){var o=Je(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ze(this,i)}}var ti=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xe(t,e)}(i,t);var e=Qe(i);function i(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=e.call(this)).isPaused=!1,n.tiles=new Map,n.roomObjects=new Map,n.messages=new Map,n.options=new Map,n.messageWindow=null,n.itemPanels=[],n.menuTexts=new Map,n.soundOption=new u.W20,n.pinPad=new u.W20,n.code=[],n.correctCode=[],n.transitionIn=new b(1,0,-.02),n.transitionOut=new b(0,1,.02),n.state=St.LOADING_RESOURCES,n.sceneName="escape_scene",n.language=t,n.saveData={roomObject:[],mapData:void 0,playerItems:[],roomObjectState:[],code:[],isBalloonExist:!0},n.gameLogic=new Ot,n}var n=i.prototype;return n.beginTransitionIn=function(t,e){var n=this;qe(Je(i.prototype),"beginTransitionIn",this).call(this,(function(){n.state===St.RESOURCE_LOADED&&(n.state=St.READY,t(n),m.playBgm(S.Audio.Bgm.EscapeBGM))}),e)},n.createInitialResourceList=function(){return qe(Je(i.prototype),"createInitialResourceList",this).call(this).concat(S.UI.Tiles,S.UI.TileFrame,S.UI.PlayerAnimation,S.UI.Player,S.UI.RoomObjectMaster,S.UI.Items,S.UI.RoomObjects,de.resourceList,Xt.resourceList,Se.resourceList,[S.UI.Stage,S.Audio.Se.OptionTap,S.Audio.Se.ShowNextText,S.Audio.Se.TileTap,S.Audio.Bgm.EscapeBGM,S.Audio.Bgm.EndingBGM])},n.loadInitialResource=function(t){var e,i,n=this.createInitialResourceList(),o=S.UI.SceneUiGraph(this.sceneName);e="japanese"===this.language?S.UI.EscapeSceneMessage:S.UI.EscapeSceneEnglishMessage,i="japanese"===this.language?S.UI.EscapeSceneOption:S.UI.EscapeSceneEnglishOption;var r=S.UI.EscapeSceneRoomObject;n.push(o),n.push(e),n.push(i),n.push(r);var s=this.filterLoadedAssets(n);s.length>0?y.game.loader.add(s).load(t):t()},n.onInitialResourceLoaded=function(){var t,e=[],i=S.UI.SceneUiGraph(this.sceneName);t="japanese"===this.language?S.UI.EscapeSceneOption:S.UI.EscapeSceneEnglishOption;var n=S.UI.EscapeSceneRoomObject,o=y.game.loader.resources[i].data.nodes;o=(o=o.concat(y.game.loader.resources[t].data.nodes)).concat(y.game.loader.resources[n].data.nodes);var r=!0,s=!1,a=void 0;try{for(var u,c=o[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var l=u.value;"sprite"!==l.type&&"sprite_option"!==l.type&&"room_object"!==l.type&&"item_panel"!==l.type||e.push({name:l.params.textureName,url:l.params.url})}}catch(h){s=!0,a=h}finally{try{r||null==c.return||c.return()}finally{if(s)throw a}}return e},n.onResourceLoaded=function(){var t,e,i=y.game.loader.resources[S.UI.SceneUiGraph(this.sceneName)].data;t="japanese"===this.language?S.UI.EscapeSceneMessage:S.UI.EscapeSceneEnglishMessage,e="japanese"===this.language?S.UI.EscapeSceneOption:S.UI.EscapeSceneEnglishOption;var n=y.game.loader.resources[t].data,o=y.game.loader.resources[e].data,r=y.game.loader.resources[S.UI.EscapeSceneRoomObject].data;this.prepareUiGraphContainer(i),this.prepareUiGraphContainer(n),this.prepareUiGraphContainer(o),this.prepareUiGraphContainer(r);var s=y.game.loader.resources,a=s[S.UI.Stage].data,u=s[S.UI.RoomObjectMaster].data;this.playerAnimationMaster=s[S.UI.PlayerAnimation].data,this.tileSize=a.tileSize,this.initTiles(a,this.tileSize),this.uiGraphContainer.zIndex=1,this.addChild(this.uiGraphContainer),this.initSound(),this.initPinPad(),this.setHitArea(),this.initMenu(),this.initVolumeText(),this.initSoundOption(),this.loadSaveDataFromDB(a,u)},n.setHitArea=function(){var t=this.roomObjects.get("bowl");if(t){t.hitArea=new u.Cdc(t.width/2,t.height/2,30);var e=this.options.get("use_salt");e&&(e.hitArea=new u.AeJ(-75,-25,150,50))}},n.initMenu=function(){var t=[],e=!0,i=!1,n=void 0;try{for(var o,r=S.MenuOptionIds[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=this.options.get(s);a&&t.push(a)}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}var u=new Se(t,this.itemPanels,this.soundOption,this.menuTexts,this);this.menu=u,this.menu.zIndex=3,this.registerUpdatingObject(u),this.addChild(this.menu)},n.initSoundOption=function(){var t=!0,e=!1,i=void 0;try{for(var n,o=S.SoundOptionIds[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var r=n.value,s=this.uiGraph.get(r);s&&this.soundOption.addChild(s)}}catch(a){e=!0,i=a}finally{try{t||null==o.return||o.return()}finally{if(e)throw i}}this.soundOption.visible=!1,this.soundOption.zIndex=3,this.addChild(this.soundOption)},n.initCode=function(){var t=this.messages.get("mirror_message_4");t&&("japanese"===this.language?t.text="\u624b\u93e1\u3067\u9996\u306e\u5f8c\u308d\u3092\u898b\u308b\u3068            \u5c0f\u3055\u304f\u300c".concat(this.correctCode[0].toString()+this.correctCode[1].toString()+this.correctCode[2].toString(),"\u300d\u3068\u66f8\u304b\u308c\u3066\u3044\u308b\u3002"):t.text="when you looked at the back of your neck             with the hand mirror, it was written as '".concat(this.correctCode[0].toString()+this.correctCode[1].toString()+this.correctCode[2].toString(),"'"))},n.initPinPad=function(){var t=!0,e=!1,i=void 0;try{for(var n,o=S.PinPadIds[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var r=n.value,s=this.uiGraph.get(r);s&&this.pinPad.addChild(s)}}catch(a){e=!0,i=a}finally{try{t||null==o.return||o.return()}finally{if(e)throw i}}this.pinPad.visible=!1,this.pinPad.zIndex=3,this.addChild(this.pinPad)},n.initVolumeText=function(){var t=Math.round(100*m.bgmVolume),e=Math.round(10*m.seVolume);this.uiGraph.get("bgm_volume").text=t.toString();this.uiGraph.get("se_volume").text=e.toString()},n.initSound=function(){var t=y.game.loader.resources,e=[S.Audio.Se.OptionTap,S.Audio.Se.ShowNextText,S.Audio.Se.TileTap,S.Audio.Bgm.EscapeBGM,S.Audio.Bgm.EndingBGM],i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;m.createSound(a,t[a].buffer)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},n.update=function(t){if(!this.isPaused)switch(this.state){case St.LOADING_RESOURCES:break;case St.READY:this.state=St.INGAME;break;case St.INGAME:case St.FINISHED:this.gameLogic.update()}this.updateRegisteredObjects(t),this.transitionIn.isActive()?this.transitionIn.update(t):this.transitionOut.isActive()&&this.transitionOut.update(t)},n.onRoomObjectTapped=function(t){if(!this.messageWindow){m.playSe(S.Audio.Se.OptionTap),this.roomObjects.forEach((function(t,e){t.interactive=!1})),this.tiles.forEach((function(t,e){t.isActive&&t.toggleFrame(),t.interactive=!1}));var e=this.roomObjects.get(t);e&&(this.spawnMessageWindow(e.messageIds),this.gameLogic.onRoomObjectTapped(t))}},n.onPlayerSpawned=function(t){this.tiles.forEach((function(e){e.tilePosition[0]===t.positionRow&&e.tilePosition[1]===t.positionColumn&&(e.interactive=!1)})),this.player=new _t(this.playerAnimationMaster,this.tileSize,{x:t.positionColumn*this.tileSize,y:t.positionRow*this.tileSize-this.tileSize/3}),this.player.sprite.zIndex=2,this.addChild(this.player.sprite),this.registerUpdatingObject(this.player),this.sortChildren()},n.onPlayerEntityStateChanged=function(t){if(t.state===gt.IDLE&&(this.player.requestAnimation(S.AnimationTypes.Player.WAIT),this.tiles.forEach((function(e){t.positionRow===e.tilePosition[0]&&t.positionColumn===e.tilePosition[1]?e.interactive=!1:e.interactive=!0})),this.roomObjects.forEach((function(e,i){var n=!0,o=!1,r=void 0;try{for(var s,a=e.downTiles[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;(u[0]===t.positionRow-1&&u[1]===t.positionColumn||u[0]===t.positionRow+1&&u[1]===t.positionColumn||u[0]===t.positionRow&&u[1]===t.positionColumn-1||u[0]===t.positionRow&&u[1]===t.positionColumn+1)&&(e.interactive=!0)}}catch(c){o=!0,r=c}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}}))),t.state===gt.WALK&&this.roomObjects.forEach((function(t,e){t.interactive=!1})),t.state===gt.CHECKING){if(t.checkingObject===S.RoomObjects.CLOCK)return void this.player.requestAnimation(S.AnimationTypes.Player.CHACKUP);if(null===t.checkingObject)return;var e=this.roomObjects.get(t.checkingObject);if(!e)return;var i=0,n=0,o=0,r=0,s=!0,a=!1,u=void 0;try{for(var c,l=e.downTiles[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var h=c.value;h[0]<t.positionRow?i++:h[0]>t.positionRow&&n++,h[1]<t.positionColumn?o++:h[1]>t.positionColumn&&r++}}catch(p){a=!0,u=p}finally{try{s||null==l.return||l.return()}finally{if(a)throw u}}i===e.downTiles.length?this.player.requestAnimation(S.AnimationTypes.Player.CHACKUP):n===e.downTiles.length?this.player.requestAnimation(S.AnimationTypes.Player.CHACKDOWN):o===e.downTiles.length?this.player.requestAnimation(S.AnimationTypes.Player.CHACKLEFT):r===e.downTiles.length&&this.player.requestAnimation(S.AnimationTypes.Player.CHACKRIGHT)}},n.onBgmArrowTapped=function(t){var e=m.bgmVolume;(e+=t)<0?e=0:e>.1&&(e=.1);this.uiGraph.get("bgm_volume").text=Math.round(100*e).toString(),m.bgmVolume=e,m.playSe(S.Audio.Se.OptionTap),this.saveBgmVolumeToDB(m.bgmVolume),m.setSoundVolume(m.bgmVolume,m.seVolume)},n.onSeArrowTapped=function(t){var e=m.seVolume;(e+=t)<0?e=0:e>1&&(e=1);this.uiGraph.get("se_volume").text=Math.round(10*e).toString(),m.seVolume=e,m.playSe(S.Audio.Se.OptionTap),this.saveSeVolumeToDB(m.seVolume)},n.onPinPadTapped=function(t){if(m.playSe(S.Audio.Se.OptionTap),!(this.code.length>=3)){var e;this.code.push(t),e=1===this.code.length?"first":2===this.code.length?"second":"third";var i=this.uiGraph.get("code_".concat(e));i&&(i.text=t.toString())}},n.onPinPadCancelTapped=function(){if(m.playSe(S.Audio.Se.OptionTap),0!==this.code.length){var t;this.code.pop(),t=0===this.code.length?"first":1===this.code.length?"second":"third";var e=this.uiGraph.get("code_".concat(t));e&&(e.text="")}},n.onPinPadEnterTapped=function(){this.gameLogic.onRoomObjectTapped("safe"),m.playSe(S.Audio.Se.OptionTap),this.isPaused=!1;var t=this.uiGraph.get("code_first"),e=this.uiGraph.get("code_second"),i=this.uiGraph.get("code_third");if(t&&e&&i){if(t.text="",e.text="",i.text="",this.code[0]===this.correctCode[0]&&this.code[1]===this.correctCode[1]&&this.code[2]===this.correctCode[2]){this.spawnMessageWindow(["safe_opened","there_is_crossbow",["get_crossbow","do_nothing"]]);var n=this.roomObjects.get("safe");if(!n)return;n.messageIds.pop(),n.messageIds=["safe_message_1","there_is_crossbow",["get_crossbow","do_nothing"]],this.saveRoomObjectToDB(S.RoomObjects.SAFE,Ye.MessageIds,n.messageIds)}else{this.spawnMessageWindow(["wrong_code"])}this.pinPad.visible=!1,this.code=[]}},n.spawnMessageWindow=function(t){this.messages.forEach((function(t,e){t.visible=!0})),this.options.forEach((function(t,e){t.visible=!0}));var e=this.createMessages(t),i=new de(e,this);i.zIndex=3,this.messageWindow=i,this.addChild(i),this.registerUpdatingObject(i)},n.createMessages=function(t){var e=[],i=!0,n=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value,u=[];if("string"===typeof a){var c=this.messages.get(a);if(!c)continue;e.push(c)}else{var l=!0,h=!1,p=void 0;try{for(var f,d=a[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value,y=this.options.get(m);y&&u.push(y)}}catch(g){h=!0,p=g}finally{try{l||null==d.return||d.return()}finally{if(h)throw p}}e.push(u)}}}catch(g){n=!0,o=g}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return e},n.onMessageWindowClosed=function(){this.gameLogic.onChackingEnd(),this.messageWindow=null},n.onOptionSelected=function(t){if(t!==wt.DoNoting){if(t!==wt.ShowItemOption)return t===wt.ShowPinPad?(this.isPaused=!0,void(this.pinPad.visible=!0)):t===wt.BackToTitle?(this.visible=!1,void this.showTitleScene()):void this.gameLogic.onOptionSelected(t);var e=this,i=[];if(this.itemPanels.forEach((function(t,n){if(t.hasItem){var o=e.options.get(t.optionId);if(!o)return;i.push(o)}})),0===i.length){var n,o=this.messages.get("has_no_item");if(!o)return;null===(n=this.messageWindow)||void 0===n||n.addText(o,1)}else{var r;null===(r=this.messageWindow)||void 0===r||r.addText(i,1)}}},n.onItemUsed=function(t,e,i){var n=this.roomObjects.get(e.id);if(n)if(t===wt.UseTinStatue&&e.id===S.RoomObjects.GAS_STOVE){var o,r,s=this.messages.get("tin_statue_melted"),a=this.messages.get("get_coin");if(!s)return;if(!a)return;null===(o=this.messageWindow)||void 0===o||o.addText(s,1),null===(r=this.messageWindow)||void 0===r||r.addText(a,2),n.messageIds.pop(),n.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.GAS_STOVE,Ye.MessageIds,n.messageIds)}else if(t===wt.UseDVD&&e.id===S.RoomObjects.TV){var c,l,h=this.messages.get("serching"),p=this.messages.get("watched_dvd");if(!h)return;if(!p)return;null===(c=this.messageWindow)||void 0===c||c.addText(h,1),null===(l=this.messageWindow)||void 0===l||l.addText(p,2)}else if(t===wt.UseCoin&&e.id===S.RoomObjects.VENDING_MACHINE){var f,d=this.messages.get("get_banana");if(!d)return;null===(f=this.messageWindow)||void 0===f||f.addText(d,1),n.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.VENDING_MACHINE,Ye.MessageIds,n.messageIds)}else if(t===wt.UseBanana&&e.id===S.RoomObjects.FREEZER){var m,g=this.messages.get("freeze_banana");if(!g)return;null===(m=this.messageWindow)||void 0===m||m.addText(g,1),n.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.FREEZER,Ye.MessageIds,n.messageIds)}else if(t===wt.UseSalt&&e.id===S.RoomObjects.BARREL){var v,b,O=this.messages.get("put_salt_in_barrel"),_=this.messages.get("get_desk_key");if(!O)return;if(!_)return;null===(v=this.messageWindow)||void 0===v||v.addText(O,1),null===(b=this.messageWindow)||void 0===b||b.addText(_,2),n.messageIds.pop(),n.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.BARREL,Ye.MessageIds,n.messageIds)}else if(t===wt.UseDeskKey&&e.id===S.RoomObjects.DESK){var E,T,R,I=[],j=this.messages.get("unlock"),C=this.messages.get("there_is_pencil"),x=this.options.get("get_pencil"),P=this.options.get("do_nothing");if(!j)return;if(!C)return;if(!x)return;if(!P)return;I.push(x),I.push(P),null===(E=this.messageWindow)||void 0===E||E.addText(j,1),null===(T=this.messageWindow)||void 0===T||T.addText(C,2),null===(R=this.messageWindow)||void 0===R||R.addText(I,3)}else if(t===wt.UsePencil&&e.id===S.RoomObjects.GRINDER){var A,B,D=this.messages.get("grind_pencil"),N=this.messages.get("get_sharpened_pencil");if(!D)return;if(!N)return;null===(A=this.messageWindow)||void 0===A||A.addText(D,1),null===(B=this.messageWindow)||void 0===B||B.addText(N,2),n.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.GRINDER,Ye.MessageIds,n.messageIds)}else if(t===wt.UseDetergent&&e.id===S.RoomObjects.MIRROR){var k,U,M,G=[],W=this.messages.get("washed_mirror"),L=this.messages.get("mirror_message_3"),F=this.options.get("use_item"),V=this.options.get("do_nothing");if(!W)return;if(!L)return;if(!F)return;if(!V)return;G.push(F),G.push(V),null===(k=this.messageWindow)||void 0===k||k.addText(W,1),null===(U=this.messageWindow)||void 0===U||U.addText(L,2),null===(M=this.messageWindow)||void 0===M||M.addText(G,3),n.messageIds[1]="mirror_message_3",this.saveRoomObjectToDB(S.RoomObjects.MIRROR,Ye.MessageIds,n.messageIds);var H=u.P6Y.kN["room_object/mirror.png"];n.sprite.texture=H,this.saveRoomObjectToDB(S.RoomObjects.MIRROR,Ye.TextureName,"room_object/mirror.png")}else if(t===wt.UseHandMirror&&e.id===S.RoomObjects.MIRROR&&-1!==e.states.indexOf(bt.Washed)){var z,K=this.messages.get("mirror_message_4");if(!K)return;null===(z=this.messageWindow)||void 0===z||z.addText(K,1)}else if(t===wt.UseCarKey&&e.id===S.RoomObjects.CAR){var Y=this;this.isPaused=!0,this.beginTransitionOut((function(){Y.isPaused=!1,Y.player.sprite.position.set(456.4,426.6);var t=y.game.loader.resources[S.UI.Stage].data.carMovedMapData;Y.resetTiles(t),Y.saveData.mapData=t,Y.saveProgressToDB(),n.position.x=380,Y.saveRoomObjectToDB(S.RoomObjects.CAR,Ye.Position,[n.position.x,n.position.y]),n.downTiles=[[8,6],[8,7],[8,8],[9,6],[9,7],[9,8]],Y.saveRoomObjectToDB(S.RoomObjects.CAR,Ye.DownTiles,n.downTiles),Y.spawnMessageWindow(["moved_car"]),Y.beginTransitionIn((function(){})),n.messageIds.pop(),Y.saveRoomObjectToDB(S.RoomObjects.CAR,Ye.MessageIds,n.messageIds)}),!1)}else if(t===wt.UseCrossBow&&e.id===S.RoomObjects.BALLOON&&-1!==(null===i||void 0===i?void 0:i.indexOf(w.SHARPENED_PENCIL))){var q=this;this.isPaused=!0,this.beginTransitionOut((function(){q.isPaused=!1,n.sprite.visible=!1,q.saveRoomObjectToDB(S.RoomObjects.BALLOON,Ye.Visible,n.sprite.visible);var t=q.tiles.get(65);t&&(t.tileSprite.texture=u.P6Y.kN["stage/floor.png"],q.saveData.isBalloonExist=!1,q.saveProgressToDB(),q.spawnMessageWindow(["find_nail","get_nail"]),q.gameLogic.onRoomObjectTapped(S.RoomObjects.BALLOON),q.beginTransitionIn((function(){})))}),!1)}else if(t===wt.UseFrozenBanana&&e.id===S.RoomObjects.CHAIR&&-1!==(null===i||void 0===i?void 0:i.indexOf(w.NAIL))){var J=this;this.isPaused=!0,this.beginTransitionOut((function(){J.isPaused=!1;var t=u.P6Y.kN["room_object/chair.png"];n.sprite.texture=t,J.saveRoomObjectToDB(S.RoomObjects.CHAIR,Ye.TextureName,"room_object/chair.png"),n.position.set(205,85),J.saveRoomObjectToDB(S.RoomObjects.CHAIR,Ye.Position,[n.position.x,n.position.y]),n.messageIds=["chair_message_1"],J.saveRoomObjectToDB(S.RoomObjects.CHAIR,Ye.MessageIds,n.messageIds),J.spawnMessageWindow(["fix_chair"]),J.gameLogic.onRoomObjectTapped(S.RoomObjects.CHAIR),J.beginTransitionIn((function(){}))}),!1);var Z=this.roomObjects.get("clock");if(!Z)return;Z.messageIds=["clock_message_2","clock_message_3",["set_clock","do_nothing"]],this.saveRoomObjectToDB(S.RoomObjects.CLOCK,Ye.MessageIds,Z.messageIds)}else{var X,$=this.messages.get("can_not_use");if(!$)return;null===(X=this.messageWindow)||void 0===X||X.addText($,1)}},n.onPlayerItemsChanged=function(t){this.saveData.playerItems=t,this.saveProgressToDB(),this.menu.updateItemPanels(t)},n.onRoomObjectOptionSelected=function(t,e){var i=this.roomObjects.get(t.id);if(i){if(e===wt.CheckUnderBed)if(-1===t.states.indexOf(bt.CheckedUnderBed)){var n,o,r=this.messages.get("serching"),s=this.messages.get("get_tin_statue");if(!r)return;if(!s)return;null===(n=this.messageWindow)||void 0===n||n.addText(r,1),null===(o=this.messageWindow)||void 0===o||o.addText(s,2)}else{var a,c=this.messages.get(S.MessageIds.NothingSpecial);if(!c)return;null===(a=this.messageWindow)||void 0===a||a.addText(c,1)}if(e===wt.CheckUnderPillow)if(-1===t.states.indexOf(bt.CheckedUnderPillow)){var l,h,p=this.messages.get("serching"),f=this.messages.get("get_hand_mirror");if(!p)return;if(!f)return;null===(l=this.messageWindow)||void 0===l||l.addText(p,1),null===(h=this.messageWindow)||void 0===h||h.addText(f,2)}else{var d,m=this.messages.get(S.MessageIds.NothingSpecial);if(!m)return;null===(d=this.messageWindow)||void 0===d||d.addText(m,1)}if(e===wt.JumpOnBed)if(-1===t.states.indexOf(bt.JumpedOnBed)){var g,v=this.messages.get("something_on_closet");if(!v)return;null===(g=this.messageWindow)||void 0===g||g.addText(v,1);var b=this.roomObjects.get(S.RoomObjects.CLOSET),w=null===b||void 0===b?void 0:b.messageIds[b.messageIds.length-1];R=w,(null!=(I=Array)&&"undefined"!==typeof Symbol&&I[Symbol.hasInstance]?I[Symbol.hasInstance](R):R instanceof I)&&w.unshift("check_on_closet"),this.saveRoomObjectToDB(S.RoomObjects.CLOSET,Ye.MessageIds,null===b||void 0===b?void 0:b.messageIds)}else if(-1===t.states.indexOf(bt.GotCarKey)){var O,_=this.messages.get("something_on_closet");if(!_)return;null===(O=this.messageWindow)||void 0===O||O.addText(_,1)}else{var E,T=this.messages.get("have_a_fun");if(!T)return;null===(E=this.messageWindow)||void 0===E||E.addText(T,1)}var R,I;if(e===wt.CheckInCloset)if(-1===t.states.indexOf(bt.CheckedInCloset)){var j,C,x=this.messages.get("serching"),P=this.messages.get("get_detergent");if(!x)return;if(!P)return;null===(j=this.messageWindow)||void 0===j||j.addText(x,1),null===(C=this.messageWindow)||void 0===C||C.addText(P,2)}else{var A,B=this.messages.get(S.MessageIds.NothingSpecial);if(!B)return;null===(A=this.messageWindow)||void 0===A||A.addText(B,1)}if(e===wt.CheckOnCloset)if(-1===t.states.indexOf(bt.CheckedOnCloset)){var D,N,k=this.messages.get("serching"),U=this.messages.get("get_car_key");if(!k)return;if(!U)return;null===(D=this.messageWindow)||void 0===D||D.addText(k,1),null===(N=this.messageWindow)||void 0===N||N.addText(U,2)}else{var M,G=this.messages.get(S.MessageIds.NothingSpecial);if(!G)return;null===(M=this.messageWindow)||void 0===M||M.addText(G,1)}if(e===wt.GetSalt){var W,L=this.messages.get("get_salt");if(!L)return;null===(W=this.messageWindow)||void 0===W||W.addText(L,1),i.messageIds.pop(),i.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.CABINET,Ye.MessageIds,i.messageIds)}if(e===wt.GetCrossbow){var F,V=this.messages.get("get_crossbow");if(!V)return;null===(F=this.messageWindow)||void 0===F||F.addText(V,1),i.messageIds.pop(),i.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.SAFE,Ye.MessageIds,i.messageIds)}if(e===wt.GetDVD){var H,z=this.messages.get("get_dvd");if(!z)return;null===(H=this.messageWindow)||void 0===H||H.addText(z,1)}if(e===wt.CheckRightDrawer)if(-1===t.states.indexOf(bt.UsedKey)){var K,Y,q=[],J=this.messages.get("locked"),Z=this.options.get("use_item"),X=this.options.get("do_nothing");if(!J)return;if(!Z)return;if(!X)return;q.push(Z),q.push(X),null===(K=this.messageWindow)||void 0===K||K.addText(J,1),null===(Y=this.messageWindow)||void 0===Y||Y.addText(q,2)}else if(-1===t.states.indexOf(bt.HasNoPencil)){var $,Q,tt=[],et=this.messages.get("there_is_pencil"),it=this.options.get("get_pencil"),nt=this.options.get("do_nothing");if(!et)return;if(!it)return;if(!nt)return;tt.push(it),tt.push(nt),null===($=this.messageWindow)||void 0===$||$.addText(et,1),null===(Q=this.messageWindow)||void 0===Q||Q.addText(tt,2)}else{var ot,rt=this.messages.get(S.MessageIds.NothingSpecial);if(!rt)return;null===(ot=this.messageWindow)||void 0===ot||ot.addText(rt,1)}if(e===wt.CheckLeftDrawer)if(-1===t.states.indexOf(bt.HasNoDVD)){var st,at,ut=[],ct=this.messages.get("there_is_dvd"),lt=this.options.get("get_dvd"),ht=this.options.get("do_nothing");if(!ct)return;if(!lt)return;if(!ht)return;ut.push(lt),ut.push(ht),null===(st=this.messageWindow)||void 0===st||st.addText(ct,1),null===(at=this.messageWindow)||void 0===at||at.addText(ut,2)}else{var pt,ft=this.messages.get(S.MessageIds.NothingSpecial);if(!ft)return;null===(pt=this.messageWindow)||void 0===pt||pt.addText(ft,1)}if(e===wt.GetPenCil){var dt,mt=this.messages.get("get_pencil");if(!mt)return;null===(dt=this.messageWindow)||void 0===dt||dt.addText(mt,1)}if(e===wt.MovePig){var yt,gt=this.messages.get("not_move");if(!gt)return;null===(yt=this.messageWindow)||void 0===yt||yt.addText(gt,1)}if(e===wt.ReadHint){var vt,Ot=[],St=this.options.get("hint_1"),_t=this.options.get("hint_2");if(!St)return;if(!_t)return;Ot.push(St),Ot.push(_t),null===(vt=this.messageWindow)||void 0===vt||vt.addText(Ot,1)}if(e===wt.ReadHint1){var Et,Tt=this.messages.get("hint_1");if(!Tt)return;null===(Et=this.messageWindow)||void 0===Et||Et.addText(Tt,1)}if(e===wt.ReadHint2){var Rt,It=this.messages.get("hint_2");if(!It)return;null===(Rt=this.messageWindow)||void 0===Rt||Rt.addText(It,1)}if(e===wt.SetTime){var jt=this;this.isPaused=!0,this.beginTransitionOut((function(){jt.isPaused=!1;var t=y.game.loader.resources[S.UI.Stage].data.pigMovedMapData;jt.resetTiles(t),jt.saveData.mapData=t,jt.saveProgressToDB();var e=jt.roomObjects.get("pig");if(e){var n=u.P6Y.kN["room_object/pig2.png"],o=u.P6Y.kN["room_object/clock_12_00.png"];e.sprite.texture=n,jt.saveRoomObjectToDB(S.RoomObjects.PIG,Ye.TextureName,"room_object/pig2.png"),i.sprite.texture=o,jt.saveRoomObjectToDB(S.RoomObjects.CLOCK,Ye.TextureName,"room_object/clock_12_00.png"),e.position.set(40,565),jt.saveRoomObjectToDB(S.RoomObjects.PIG,Ye.Position,[e.position.x,e.position.y]),e.downTiles=[[9,1]],jt.saveRoomObjectToDB(S.RoomObjects.PIG,Ye.DownTiles,e.downTiles),e.messageIds=["pig_message_2"],jt.saveRoomObjectToDB(S.RoomObjects.PIG,Ye.MessageIds,e.messageIds),jt.spawnMessageWindow(["moved_pig"]),jt.beginTransitionIn((function(){})),i.messageIds.pop(),i.messageIds.pop(),jt.saveRoomObjectToDB(S.RoomObjects.CLOCK,Ye.MessageIds,i.messageIds)}}),!1)}}},n.onPlayerEntityWalked=function(t){switch(t.walkDirection){case mt.UP:this.player.requestAnimation(S.AnimationTypes.Player.WALKUP);break;case mt.DOWN:this.player.requestAnimation(S.AnimationTypes.Player.WALKDOWN);break;case mt.LEFT:this.player.requestAnimation(S.AnimationTypes.Player.WALKLEFT);break;case mt.RIGHT:this.player.requestAnimation(S.AnimationTypes.Player.WALKRIGHT)}if(this.tiles.forEach((function(e){t.positionRow===e.tilePosition[0]&&t.positionColumn===e.tilePosition[1]?e.interactive=!1:e.interactive=!0})),t.walkDirection===mt.UP||t.walkDirection===mt.DOWN?this.player.sprite.y=this.player.spawnedPosition.y+t.distanceRow:this.player.sprite.x=this.player.spawnedPosition.x+t.distanceColumn,3===t.positionRow&&4===t.positionColumn||3===t.positionRow&&5===t.positionColumn||3===t.positionRow&&6===t.positionColumn||4===t.positionRow&&4===t.positionColumn||4===t.positionRow&&5===t.positionColumn||4===t.positionRow&&6===t.positionColumn||5===t.positionRow&&5===t.positionColumn){if(0===this.player.sprite.zIndex)return;this.player.sprite.zIndex=0,this.sortChildren()}else{if(2===this.player.sprite.zIndex)return;this.player.sprite.zIndex=2,this.sortChildren()}},n.onTileTapped=function(t){var e=this;if(!this.isPaused&&!this.messageWindow){var i=!1;this.tiles.forEach((function(n){n.isActive&&t.tilePosition[0]===n.tilePosition[0]&&t.tilePosition[1]===n.tilePosition[1]?(e.gameLogic.requestWalk(t.tilePosition),t.toggleFrame(),i=!0):n.isActive&&(n.toggleFrame(),i=!0)})),!1===i&&t.toggleFrame()}},n.initRoomObject=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=this.roomObjects.get(s.id);if(!a)return;if(s.downTiles&&(a.downTiles=s.downTiles),s.messageIds&&(a.messageIds=s.messageIds),s.position&&a.position.set(s.position[0],s.position[1]),s.textureName){var c=u.P6Y.kN[s.textureName];a.sprite.texture=c}void 0!==s.visible&&(a.sprite.visible=s.visible)}}catch(l){i=!0,n=l}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.initTiles=function(t,e){for(var i=this,n=function(n){for(var r=i,s=function(i){var o=r,s=a[i],u=new Ct(s,[n,i],e);u.position.set(i*r.tileSize,n*r.tileSize),1!==t.mapData[n][i]&&(u.touchable=!0,u.interactive=!0),u.on("pointertap",(function(){o.onTileTapped(u)}));var c=n.toString(),l=i.toString();r.tiles.set(Number(c+l),u),r.addChild(u)},a=o[n],u=0;u<a.length;u++)s(u)},o=t.tileData,r=0;r<o.length;r++)n(r)},n.onGameOver=function(){var t=this;this.isPaused=!0,this.menu.visible=!1,this.soundOption.visible=!1,this.deleteSaveData(),m.destroySound(S.Audio.Bgm.EscapeBGM),this.beginTransitionOut((function(){m.playBgm(S.Audio.Bgm.EndingBGM,6),t.spawnMessageWindow(["serching","wake_message_1","wake_message_2","wake_message_3","thanks_message",["back_to_title_2"]])})),this.state=St.FINISHED},n.getCustomUiGraphFactory=function(t){return"room_object"===t?new Ht:"text_option"===t||"menu_text_option"===t?new se:"sprite_option"===t?new Pe:"item_panel"===t?new Ke:null},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=H.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),"room_object"===s.type?(this.roomObjects.set(s.id,u),this.saveData.roomObject.push({id:s.id})):"message"===s.type?this.messages.set(s.id,u):"menu_text"===s.type||"menu_text_option"===s.type?this.menuTexts.set(s.id,u):"text_option"===s.type||"sprite_option"===s.type?this.options.set(s.id,u):"item_panel"===s.type?this.itemPanels.push(u):this.uiGraph.set(s.id,u),"room_object"===s.type&&this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.resetTiles=function(t){for(var e=0;e<t.length;e++)for(var i=t[e],n=0;n<i.length;n++){var o=t[e][n],r=e.toString(),s=n.toString(),a=this.tiles.get(Number(r+s));a&&(0===o?(a.touchable=!0,a.interactive=!0):(a.touchable=!1,a.interactive=!1))}},n.showTitleScene=function(){m.paused=!1,m.sceneIsPaused=!1,this.destroySound(),y.loadScene(new ai)},n.saveRoomObjectToDB=function(t,e,i){var n=!0,o=!1,r=void 0;try{for(var s,a=this.saveData.roomObject[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;if(u.id===t)switch(e){case"downTiles":u.downTiles=i;break;case"messageIds":u.messageIds=i;break;case"position":u.position=i;break;case"textureName":u.textureName=i;break;case"visible":u.visible=i}}}catch(c){o=!0,r=c}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}this.saveProgressToDB()},n.saveProgressToDB=function(){f.put("saveData",this.saveData)},n.loadSaveDataFromDB=function(t,e){var i=this;f.get("saveData",(function(n){if(n){if(i.saveData=n,i.initRoomObject(i.saveData.roomObject),void 0!==i.saveData.mapData&&i.resetTiles(i.saveData.mapData),0!==i.saveData.playerItems.length&&i.menu.updateItemPanels(i.saveData.playerItems),0!==i.saveData.code.length&&(i.correctCode=i.saveData.code),!i.saveData.isBalloonExist){var o=i.tiles.get(65);if(!o)return;o.tileSprite.texture=u.P6Y.kN["stage/floor.png"]}}else{i.spawnMessageWindow(["start_escape"]);for(var r=0;r<3;r++){var s=Math.floor(10*Math.random());i.correctCode.push(s)}i.saveData.code=i.correctCode,i.saveProgressToDB()}i.initCode(),i.gameLogic.init({delegator:i,stageMaster:t,roomObjectMaster:e,saveData:i.saveData}),i.transitionIn.isFinished()?i.state=St.READY:i.state=St.RESOURCE_LOADED}))},n.saveBgmVolumeToDB=function(t){f.put("bgmVolume",t)},n.saveSeVolumeToDB=function(t){f.put("seVolume",t)},n.deleteSaveData=function(){f.delete("saveData")},i}($);function ei(t,e,i){return(ei="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ii(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function ii(t){return(ii=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ni(t,e){return!e||"object"!==ri(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function oi(t,e){return(oi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ri=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function si(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ii(t);if(e){var o=ii(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ni(this,i)}}var ai=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oi(t,e)}(i,t);var e=si(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=e.call(this)).title1MoveRate=0,t.title2MoveRate=0,t.title3MoveRate=0,t.languageOption=new u.W20,t.confirmation=new u.W20,t.hasSaveData=!1,t.sceneName="title_scene",t.transitionIn=new b(1,0,-.02),t.transitionOut=new b(0,1,.02),t.loadSaveDataFromDB(),t}var n=i.prototype;return n.createInitialResourceList=function(){var t=ei(ii(i.prototype),"createInitialResourceList",this).call(this);return t.push(S.Audio.Bgm.TitleBgm),t.push(S.Audio.Se.OptionTap),t},n.update=function(t){ei(ii(i.prototype),"update",this).call(this,t),this.language?(this.updateTitles(),this.updateButtons()):this.elapsedFrameCount=0,90===this.elapsedFrameCount&&this.playBgmIfNeeded()},n.onResourceLoaded=function(){ei(ii(i.prototype),"onResourceLoaded",this).call(this),this.setTitleMoveDistance(),this.languageOption.visible=!1,this.confirmation.visible=!1,this.uiGraphContainer.addChild(this.languageOption),this.uiGraphContainer.addChild(this.confirmation),this.addChild(this.uiGraphContainer),this.loadLanguageFromDB(),this.initSound()},n.initSound=function(){var t=y.game.loader.resources,e=[S.Audio.Se.OptionTap],i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;m.createSound(a,t[a].buffer)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},n.onLanguageSelected=function(t){m.playSe(S.Audio.Se.OptionTap);var e=this.uiGraph.get("new_game"),i=this.uiGraph.get("continue"),n=this.uiGraph.get("option"),o=this.uiGraph.get("credit");e&&i&&n&&o&&(e.interactive=!0,i.interactive=!0,n.interactive=!0,o.interactive=!0,this.languageOption.visible=!1,this.language=t,this.saveLanguageToDB(t))},n.easeOutQuint=function(t){return 1-Math.pow(1-t,5)},n.updateTitles=function(){var t=this.uiGraph.get("title_1"),e=this.uiGraph.get("title_2"),i=this.uiGraph.get("title_3");t&&e&&i&&(t.position.x===this.title1MoveDistance&&e.position.x===this.title2MoveDistance&&i.position.x===this.title3MoveDistance||(t.position.x>=this.title1MoveDistance?t.position.x=this.title1MoveDistance:(this.title1MoveRate+=10/this.title1MoveDistance,t.position.x=this.title1MoveDistance*this.easeOutQuint(this.title1MoveRate)),e.position.x>=this.title2MoveDistance?e.position.x=this.title2MoveDistance:this.elapsedFrameCount>=20&&(this.title2MoveRate+=10/this.title2MoveDistance,e.position.x=this.title2MoveDistance*this.easeOutQuint(this.title2MoveRate)),i.position.x>=this.title3MoveDistance?i.position.x=this.title3MoveDistance:this.elapsedFrameCount>=40&&(this.title3MoveRate+=10/this.title3MoveDistance,i.position.x=this.title3MoveDistance*this.easeOutQuint(this.title3MoveRate))))},n.updateButtons=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("continue_2"),n=this.uiGraph.get("option"),o=this.uiGraph.get("credit");t&&e&&i&&n&&o&&(t.visible&&e.visible||i.visible&&n.visible&&o.visible||this.elapsedFrameCount>=80&&(t.visible=!0,this.hasSaveData?e.visible=!0:i.visible=!0,n.visible=!0,o.visible=!0))},n.setTitleMoveDistance=function(){var t=this.uiGraph.get("title_1"),e=this.uiGraph.get("title_2"),i=this.uiGraph.get("title_3");t&&e&&i&&(this.title1MoveDistance=320+t.width/2,this.title2MoveDistance=320+e.width/2,this.title3MoveDistance=320+i.width/2)},n.newGame=function(){this.isOver||(m.playSe(S.Audio.Se.OptionTap),this.deleteSaveData(),this.onContinueButtonTouched())},n.cancelNewGame=function(){if(!this.isOver){m.playSe(S.Audio.Se.OptionTap);var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("option"),n=this.uiGraph.get("credit");t&&e&&i&&n&&(t.interactive=!0,e.interactive=!0,i.interactive=!0,n.interactive=!0,this.confirmation.visible=!1)}},n.onNewGameButtonTouched=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(m.playSe(S.Audio.Se.OptionTap),this.hasSaveData?this.showConfirmation():this.onContinueButtonTouched())},n.onContinueButtonTouched=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(m.destroySound(S.Audio.Bgm.TitleBgm),m.playSe(S.Audio.Se.OptionTap),y.loadScene(new ti(this.language)),this.isOver=!0)},n.showOptionScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,m.playSe(S.Audio.Se.OptionTap),y.loadScene(new rt(this.language)))},n.showCreditScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,m.playSe(S.Audio.Se.OptionTap),y.loadScene(new pt))},n.showLanguageOption=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("option"),n=this.uiGraph.get("credit");t&&e&&i&&n&&(t.interactive=!1,e.interactive=!1,i.interactive=!1,n.interactive=!1,this.languageOption.visible=!0)},n.showConfirmation=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("option"),n=this.uiGraph.get("credit");t&&e&&i&&n&&(t.interactive=!1,e.interactive=!1,i.interactive=!1,n.interactive=!1,this.confirmation.visible=!0)},n.saveLanguageToDB=function(t){f.put("language",t)},n.loadLanguageFromDB=function(){var t=this;f.get("language",(function(e){if(e?t.language=e:t.showLanguageOption(),"japanese"===e){var i=t.uiGraph.get("confirm_message_english");if(!i)return;i.visible=!1}else{var n=t.uiGraph.get("confirm_message");if(!n)return;n.visible=!1}}))},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=H.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),this.uiGraph.set(s.id,u),"language_option_sprite"===s.type||"language_option_text"===s.type?this.languageOption.addChild(u):"confirmation_sprite"===s.type||"confirmation_text"===s.type?this.confirmation.addChild(u):this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.playBgmIfNeeded=function(){var t=S.Audio.Bgm.TitleBgm;if(!m.hasSound(t)){var e=y.game.loader.resources[t];m.createSound(t,e.buffer),m.playBgm(t,1.5)}},n.loadSaveDataFromDB=function(){var t=this;f.get("saveData",(function(e){e&&(t.hasSaveData=!0)}))},n.deleteSaveData=function(){f.delete("saveData")},i}($);function ui(t,e,i){return(ui="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ci(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function ci(t){return(ci=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function li(t,e){return!e||"object"!==pi(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hi(t,e){return(hi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pi=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function fi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ci(t);if(e){var o=ci(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return li(this,i)}}var di=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hi(t,e)}(i,t);var e=fi(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=e.call(this)).sceneName="start_scene",t.transitionIn=new b(1,0,-.02),t.transitionOut=new b(0,1,.02),t.interactive=!0,t.on("pointerdown",(function(){t.showTitleScene()})),t}var n=i.prototype;return n.createInitialResourceList=function(){var t=ui(ci(i.prototype),"createInitialResourceList",this).call(this);return t.push(S.Audio.Se.OptionTap),t},n.update=function(t){ui(ci(i.prototype),"update",this).call(this,t),this.elapsedFrameCount%40===0&&(this.startButton.visible=!this.startButton.visible)},n.onResourceLoaded=function(){ui(ci(i.prototype),"onResourceLoaded",this).call(this),this.addChild(this.uiGraphContainer);var t=this.uiGraph.get("start_button");t&&(this.startButton=t,this.initSound())},n.initSound=function(){var t=y.game.loader.resources,e=[S.Audio.Se.OptionTap],i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;m.createSound(a,t[a].buffer)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},n.showTitleScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,m.playSe(S.Audio.Se.OptionTap),y.loadScene(new ai))},i}($),mi=i(5933);var yi=(0,o.default)(),gi=(yi.serverRuntimeConfig,yi.publicRuntimeConfig),vi=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.startGame=function(){mi.load({custom:{families:[S.FontFamily.Default],urls:["".concat(gi.staticFolder,"/font.css")]},active:function(){t.initGame()},timeout:15e3})},t.initGame=function(){y.start({width:640,height:640,backgroundColor:0}),y.loadScene(new di)},t}(),bi=i(7294);function wi(){return(0,bi.useEffect)((function(){vi.startGame()})),(0,n.jsx)("div",{id:"play-game"})}}}]);