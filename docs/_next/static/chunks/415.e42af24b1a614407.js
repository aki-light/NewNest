(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[415],{415:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return On}});var i=n(5893),o=n(1752),r=(0,o.default)(),s=(r.serverRuntimeConfig,r.publicRuntimeConfig),a=Object.freeze({ResourceBaseUrl:"".concat(s.staticFolder,"/game_sources/escape_game_1/assets/")}),c=n(8866),u=n(3631);function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loop=!1,this.played=!1,this.paused=!1,this.offset=0,this.playedAt=0,this.volumeRate=void 0,m.sharedContext&&(this.buffer=e,this.gainNode=m.sharedContext.createGain())}var e,n,i,o=t.prototype;return o.play=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=this,o=m.sharedContext;o&&(this.loop=t,this.source=o.createBufferSource(),this.source.loop=this.loop,this.source.loopStart=0,this.source.loopEnd=this.buffer.duration,this.source.buffer=this.buffer,this.source.onended=function(){return i.stop()},n?(this.gainNode.gain.value=t?m.bgmVolume*n:m.seVolume*n,this.volumeRate=n):this.gainNode.gain.value=t?m.bgmVolume:m.seVolume,this.gainNode.connect(o.destination),this.source.connect(this.gainNode),this.source.start(0,e),this.played=!0,this.playedAt=o.currentTime-e,this.paused=!1)},o.stop=function(){if(this.source&&this.played){this.source.disconnect();try{this.source.buffer=null}catch(t){}this.source.onended=null,this.source=null,this.paused=!1}},o.pause=function(){!this.paused&&this.played&&this.source&&(this.offset=this.elapsedTime,this.stop(),this.paused=!0)},o.resume=function(){this.paused&&this.played&&(this.play(this.loop,this.offset,this.volumeRate),this.paused=!1)},o.isPosed=function(){return this.paused},e=t,(n=[{key:"volume",get:function(){return this.gainNode?this.gainNode.gain.value:-1},set:function(t){this.gainNode&&(this.gainNode.gain.value=t)}},{key:"elapsedTime",get:function(){if(this.paused)return this.offset;var t=m.sharedContext;if(!this.source||!t)return 0;var e=t.currentTime-this.playedAt;if(this.loop){var n=this.source.loopEnd-this.source.loopStart;if(e>n)return e%n}return e}}])&&l(e.prototype,n),i&&l(e,i),t}();var f=window.indexedDB||window.webkitIndexedDB,p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.init=function(e,n){if(!f)throw new Error("indexed db is not supported");var i=f.open(t.dbName,t.dbVersion);i.onupgradeneeded=function(e){t.upgradeDB(e)},i.onsuccess=function(e){var i=e.target.result;t.db=i,n()},i.onerror=function(t){return e(t)}},t.put=function(e,n,i,o){var r=t.getStoreObject();if(r){var s=t.createRecordObject(e,n),a=r.put(s);i&&(a.onsuccess=function(t){i(t)}),o&&(a.onerror=function(t){o(t)})}else o&&o()},t.get=function(e,n,i){var o=t.getStoreObject();if(o){var r=o.get(e);r.onsuccess=function(t){var e=t.target.result;e?n(e.value,e.key):n(void 0,void 0)},i&&(r.onerror=function(t){i(t)})}else i&&i()},t.delete=function(e,n,i){var o=t.getStoreObject();if(o){var r=o.delete(e);n&&(r.onsuccess=function(t){n(t)}),i&&(r.onerror=function(t){i(t)})}else i&&i()},t.clear=function(e,n){var i=t.getStoreObject();if(i){var o=i.clear();e&&(o.onsuccess=function(t){e(t)}),n&&(o.onerror=function(t){n(t)})}else n&&n()},t.upgradeDB=function(e){var n=e.target.result,i=t.storeIndex,o=t.storeName;n.createObjectStore(o,{keyPath:i}).createIndex(i,i,{unique:!0})},t.getStoreObject=function(){if(!t.db)return null;var e=t.storeName;return t.db.transaction(e,"readwrite").objectStore(e)},t.createRecordObject=function(t,e){return{key:t,value:e}},t}();function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}p.dbName="escape-game-db",p.dbVersion=1,p.storeName="escape-game-store",p.storeIndex="key",p.db=null;var m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,i;return t.init=function(e){if(e)t.context=e;else{var n=window.AudioContext||window.webkitAudioContext;t.context=new n}var i=(0,u.qY)();i&&(t.setSoundInitializeEvent(i),t.useWebAudio(),t.setWindowLifeCycleEvent(i))},t.update=function(e){if(t.sharedContext){var n=t.killingSounds;if(n.length>0){var i=[],o=!0,r=!1,s=void 0;try{for(var a,c=n[Symbol.iterator]();!(o=(a=c.next()).done);o=!0){var u=a.value;t.sharedContext.currentTime>=u.endAt?u.sound.stop():i.push(u)}}catch(l){r=!0,s=l}finally{try{o||null==c.return||c.return()}finally{if(r)throw s}}t.killingSounds=i}}},t.useWebAudio=function(){if(!t.webAudioInitialized){var e=t.supportedExtensions,n=!0,i=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var a=r.value,u=c.kCJ;u.setExtensionXhrType(a,u.XHR_RESPONSE_TYPE.BUFFER),u.setExtensionLoadType(a,u.LOAD_TYPE.XHR)}}catch(l){i=!0,o=l}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}y.game.loader.use(t.parsingMiddleware()),t.webAudioInitialized=!0}},t.parsingMiddleware=function(){return function(e,n){var i,o=t.supportedExtensions,r=e.url.split(".")[1];r&&-1!==o.indexOf(r)?null===(i=t.sharedContext)||void 0===i||i.decodeAudioData(e.data,(function(t){e.buffer=t,n()})):n()}},t.setSoundInitializeEvent=function(e){var n,i=void 0===document.ontouchend?"mousedown":"touched",o=e.version?e.version.split(".")[0]:"0";if("chrome"===e.name&&Number.parseInt(o,10)>=66)n=function(){t.sharedContext&&t.sharedContext.resume(),document.body.removeEventListener(i,n)};else{if("safari"!==e.name)return;n=function(){if(t.sharedContext){var e=t.sharedContext.createBufferSource();e.buffer=t.sharedContext.createBuffer(1,1,44100),e.connect(t.sharedContext.destination),e.start(0),e.disconnect()}document.body.removeEventListener(i,n)}}document.body.addEventListener(i,n)},t.setWindowLifeCycleEvent=function(e){"safari"===e.name?document.addEventListener("webkitvisibilitychange",(function(){document.webkitHidden?t.pauseBgm():t.resumeBgm()})):document.addEventListener("visibilitychange",(function(){document.hidden?t.pauseBgm():t.resumeBgm()}))},t.registerSound=function(e,n){t.managedSounds.set(e,n)},t.unregisterSound=function(e){t.managedSounds.delete(e)},t.getSound=function(e){return t.managedSounds.get(e)},t.createSound=function(e,n){var i=new h(n);return t.registerSound(e,i),i},t.hasSound=function(e){return t.managedSounds.has(e)},t.destroySound=function(e){var n=this.getSound(e);t.unregisterSound(e),null===n||void 0===n||n.stop()},t.pauseBgm=function(){t.paused||(t.paused=!0,t.managedSounds.forEach((function(t){t.pause()})))},t.resumeBgm=function(){t.sceneIsPaused||t.paused&&(t.paused=!1,t.managedSounds.forEach((function(t){t.resume()})))},t.fade=function(e,n,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.sharedContext){var r=t.sharedContext.currentTime+i;e.gainNode.gain.exponentialRampToValueAtTime(n,r),o&&t.killingSounds.push({sound:e,endAt:r})}},t.playBgm=function(e,n){var i=t.getSound(e);null===i||void 0===i||i.play(!0,0,n)},t.stopBgm=function(e){var n=t.getSound(e);null===n||void 0===n||n.stop()},t.playSe=function(e){var n=t.getSound(e);null===n||void 0===n||n.play()},t.setSoundVolume=function(e,n){t.managedSounds.forEach((function(t){t.loop?t.volume=e:t.volume=n}))},t.loadSoundOptionFromDB=function(){p.get("bgmVolume",(function(e){t.bgmVolume=0===e?0:e||.05})),p.get("seVolume",(function(e){t.seVolume=0===e?0:e||.5}))},e=t,i=[{key:"sharedContext",get:function(){return t.context}}],(n=null)&&d(e.prototype,n),i&&d(e,i),t}();m.supportedExtensions=["mp3"],m.webAudioInitialized=!1,m.context=null,m.paused=!1,m.killingSounds=[],m.managedSounds=new Map,m.sceneIsPaused=!1;var y=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.start=function(e){t.game=new c.MxU(e),p.init((function(t){throw new Error("indexed db could not be initialized")}),(function(){m.loadSoundOptionFromDB()})),m.init();var n=document.getElementById("play-game");n&&(n.appendChild(t.game.view),t.game.loader.baseUrl=a.ResourceBaseUrl,t.game.ticker.add((function(e){var n;null===(n=t.currentScene)||void 0===n||n.update(e),m.update(e)})),t.resizeCanvas(),window.addEventListener("resize",t.resizeCanvas))},t.transitionInIfPossible=function(e){var n;return!(!t.sceneResourceLoaded||!t.sceneTransitionOutFinished)&&(null===(n=t.currentScene)||void 0===n||n.destroy(),t.currentScene=e,t.game.stage.addChild(e),e.beginTransitionIn((function(){})),!0)},t.loadScene=function(e){t.currentScene?(t.sceneResourceLoaded=!1,t.sceneTransitionOutFinished=!1,e.beginLoadResource((function(){t.sceneResourceLoaded=!0,t.transitionInIfPossible(e)})),t.currentScene.beginTransitionOut((function(){t.sceneTransitionOutFinished=!0,t.transitionInIfPossible(e)}))):(t.sceneTransitionOutFinished=!0,e.beginLoadResource((function(){t.sceneResourceLoaded=!0,t.transitionInIfPossible(e)})))},t.resizeCanvas=function(){var e,n,i=t.game,o=i.renderer,r=o.width/o.height;window.innerWidth/window.innerHeight>r?(e=window.innerHeight*(o.width/o.height),n=window.innerHeight):(e=window.innerWidth,n=window.innerWidth*(o.height/o.width)),(e>=500||n>=500)&&(e=500,n=500),i.view.style.width="".concat(e-20,"px"),i.view.style.height="".concat(n-20,"px")},t}();y.sceneTransitionOutFinished=!0,y.sceneResourceLoaded=!1;var g=n(4051),v=n.n(g);var b=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=new c.W20,this.overlay=new c.TCu,this.transitionBegan=!1,this.transitionFinished=!1,this.onTransitionFinished=function(){},this.afterFinishedVisible=!1,this.alphaFrom=e,this.alphaTo=n,this.alphaProgress=i;var o=y.game.view.width,r=y.game.view.height;this.overlay.beginFill(0),this.overlay.moveTo(0,0),this.overlay.lineTo(o,0),this.overlay.lineTo(o,r),this.overlay.lineTo(0,r),this.overlay.endFill(),this.overlay.alpha=this.alphaFrom,this.container.addChild(this.overlay)}var e=t.prototype;return e.getContainer=function(){return this.container},e.begin=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.afterFinishedVisible=t,this.container.visible=!0,this.overlay.alpha=this.alphaFrom,this.transitionBegan=!0,this.transitionFinished=!1},e.isBegan=function(){return this.transitionBegan},e.isFinished=function(){return this.transitionFinished},e.isActive=function(){return this.isBegan()&&!this.isFinished()},e.update=function(t){this.alphaTo<=this.alphaFrom&&this.overlay.alpha<=this.alphaTo||this.alphaTo>=this.alphaFrom&&this.overlay.alpha>=this.alphaTo?(this.afterFinishedVisible||(this.container.visible=!1),this.transitionBegan=!1,this.onTransitionFinished(),this.transitionFinished=!0):this.overlay.alpha+=this.alphaProgress},e.setCallback=function(t){this.onTransitionFinished=t},t}(),w=Object.freeze({NOTHING:0,CAR_KEY:1,DESK_KEY:2,BANANA:3,PENCIL:4,NAIL:5,SALT:6,TIN_STATUE:7,COIN:8,CROSSBOW:9,DETERGENT:10,HAND_MIRROR:11,DVD:12,FROZEN_BANANA:13,SHARPENED_PENCIL:14}),O=Object.freeze({NormalFloor:0,NormalWall:1,TileWithShadow:2}),S=Object.freeze({UI:{SceneUiGraph:function(t){return"ui_graph/".concat(t,".json")},EscapeSceneMessage:"ui_graph/escape_scene_message.json",EscapeSceneEnglishMessage:"ui_graph/escape_scene_message_english.json",EscapeSceneOption:"ui_graph/escape_scene_option.json",EscapeSceneEnglishOption:"ui_graph/escape_scene_option_english.json",EscapeSceneRoomObject:"ui_graph/escape_scene_room_object.json",Stage:"master/stage_master.json",PlayerAnimation:"master/player_animation_master.json",RoomObjectMaster:"master/room_object_master.json",Player:"player/player.json",TileFrame:"stage/tile_frame.png",Tiles:["stage/floor.png","stage/wall.png","stage/floor_with_shadow.png"],Items:["items/tin_statue.png","items/coin.png","items/banana.png","items/frozen_banana.png","items/salt.png","items/desk_key.png","items/pencil.png","items/sharpened_pencil.png","items/hand_mirror.png","items/detergent.png","items/car_key.png","items/crossbow.png","items/nail.png","items/dvd.png"],RoomObjects:["room_object/mirror.png","room_object/chair.png","room_object/pig2.png","room_object/clock_12_00.png"],MessageWindow:"ui/message_window.png",OptionFrame:"ui/option_frame.png",ItemSelectFrame:"ui/item_select_frame.png",ItemPanelFrame:"ui/item_panel_frame.png",MenuBar:"ui/menu_bar.png",MenuButton:"ui/menu_button.png"},Dynamic:{items:function(t){switch(t){case w.NOTHING:return"items/no_item.png";case w.TIN_STATUE:return"items/tin_statue.png";case w.COIN:return"items/coin.png";case w.BANANA:return"items/banana.png";case w.FROZEN_BANANA:return"items/frozen_banana.png";case w.SALT:return"items/salt.png";case w.PENCIL:return"items/pencil.png";case w.SHARPENED_PENCIL:return"items/sharpened_pencil.png";case w.NAIL:return"items/nail.png";case w.HAND_MIRROR:return"items/hand_mirror.png";case w.DVD:return"items/dvd.png";case w.DETERGENT:return"items/detergent.png";case w.DESK_KEY:return"items/desk_key.png";case w.CROSSBOW:return"items/crossbow.png";case w.CAR_KEY:return"items/car_key.png";default:return""}},tiles:function(t){switch(t){case O.NormalFloor:return"stage/floor.png";case O.NormalWall:return"stage/wall.png";case O.TileWithShadow:return"stage/floor_with_shadow.png";default:return""}}},AnimationTypes:{Player:Object.freeze({WAIT:"wait",WALKUP:"walk_up",WALKDOWN:"walk_down",WALKLEFT:"walk_left",WALKRIGHT:"walk_right",CHACKUP:"chack_up",CHACKDOWN:"chack_down",CHACKLEFT:"chack_left",CHACKRIGHT:"chack_right"})},SoundOptionIds:["sound_option_frame","bgm_volume","se_volume","bgm","se","bgm_volume_up","bgm_volume_down","se_volume_up","se_volume_down"],PinPadIds:["pin_pad","code_first","code_second","code_third","pad_cancel","pad_enter","pad_0","pad_1","pad_2","pad_3","pad_4","pad_5","pad_6","pad_7","pad_8","pad_9"],MenuOptionIds:["item_bag","return","sound_volume"],RoomObjects:{TV:"tv",DESK:"desk",DOOR:"door",BED:"bed",GAS_STOVE:"gas_stove",VENDING_MACHINE:"vending_machine",FREEZER:"freezer",CABINET:"cabinet",BARREL:"barrel",GRINDER:"grinder",CAR:"car",BALLOON:"balloon",MIRROR:"mirror",CHAIR:"chair",CLOCK:"clock",PIG:"pig",CLOSET:"closet",SAFE:"safe",BOOK_SHELF:"book_shelf"},MessageIds:{NothingSpecial:"nothing_special",BackToTitle:"back_to_title",ContinueGame:"continue_game"},Audio:{Bgm:{EscapeBGM:"audio/escape_bgm.mp3",EndingBGM:"audio/ending_bgm.mp3",TitleBgm:"audio/title_bgm.mp3"},Se:{ShowNextText:"audio/show_next_text.mp3",OptionTap:"audio/option_tap.mp3",TileTap:"audio/tile_tap.mp3"}},FontFamily:{Default:"MPLUS1p-Regular"}});function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function T(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var E=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e=t.prototype;return e.createUiNode=function(t){return new c.W20},e.createUiNodeByGraphElement=function(t){var e=this.createUiNode(t.params);return e&&(e.name=t.id,e.position.set(t.position[0],t.position[1]),t.invisible&&(e.visible=!1),t.interactive&&(e.interactive=!0)),e},e.attachUiEventByGraphElement=function(t,e,n){var i=!0,o=!1,r=void 0;try{for(var s,a=function(t,i){var o,r=i.value,s=n[r.callback];if(!s)return"continue";e.on(r.type,(function(){return(o=s).call.apply(o,[n].concat(T(r.arguments)))}))},c=t[Symbol.iterator]();!(i=(s=c.next()).done);i=!0)a(0,s)}catch(u){o=!0,r=u}finally{try{i||null==c.return||c.return()}finally{if(o)throw r}}},t}();function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function I(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function x(t,e){return!e||"object"!==A(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function P(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return R(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var A=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function B(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=j(t);if(e){var o=j(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return x(this,n)}}var D=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(n,t);var e=B(n);function n(){return I(this,n),e.apply(this,arguments)}return n.prototype.createUiNode=function(t){var e={};t&&(void 0!==t.family&&(e.fontFamily=t.family),void 0!==t.size&&(e.fontSize=t.size),void 0!==t.color&&(e.fill=t.color),void 0!==t.padding&&(e.padding=t.padding),void 0!==t.wordWrap&&(e.wordWrap=t.wordWrap),void 0!==t.wordWrapWidth&&(e.wordWrapWidth=t.wordWrapWidth));var n,i=new c.pn8(e),o=new c.xvT(t&&t.text?t.text:"",i);t&&void 0!==t.anchor&&(n=o.anchor).set.apply(n,P(t.anchor));return o},n}(E);function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function k(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){return!e||"object"!==L(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function G(t,e){return(G=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function W(t){return function(t){if(Array.isArray(t))return N(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return N(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var L=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function F(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=U(t);if(e){var o=U(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return M(this,n)}}var H=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&G(t,e)}(n,t);var e=F(n);function n(){return k(this,n),e.apply(this,arguments)}return n.prototype.createUiNode=function(t){var e=new c.jyi;if(t){var n,i,o=t.textureName;if(o&&c.P6Y.kN[o]&&(e.texture=c.P6Y.kN[o]),t.anchor)(n=e.anchor).set.apply(n,W(t.anchor));if(t.scale)(i=e.scale).set.apply(i,W(t.scale))}return e},n}(E);var V=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.getFactory=function(e){if(!t.cashedFactory[e]){var n;switch(e){case"text":case"message":case"language_option_text":case"confirmation_text":case"credit_text":case"menu_text":n=D;break;case"language_option_sprite":case"confirmation_sprite":case"sprite":n=H}if(!n)return null;t.cashedFactory[e]=new n}return t.cashedFactory[e]},t}();function z(t,e,n,i,o,r,s){try{var a=t[r](s),c=a.value}catch(u){return void n(u)}a.done?e(c):Promise.resolve(c).then(i,o)}function K(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y(t){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function q(t,e){return!e||"object"!==X(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function J(t,e){return(J=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}V.cashedFactory={};var X=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Z(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Y(t);if(e){var o=Y(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return q(this,n)}}var $=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&J(t,e)}(n,t);var e=Z(n);function n(){var t;return K(this,n),(t=e.apply(this,arguments)).transitionIn=new b(1,0,-.02),t.transitionOut=new b(0,1,.02),t.objectsToUpdate=[],t.elapsedFrameCount=0,t.uiGraphContainer=new c.W20,t.uiGraph=new Map,t.isOver=!1,t}var i=n.prototype;return i.update=function(t){this.elapsedFrameCount++,this.updateRegisteredObjects(t),this.transitionIn.isActive()?this.transitionIn.update(t):this.transitionOut.isActive()&&this.transitionOut.update(t)},i.registerUpdatingObject=function(t){this.objectsToUpdate.push(t)},i.updateRegisteredObjects=function(t){var e=[],n=!0,i=!1,o=void 0;try{for(var r,s=this.objectsToUpdate[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var a=r.value;a&&!a.isDestroyed()&&(a.update(t),e.push(a))}}catch(c){i=!0,o=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}this.objectsToUpdate=e},i.beginTransitionIn=function(t,e){this.transitionIn.setCallback((function(){return t()}));var n=this.transitionIn.getContainer();n&&this.addChild(n),this.transitionIn.begin(e)},i.beginTransitionOut=function(t,e){this.transitionOut.setCallback((function(){return t()}));var n=this.transitionOut.getContainer();n&&this.addChild(n),this.transitionOut.begin(e)},i.createInitialResourceList=function(){return[]},i.beginLoadResource=function(t){var e,n=this;return(e=v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(t){n.loadInitialResource((function(){return t(null)}))}));case 2:return e.next=4,new Promise((function(t){var e=n.onInitialResourceLoaded();n.loadAdditionalResource(e,(function(){return t(null)}))}));case 4:n.onResourceLoaded(),t();case 6:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(i,o){var r=e.apply(t,n);function s(t){z(r,i,o,s,a,"next",t)}function a(t){z(r,i,o,s,a,"throw",t)}s(void 0)}))})()},i.loadInitialResource=function(t){var e=this.createInitialResourceList(),n=S.UI.SceneUiGraph(this.sceneName);e.push(n);var i=this.filterLoadedAssets(e);i.length>0?y.game.loader.add(i).load(t):t()},i.onInitialResourceLoaded=function(){var t=[],e=S.UI.SceneUiGraph(this.sceneName),n=y.game.loader.resources[e],i=!0,o=!1,r=void 0;try{for(var s,a=n.data.nodes[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var c=s.value;"sprite"!==c.type&&"sprite_option"!==c.type&&"room_object"!==c.type&&"item_panel"!==c.type&&"language_option_sprite"!==c.type&&"confirmation_sprite"!==c.type||t.push({name:c.params.textureName,url:c.params.url})}}catch(u){o=!0,r=u}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return t},i.loadAdditionalResource=function(t,e){y.game.loader.add(this.filterLoadedAssets(t)).load(e)},i.onResourceLoaded=function(){var t=S.UI.SceneUiGraph(this.sceneName),e=y.game.loader.resources[t].data;this.prepareUiGraphContainer(e)},i.filterLoadedAssets=function(t){var e=new Map,n=!0,i=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var a=r.value;"string"===typeof a?y.game.loader.resources[a]||e.has(a)||e.set(a,{name:a,url:a}):y.game.loader.resources[a.name]||e.has(a.name)||e.set(a.name,a)}}catch(c){i=!0,o=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return Array.from(e.values())},i.prepareUiGraphContainer=function(t){var e=!0,n=!1,i=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=V.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var c=a.createUiNodeByGraphElement(s);c&&(s.events&&a.attachUiEventByGraphElement(s.events,c,this),this.uiGraph.set(s.id,c),this.uiGraphContainer.addChild(c))}}}catch(u){n=!0,i=u}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}},i.getCustomUiGraphFactory=function(t){return null},i.destroySound=function(){var t=y.game.loader.resources,e=Object.keys(t),n=!0,i=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var a=r.value;t[a].buffer&&m.destroySound(a)}}catch(c){i=!0,o=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}},n}(c.W20);function Q(t,e,n){return(Q="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tt(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){return!e||"object"!==it(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function nt(t,e){return(nt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var it=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ot(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=tt(t);if(e){var o=tt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return et(this,n)}}var rt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&nt(t,e)}(n,t);var e=ot(n);function n(t){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(i=e.call(this)).sceneName="option_scene",i.language=t,i.transitionIn=new b(1,0,-.02),i.transitionOut=new b(0,1,.02),i}var i=n.prototype;return i.onResourceLoaded=function(){Q(tt(n.prototype),"onResourceLoaded",this).call(this),this.initVolumeGraph(),this.initLanguageButton(),this.addChild(this.uiGraphContainer)},i.initLanguageButton=function(){var t=this.uiGraph.get("japanese"),e=this.uiGraph.get("japanese_2"),n=this.uiGraph.get("english"),i=this.uiGraph.get("english_2");t&&e&&n&&i&&("japanese"===this.language?(t.visible=!0,e.visible=!1,n.visible=!1,i.visible=!0):(t.visible=!1,e.visible=!0,n.visible=!0,i.visible=!1))},i.onLanguageSelected=function(t){m.playSe(S.Audio.Se.OptionTap);var e=this.uiGraph.get("japanese"),n=this.uiGraph.get("japanese_2"),i=this.uiGraph.get("english"),o=this.uiGraph.get("english_2");e&&n&&i&&o&&("japanese"===t?(e.visible=!0,n.visible=!1,i.visible=!1,o.visible=!0):(e.visible=!1,n.visible=!0,i.visible=!0,o.visible=!1),this.saveLanguageToDB(t))},i.initVolumeGraph=function(){for(var t=m.bgmVolume,e=m.seVolume,n=Math.round(100*t)+1,i=Math.round(10*e)+1;n<=10;n++){var o="bgm_volume_".concat(n);this.uiGraph.get(o).visible=!1}for(;i<=10;i++){var r="se_volume_".concat(i);this.uiGraph.get(r).visible=!1}},i.showTitleScene=function(){this.transitionIn.isActive()||this.transitionOut.isActive()||(m.playSe(S.Audio.Se.OptionTap),y.loadScene(new cn))},i.onBgmArrowDown=function(t){var e=m.bgmVolume;if(t<0){if(0===e)return;var n="bgm_volume_".concat(Math.round(100*e));this.uiGraph.get(n).visible=!1}else{if(.1===e)return;var i="bgm_volume_".concat(Math.round(100*e+1));this.uiGraph.get(i).visible=!0}(e+=t)<.001?e=0:e>.0999&&(e=.1),m.bgmVolume=e,m.playSe(S.Audio.Se.OptionTap),this.saveBgmVolumeToDB(m.bgmVolume),m.setSoundVolume(m.bgmVolume,m.seVolume)},i.onSeArrowDown=function(t){var e=m.seVolume;if(t<0){if(0===e)return;var n="se_volume_".concat(Math.round(10*e));this.uiGraph.get(n).visible=!1}else{if(1===e)return;var i="se_volume_".concat(Math.round(10*e+1));this.uiGraph.get(i).visible=!0}(e+=t)<.001?e=0:e>.999&&(e=1),m.seVolume=e,m.playSe(S.Audio.Se.OptionTap),this.saveSeVolumeToDB(m.seVolume)},i.saveLanguageToDB=function(t){p.put("language",t)},i.saveBgmVolumeToDB=function(t){p.put("bgmVolume",t)},i.saveSeVolumeToDB=function(t){p.put("seVolume",t)},n}($);function st(t,e,n){return(st="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=at(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function at(t){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ct(t,e){return!e||"object"!==lt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ut(t,e){return(ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var lt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ht(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=at(t);if(e){var o=at(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return ct(this,n)}}var ft=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ut(t,e)}(n,t);var e=ht(n);function n(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(t=e.call(this)).creditContainer=new c.W20,t.currentPage=0,t.currentPageNumber=1,t.sceneName="credit_scene",t.transitionIn=new b(1,0,-.02),t.transitionOut=new b(0,1,.02),t}var i=n.prototype;return i.onResourceLoaded=function(){st(at(n.prototype),"onResourceLoaded",this).call(this),this.addChild(this.uiGraphContainer),this.addChild(this.creditContainer)},i.changePage=function(t){m.playSe(S.Audio.Se.OptionTap),t<0?this.currentPageNumber+=1:this.currentPageNumber-=1,this.currentPage=this.currentPage+t,this.currentPage<-6?(this.currentPage=0,this.currentPageNumber=1):this.currentPage>0&&(this.currentPage=-6,this.currentPageNumber=7),this.creditContainer.position.x=640*this.currentPage;var e=this.uiGraph.get("page_number");e&&(e.text=this.currentPageNumber.toString())},i.showTitleScene=function(){this.transitionIn.isActive()||this.transitionOut.isActive()||(m.playSe(S.Audio.Se.OptionTap),y.loadScene(new cn))},i.prepareUiGraphContainer=function(t){var e=!0,n=!1,i=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=V.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var c=a.createUiNodeByGraphElement(s);c&&(s.events&&a.attachUiEventByGraphElement(s.events,c,this),this.uiGraph.set(s.id,c),"credit_text"===s.type?this.creditContainer.addChild(c):this.uiGraphContainer.addChild(c))}}}catch(u){n=!0,i=u}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}},n}($);var pt=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state=0,this.walkDirection=null,this.walkSpeed=4,this.walkCount=0,this.distanceRow=0,this.distanceColumn=0,this.checkingObject=null,this.items=[],this.positionRow=e,this.positionColumn=n},dt=Object.freeze({NONE:0,OBJECT:1,GOAL:2}),mt=Object.freeze({UP:0,LEFT:1,DOWN:2,RIGHT:3});var yt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.init=function(e){t.map=e,t.states=[],t.policy.clear(),t.direction.clear();for(var n=0;n<e.length;n++)for(var i=0;i<e[0].length;i++)t.states.push([n,i]);var o=!0,r=!1,s=void 0;try{for(var a,c=t.states[Symbol.iterator]();!(o=(a=c.next()).done);o=!0){var u=a.value;t.value.set(u,0);var l=!0,h=!1,f=void 0;try{for(var p,d=t.actions[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var m=p.value;t.policy.set([u,m],0)}}catch(y){h=!0,f=y}finally{try{l||null==d.return||d.return()}finally{if(h)throw f}}}}catch(y){r=!0,s=y}finally{try{o||null==c.return||c.return()}finally{if(r)throw s}}t.direction.set(t.actions[0],mt.UP),t.direction.set(t.actions[1],mt.LEFT),t.direction.set(t.actions[2],mt.DOWN),t.direction.set(t.actions[3],mt.RIGHT)},t.move=function(e,n){if(e[0]===t.goal[0]&&e[1]===t.goal[1])return[0,e];var i=[e[0]+n[0],e[1]+n[1]];return i[0]<0||i[1]<0||i[0]>=t.map.length||i[1]>=t.map[0].length||t.map[i[0]][i[1]]===dt.OBJECT?[-1,e]:[-1,i]},t.policyUpdate=function(e){var n,i=-Math.pow(10,10),o=!0,r=!1,s=void 0;try{for(var a,c=t.actions[Symbol.iterator]();!(o=(a=c.next()).done);o=!0){var u=a.value,l=t.move(e,u),h=0,f=!0,p=!1,d=void 0;try{for(var m,y=t.states[Symbol.iterator]();!(f=(m=y.next()).done);f=!0){var g=m.value;g[0]===l[1][0]&&g[1]===l[1][1]&&(h=l[0]+t.value.get(g))}}catch(v){p=!0,d=v}finally{try{f||null==y.return||y.return()}finally{if(p)throw d}}h>i&&(i=h,n=u)}}catch(v){r=!0,s=v}finally{try{o||null==c.return||c.return()}finally{if(r)throw s}}return t.policy.forEach((function(i,o){o[0][0]===e[0]&&o[0][1]===e[1]&&o[1][0]===n[0]&&o[1][1]===n[1]?t.policy.set(o,1):o[0][0]===e[0]&&o[0][1]===e[1]&&t.policy.set(o,0)})),i},t.valueIteration=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.01,n=0;;){var i=0,o=!0,r=!1,s=void 0;try{for(var a,c=t.states[Symbol.iterator]();!(o=(a=c.next()).done);o=!0){var u=a.value;if(1!==t.map[u[0]][u[1]]){var l=t.policyUpdate(u);i=Math.max(i,Math.abs(t.value.get(u)-l)),t.value.set(u,l)}}}catch(h){r=!0,s=h}finally{try{o||null==c.return||c.return()}finally{if(r)throw s}}if(++n>=t.maxIterate)break;if(i<e)break}},t.createBestPolicy=function(){t.policy.forEach((function(e,n){if(1===e){var i=t.direction.get(n[1]);t.bestPolicy.set(n[0],i)}}))},t.getRoutePlan=function(e,n){t.goal=n,t.valueIteration(),t.createBestPolicy();for(var i=[],o=e,r=!1,s=0;!r;){if(++s>=t.maxIterate)return[];var a=!0,c=!1,u=void 0;try{for(var l,h=t.states[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var f=l.value;if(f[0]===o[0]&&f[1]===o[1]){var p=t.bestPolicy.get(f);switch(p){case 0:o[0]=o[0]-1;break;case 1:o[1]=o[1]-1;break;case 2:o[0]=o[0]+1;break;case 3:o[1]=o[1]+1}o[0]===n[0]&&o[1]===n[1]&&(r=!0),i.push(p);break}}}catch(d){c=!0,u=d}finally{try{a||null==h.return||h.return()}finally{if(c)throw u}}}return i},t}();yt.states=[],yt.actions=[[-1,0],[0,-1],[1,0],[0,1]],yt.policy=new Map,yt.bestPolicy=new Map,yt.value=new Map,yt.direction=new Map,yt.maxIterate=100;var gt=Object.freeze({IDLE:0,WALK:1,CHECKING:2});var vt=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.states=[],this.id=e},bt=Object.freeze({CheckedUnderBed:0,UsedKey:1,HasNoPencil:2,CheckedUnderPillow:3,CheckedInCloset:4,JumpedOnBed:5,CheckedOnCloset:6,GotCarKey:7,Washed:8,HasNoDVD:9}),wt=Object.freeze({DoNoting:1,BackToTitle:6,ShowItems:7,ShowBackToTitle:8,ShowSoundVolume:9,ShowItemOption:10,JumpOnBed:11,CheckUnderBed:12,CheckUnderPillow:13,UseTinStatue:14,UseCoin:15,UseBanana:16,UseCarKey:17,UseNail:18,UseFrozenBanana:19,UseSalt:20,UseCrossBow:21,UseDetergent:22,UseHandMirror:23,UseDVD:24,UsePencil:25,GetSalt:26,UseDeskKey:27,CheckLeftDrawer:28,CheckRightDrawer:29,GetPenCil:30,UseShapenedPencil:31,CheckInCloset:32,CheckOnCloset:33,ShowPinPad:34,GetCrossbow:35,SetTime:36,Escape:37,MovePig:38,GetDVD:39,ReadHint:40,ReadHint1:41,ReadHint2:42});var Ot=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.walkRequests=[],this.roomObjectEntities=new Map}var e=t.prototype;return e.init=function(t){this.delegator=t.delegator,this.stageMaster=t.stageMaster,this.saveData=t.saveData,this.saveData.mapData?yt.init(this.saveData.mapData):yt.init(this.stageMaster.mapData),this.tileSize=this.stageMaster.tileSize,0!==this.saveData.roomObjectState.length?this.setRoomObjectEntities(this.saveData.roomObjectState):this.setRoomObjectEntities(t.roomObjectMaster),this.playerEntity=new pt(4,7),0!==this.saveData.playerItems.length&&(this.playerEntity.items=this.saveData.playerItems),this.delegator.onPlayerSpawned(this.playerEntity)},e.update=function(){this.updatePlayerDistance(),this.updatePlayerState()},e.updatePlayerState=function(){this.playerEntity.state===gt.WALK&&this.updateWalkState(),this.playerEntity.state===gt.IDLE&&this.updateIdleState(),this.playerEntity.state===gt.CHECKING&&this.updateChackingState()},e.updateIdleState=function(){0!==this.walkRequests.length&&(this.playerEntity.state=gt.WALK,this.delegator.onPlayerEntityStateChanged(this.playerEntity)),this.playerEntity.checkingObject&&(this.playerEntity.state=gt.CHECKING,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updateWalkState=function(){0===this.walkRequests.length&&this.playerEntity.walkCount*this.playerEntity.walkSpeed%this.tileSize===0&&(this.playerEntity.walkCount=0,this.playerEntity.state=gt.IDLE,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updateChackingState=function(){this.playerEntity.checkingObject||(this.playerEntity.state=gt.IDLE,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updatePlayerDistance=function(){if(this.playerEntity.state===gt.WALK){if(this.playerEntity.walkCount*this.playerEntity.walkSpeed%this.tileSize===0)switch(this.walkRequests.shift()){case mt.UP:this.playerEntity.walkDirection=mt.UP,this.playerEntity.positionRow+=-1;break;case mt.DOWN:this.playerEntity.walkDirection=mt.DOWN,this.playerEntity.positionRow+=1;break;case mt.LEFT:this.playerEntity.walkDirection=mt.LEFT,this.playerEntity.positionColumn+=-1;break;case mt.RIGHT:this.playerEntity.walkDirection=mt.RIGHT,this.playerEntity.positionColumn+=1}switch(this.playerEntity.walkDirection){case mt.UP:this.playerEntity.distanceRow-=this.playerEntity.walkSpeed;break;case mt.DOWN:this.playerEntity.distanceRow+=this.playerEntity.walkSpeed;break;case mt.LEFT:this.playerEntity.distanceColumn-=this.playerEntity.walkSpeed;break;case mt.RIGHT:this.playerEntity.distanceColumn+=this.playerEntity.walkSpeed}this.playerEntity.walkCount++,this.delegator.onPlayerEntityWalked(this.playerEntity)}},e.onRoomObjectTapped=function(t){this.playerEntity.checkingObject=t},e.onOptionSelected=function(t){if(this.playerEntity.checkingObject){var e=this.roomObjectEntities.get(this.playerEntity.checkingObject);if(e){if(t===wt.UseHandMirror&&this.delegator.onItemUsed(t,e),t===wt.UseShapenedPencil&&this.delegator.onItemUsed(t,e),t===wt.UseNail&&this.delegator.onItemUsed(t,e),t===wt.UseDVD&&this.delegator.onItemUsed(t,e),t===wt.CheckRightDrawer&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.CheckLeftDrawer&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.MovePig&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.ReadHint&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.ReadHint1&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.ReadHint2&&this.delegator.onRoomObjectOptionSelected(e,t),t===wt.Escape&&this.delegator.onGameOver(),t===wt.CheckUnderBed&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(bt.CheckedUnderBed)&&(this.playerEntity.items.push(w.TIN_STATUE),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.CheckedUnderBed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===wt.CheckUnderPillow&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(bt.CheckedUnderPillow)&&(this.playerEntity.items.push(w.HAND_MIRROR),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.CheckedUnderPillow),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===wt.JumpOnBed&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(bt.JumpedOnBed)&&(e.states.push(bt.JumpedOnBed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===wt.CheckInCloset&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(bt.CheckedInCloset)&&(this.playerEntity.items.push(w.DETERGENT),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.CheckedInCloset),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===wt.CheckOnCloset&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(bt.CheckedOnCloset))){this.playerEntity.items.push(w.CAR_KEY),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.CheckedOnCloset),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB();var n=this.roomObjectEntities.get(S.RoomObjects.BED);null===n||void 0===n||n.states.push(bt.GotCarKey),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()}if(t===wt.UseDetergent){if(this.playerEntity.checkingObject===S.RoomObjects.MIRROR){var i=this.playerEntity.items.indexOf(w.DETERGENT);this.playerEntity.items.splice(i,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.Washed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()}this.delegator.onItemUsed(t,e)}if(t===wt.UseFrozenBanana)if(this.playerEntity.checkingObject===S.RoomObjects.CHAIR&&-1!==this.playerEntity.items.indexOf(w.NAIL)){this.delegator.onItemUsed(t,e,this.playerEntity.items);var o=this.playerEntity.items.indexOf(w.FROZEN_BANANA);this.playerEntity.items.splice(o,1);var r=this.playerEntity.items.indexOf(w.NAIL);this.playerEntity.items.splice(r,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}else this.delegator.onItemUsed(t,e,this.playerEntity.items);if(t===wt.UseTinStatue){if(this.playerEntity.checkingObject===S.RoomObjects.GAS_STOVE){var s=this.playerEntity.items.indexOf(w.TIN_STATUE);this.playerEntity.items.splice(s,1),this.playerEntity.items.push(w.COIN),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UseCoin){if(this.playerEntity.checkingObject===S.RoomObjects.VENDING_MACHINE){var a=this.playerEntity.items.indexOf(w.COIN);this.playerEntity.items.splice(a,1),this.playerEntity.items.push(w.BANANA),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UseBanana){if(this.playerEntity.checkingObject===S.RoomObjects.FREEZER){var c=this.playerEntity.items.indexOf(w.BANANA);this.playerEntity.items.splice(c,1),this.playerEntity.items.push(w.FROZEN_BANANA),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UseSalt){if(this.playerEntity.checkingObject===S.RoomObjects.BARREL){var u=this.playerEntity.items.indexOf(w.SALT);this.playerEntity.items.splice(u,1),this.playerEntity.items.push(w.DESK_KEY),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UseDeskKey){if(this.playerEntity.checkingObject===S.RoomObjects.DESK){var l=this.playerEntity.items.indexOf(w.DESK_KEY);this.playerEntity.items.splice(l,1),e.states.push(bt.UsedKey),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB(),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UsePencil){if(this.playerEntity.checkingObject===S.RoomObjects.GRINDER){var h=this.playerEntity.items.indexOf(w.PENCIL);this.playerEntity.items.splice(h,1),this.playerEntity.items.push(w.SHARPENED_PENCIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===wt.UseCrossBow)if(this.playerEntity.checkingObject===S.RoomObjects.BALLOON&&-1!==this.playerEntity.items.indexOf(w.SHARPENED_PENCIL)){this.delegator.onItemUsed(t,e,this.playerEntity.items);var f=this.playerEntity.items.indexOf(w.SHARPENED_PENCIL);this.playerEntity.items.splice(f,1);var p=this.playerEntity.items.indexOf(w.CROSSBOW);this.playerEntity.items.splice(p,1),this.playerEntity.items.push(w.NAIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}else this.delegator.onItemUsed(t,e,this.playerEntity.items);if(t===wt.UseCarKey){if(this.playerEntity.checkingObject===S.RoomObjects.CAR){var d=this.playerEntity.items.indexOf(w.CAR_KEY);this.playerEntity.items.splice(d,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items),yt.init(this.stageMaster.carMovedMapData),this.playerEntity.positionRow=7,this.playerEntity.positionColumn=7,this.playerEntity.distanceRow=192,this.playerEntity.distanceColumn=0}this.delegator.onItemUsed(t,e)}t===wt.GetSalt&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(w.SALT),this.delegator.onPlayerItemsChanged(this.playerEntity.items)),t===wt.GetCrossbow&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(w.CROSSBOW),this.delegator.onPlayerItemsChanged(this.playerEntity.items)),t===wt.GetPenCil&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(w.PENCIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.HasNoPencil),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()),t===wt.GetDVD&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(w.DVD),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(bt.HasNoDVD),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()),t===wt.SetTime&&(yt.init(this.stageMaster.pigMovedMapData),this.delegator.onRoomObjectOptionSelected(e,t))}}},e.onChackingEnd=function(){this.playerEntity.checkingObject=null},e.setRoomObjectEntities=function(t){var e=!0,n=!1,i=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=new vt(s.id);a.states=s.states.concat(),this.roomObjectEntities.set(s.id,a)}}catch(c){n=!0,i=c}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}},e.requestWalk=function(t){this.walkRequests=yt.getRoutePlan([this.playerEntity.positionRow,this.playerEntity.positionColumn],t)},e.changeRoomObjectEntitiesIntoArray=function(){var t=[];return this.roomObjectEntities.forEach((function(e,n){var i={id:n,states:e.states};t.push(i)})),t},e.saveProgressToDB=function(){p.put("saveData",this.saveData)},t}(),St=Object.freeze({LOADING_RESOURCES:1,RESOURCE_LOADED:2,READY:3,INGAME:4,FINISHED:5});var _t=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elapsedFrameCount=0,this.destroyed=!1,this.animationFrameId=0,this.requestedAnimationType=null,this.sprite=new c.jyi;var o=c.P6Y.kN[e.types.wait.frames[0]];this.sprite.texture=o,this.reSizeSprite(n);var r=n-this.sprite.width,s=n-this.sprite.height;this.sprite.position.set(i.x+r/2,i.y+s/2),this.spawnedPosition=new c.E9j(this.sprite.position.x,this.sprite.position.y),this.animationMaster=e,this.animationType=S.AnimationTypes.Player.WAIT}var e=t.prototype;return e.isDestroyed=function(){return this.destroyed},e.update=function(t){this.requestedAnimationType&&this.requestedAnimationType!==this.animationType&&(this.animationType=this.requestedAnimationType,this.resetAnimation()),this.updateAnimation()},e.requestAnimation=function(t){this.requestedAnimationType=t},e.resetAnimation=function(){this.requestedAnimationType=null,this.elapsedFrameCount=0,this.animationFrameId=0},e.updateAnimation=function(){var t=this.animationType,e=this.animationMaster.types[t];if(e){if(this.elapsedFrameCount%e.updateDuration===0){this.isAnimationLastFrameTime()&&this.resetAnimation();var n=e.frames[this.animationFrameId];this.sprite.texture=c.P6Y.kN[n],this.animationFrameId++}this.elapsedFrameCount++}},e.isAnimationLastFrameTime=function(){var t=this.animationType,e=this.animationMaster.types[t];if(!e)return!1;var n=e.updateDuration*e.frames.length;return this.elapsedFrameCount===n},e.destroy=function(){this.sprite.destroy(),this.destroyed=!0},e.reSizeSprite=function(t){t/t>this.sprite.width/this.sprite.height?(this.sprite.scale.x=t/this.sprite.width*(this.sprite.width/this.sprite.height),this.sprite.scale.y=t/this.sprite.height):(this.sprite.scale.x=t/this.sprite.width,this.sprite.scale.y=t/this.sprite.height*(this.sprite.height/this.sprite.width))},t}();function Tt(t){return(Tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Et(t,e){return!e||"object"!==It(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rt(t,e){return(Rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var It=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function jt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Tt(t);if(e){var o=Tt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Et(this,n)}}var xt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rt(t,e)}(n,t);var e=jt(n);function n(t,i,o){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(r=e.call(this)).isActive=!1,r.touchable=!1,r.tilePosition=i,r.tileSprite=new c.jyi,r.tileFrameSprite=new c.jyi;var s=y.game.loader.resources[S.Dynamic.tiles(t)].texture,a=y.game.loader.resources[S.UI.TileFrame].texture;return s&&(r.tileSprite.texture=s),r.tileSprite.scale.set(o/r.tileSprite.width,o/r.tileSprite.height),a&&(r.tileFrameSprite.texture=a),r.tileFrameSprite.scale.set(o/r.tileFrameSprite.width,o/r.tileFrameSprite.height),r.tileFrameSprite.visible=!1,r.addChild(r.tileSprite),r.addChild(r.tileFrameSprite),r}return n.prototype.toggleFrame=function(){this.touchable&&(m.playSe(S.Audio.Se.TileTap),this.isActive=!this.isActive,this.tileFrameSprite.visible=!this.tileFrameSprite.visible)},n}(c.W20);function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function At(t,e){return!e||"object"!==Nt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bt(t,e){return(Bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Dt(t){return function(t){if(Array.isArray(t))return Ct(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return Ct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ct(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Nt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function kt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Pt(t);if(e){var o=Pt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return At(this,n)}}var Ut=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bt(t,e)}(n,t);var e=kt(n);function n(t,i){var o,r,s;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(o=e.call(this)).messageIds=o.copyMessageIds(i.messageIds),o.downTiles=i.downTiles.concat(),o.sprite=new c.jyi,o.sprite.texture=t,i.anchor)&&(r=o.sprite.anchor).set.apply(r,Dt(i.anchor));i.scale&&(s=o.sprite.scale).set.apply(s,Dt(i.scale));return o.addChild(o.sprite),o}return n.prototype.copyMessageIds=function(t){var e,n,i=[],o=!0,r=!1,s=void 0;try{for(var a,c=t[Symbol.iterator]();!(o=(a=c.next()).done);o=!0){var u=a.value;e=u,(null!=(n=String)&&"undefined"!==typeof Symbol&&n[Symbol.hasInstance]?n[Symbol.hasInstance](e):e instanceof n)?i.push(u):i.push(u.concat())}}catch(l){r=!0,s=l}finally{try{o||null==c.return||c.return()}finally{if(r)throw s}}return i},n}(c.W20);function Mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Gt(t){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wt(t,e){return!e||"object"!==Ft(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Lt(t,e){return(Lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ft=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Ht(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Gt(t);if(e){var o=Gt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Wt(this,n)}}var Vt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lt(t,e)}(n,t);var e=Ht(n);function n(){return Mt(this,n),e.apply(this,arguments)}return n.prototype.createUiNode=function(t){var e;if(t){var n=t.textureName;n&&c.P6Y.kN[n]&&(e=c.P6Y.kN[n])}return e?new Ut(e,t):null},n}(E);function zt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Kt(t){return(Kt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yt(t,e){return!e||"object"!==Jt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function qt(t,e){return(qt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Xt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Kt(t);if(e){var o=Kt(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Yt(this,n)}}var Zt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qt(t,e)}(n,t);var e=Xt(n);function n(t,i){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(o=e.call(this)).isActive=!1,o.optionButton=t,o.optionType=i,o.frameSprite=new c.jyi;var r,s,a=y.game.loader.resources[S.UI.OptionFrame].texture;return a&&(o.frameSprite.texture=a),r=t,(null!=(s=c.xvT)&&"undefined"!==typeof Symbol&&s[Symbol.hasInstance]?s[Symbol.hasInstance](r):r instanceof s)?o.frameSprite.scale.set((o.optionButton.width+40)/o.frameSprite.width,(o.optionButton.height+10)/o.frameSprite.height):o.frameSprite.scale.set(o.optionButton.texture.width/o.frameSprite.width,o.optionButton.texture.height/o.frameSprite.height),o.frameSprite.anchor.set(.5,.5),o.frameSprite.visible=!1,o.optionButton.addChild(o.frameSprite),o.addChild(o.optionButton),o}var i,o,r,s=n.prototype;return s.activate=function(){this.isActive=!0,this.frameSprite.visible=!0},s.deactivate=function(){this.isActive=!1,this.frameSprite.visible=!1},i=n,r=[{key:"resourceList",get:function(){return[S.UI.OptionFrame,S.UI.ItemSelectFrame]}}],(o=null)&&zt(i.prototype,o),r&&zt(i,r),n}(c.W20);function $t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Qt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function te(t){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ee(t,e){return!e||"object"!==oe(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ne(t,e){return(ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ie(t){return function(t){if(Array.isArray(t))return $t(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return $t(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $t(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var oe=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function re(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=te(t);if(e){var o=te(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return ee(this,n)}}var se=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ne(t,e)}(n,t);var e=re(n);function n(){return Qt(this,n),e.apply(this,arguments)}return n.prototype.createUiNode=function(t){var e={};t&&(void 0!==t.family&&(e.fontFamily=t.family),void 0!==t.size&&(e.fontSize=t.size),void 0!==t.color&&(e.fill=t.color),void 0!==t.padding&&(e.padding=t.padding),void 0!==t.wordWrap&&(e.wordWrap=t.wordWrap),void 0!==t.wordWrapWidth&&(e.wordWrapWidth=t.wordWrapWidth));var n,i=new c.pn8(e),o=new c.xvT(t&&t.text?t.text:"",i);t&&void 0!==t.anchor&&(n=o.anchor).set.apply(n,ie(t.anchor));var r=t.optionType;return new Zt(o,r)},n}(E);function ae(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ce(t){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ue(t,e){return null!=e&&"undefined"!==typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function le(t,e){return!e||"object"!==fe(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function he(t,e){return(he=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fe=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function pe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ce(t);if(e){var o=ce(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return le(this,n)}}var de=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&he(t,e)}(n,t);var e=pe(n);function n(t,i){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(o=e.call(this)).currentTextIndex=0;var r=!0,s=!1,a=void 0;try{for(var u,l=t[Symbol.iterator]();!(r=(u=l.next()).done);r=!0){var h=u.value;if(!ue(h,c.xvT)){var f=!0,p=!1,d=void 0;try{for(var m,g=function(t,e){var n=e.value;n.deactivate(),n.on("pointertap",(function(){o.onOptionButtonTapped(n)}))},v=h[Symbol.iterator]();!(f=(m=v.next()).done);f=!0)g(0,m)}catch(w){p=!0,d=w}finally{try{f||null==v.return||v.return()}finally{if(p)throw d}}h[0].activate()}}}catch(w){s=!0,a=w}finally{try{r||null==l.return||l.return()}finally{if(s)throw a}}o.delegate=i,o.textsAndOptions=t;var b=c.P6Y.kN[S.UI.MessageWindow];return o.window=new c.jyi(b),o.window.interactive=!0,o.window.on("pointertap",(function(){o.showNextText()})),o.window.scale.set((y.game.view.width-10)/o.window.width,(y.game.view.height/3-10)/o.window.height),o.window.anchor.set(.5,.5),o.window.position.set(y.game.view.width/2,y.game.view.height-o.window.height/2-5),o.windowScaleX=o.window.scale.x,o.windowScaleY=o.window.scale.y,o.windowSizeUpRateX=o.windowScaleX/n.WindowSizeUpFrame,o.windowSizeUpRateY=o.windowScaleY/n.WindowSizeUpFrame,o.window.scale.set(0,0),ue(o.textsAndOptions[0],c.xvT)&&o.window.addChild(o.textsAndOptions[0]),o.addChild(o.window),o}var i,o,r,s=n.prototype;return s.isDestroyed=function(){return this._destroyed},s.update=function(t){this.isDestroyed()||this.window.scale.x===this.windowScaleX&&this.window.scale.y===this.windowScaleY||(this.window.scale.set(this.window.scale.x+this.windowSizeUpRateX,this.window.scale.y+this.windowSizeUpRateY),this.window.scale.x>=this.windowScaleX&&(this.window.scale.x=this.windowScaleX),this.window.scale.y>=this.windowScaleY&&(this.window.scale.y=this.windowScaleY))},s.showNextText=function(){if(m.playSe(S.Audio.Se.ShowNextText),this.window.interactive=!0,this.currentTextIndex!==this.textsAndOptions.length-1){var t=this.textsAndOptions[this.currentTextIndex];if(ue(t,c.xvT))t.visible=!1;else{var e=!0,n=!1,i=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){o.value.visible=!1}}catch(I){n=!0,i=I}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}}var s=this.textsAndOptions[++this.currentTextIndex];if(ue(s,c.xvT))this.window.addChild(s);else{this.window.interactive=!1,2===s.length?(s[0].position.set(-190,0),s[1].position.set(190,0)):3===s.length?(s[0].position.set(-300,0),s[1].position.set(0,0),s[2].position.set(300,0)):4===s.length?(s[0].position.set(-190,-35),s[1].position.set(-190,35),s[2].position.set(190,-35),s[3].position.set(190,35)):5===s.length?(s[0].position.set(-300,-35),s[1].position.set(-300,35),s[2].position.set(0,-35),s[3].position.set(0,35),s[4].position.set(300,-35)):6===s.length?(s[0].position.set(-300,-35),s[1].position.set(-300,35),s[2].position.set(0,-35),s[3].position.set(0,35),s[4].position.set(300,-35),s[5].position.set(300,35)):s[0].position.set(0,0);var a=!0,u=!1,l=void 0;try{for(var h,f=s[Symbol.iterator]();!(a=(h=f.next()).done);a=!0){var p=h.value;p.visible=!0,this.window.addChild(p)}}catch(I){u=!0,l=I}finally{try{a||null==f.return||f.return()}finally{if(u)throw l}}}}else{this.delegate.onMessageWindowClosed();var d=!0,y=!1,g=void 0;try{for(var v,b=this.textsAndOptions[Symbol.iterator]();!(d=(v=b.next()).done);d=!0){var w=v.value;if(!ue(w,c.xvT)){var O=!0,_=!1,T=void 0;try{for(var E,R=w[Symbol.iterator]();!(O=(E=R.next()).done);O=!0){E.value.removeListener("pointertap")}}catch(I){_=!0,T=I}finally{try{O||null==R.return||R.return()}finally{if(_)throw T}}}}}catch(I){y=!0,g=I}finally{try{d||null==b.return||b.return()}finally{if(y)throw g}}this.destroy()}},s.onOptionButtonTapped=function(t){if(t.isActive)t.optionType&&this.delegate.onOptionSelected(t.optionType),this.showNextText();else{var e=this.textsAndOptions[this.currentTextIndex];if(!ue(e,c.xvT)){var n=!0,i=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){r.value.deactivate()}}catch(a){i=!0,o=a}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}}m.playSe(S.Audio.Se.OptionTap),t.activate()}},s.addText=function(t,e){if(!ue(t,c.xvT)){var n=!0,i=!1,o=void 0;try{for(var r,s=this,a=function(t,e){var n=e.value,i=s;n.removeListener("pointertap"),n.deactivate(),n.on("pointertap",(function(){i.onOptionButtonTapped(n)}))},u=t[Symbol.iterator]();!(n=(r=u.next()).done);n=!0)a(0,r)}catch(l){i=!0,o=l}finally{try{n||null==u.return||u.return()}finally{if(i)throw o}}t[0].activate()}this.textsAndOptions.splice(this.currentTextIndex+e,0,t)},i=n,r=[{key:"resourceList",get:function(){return[S.UI.MessageWindow]}}],(o=null)&&ae(i.prototype,o),r&&ae(i,r),n}(c.W20);function me(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ge(t,e){return null!=e&&"undefined"!==typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function ve(t,e){return!e||"object"!==we(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function be(t,e){return(be=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}de.WindowSizeUpFrame=10;var we=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Oe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ye(t);if(e){var o=ye(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return ve(this,n)}}var Se=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&be(t,e)}(n,t);var e=Oe(n);function n(t,i,o,r,s){var a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(a=e.call(this)).isOpen=!1,a.menuOptionButtons=[],a.itemPanels=new Map,a.texts=new Map,a.optionButtons=new Map,a.delegate=s,a.menuOptionButtons=t,a.texts=r,a.soundOption=o,r.forEach((function(t,e){ge(t,Zt)&&a.optionButtons.set(e,t)}));var u=c.P6Y.kN[S.UI.MenuBar],l=c.P6Y.kN[S.UI.MenuButton],h=c.P6Y.kN[S.UI.ItemPanelFrame],f=c.P6Y.kN[S.UI.MessageWindow];return a.menuBar=new c.jyi(u),a.menuButton=new c.jyi(l),a.itemPanelFrame=new c.jyi(h),a.messageWindow=new c.jyi(f),a.initMenuBarAndMenuButton(),a.initItemPanelFrameAndItemPanels(i),a.initMessageWindow(r),a}var i,o,r,s=n.prototype;return s.initMessageWindow=function(t){var e=this;t.forEach((function(t,n){if(!ge(t,c.xvT)){var i=e;t.on("pointertap",(function(){i.onOptionButtonTapped(t)}))}})),this.messageWindow.scale.set((.8*y.game.view.width+20)/this.messageWindow.width,y.game.view.height/6/this.messageWindow.height),this.messageWindow.anchor.set(.5,.5),this.messageWindow.position.x=367,t.forEach((function(t,n){t.visible=!1,e.messageWindow.addChild(t)})),this.messageWindow.visible=!1,this.addChild(this.messageWindow)},s.initItemPanelFrameAndItemPanels=function(t){this.itemPanelFrame.scale.set((.8*y.game.view.width+20)/this.itemPanelFrame.width,(y.game.view.height/4+30)/this.itemPanelFrame.height),this.itemPanelFrame.position.set(100,10);var e=!0,n=!1,i=void 0;try{for(var o,r=this,s=function(t,e){var n=e.value,i=r;n.on("pointertap",(function(){i.onItemPanelTapped(n)})),r.itemPanels.set(n.itemType,n),n.scale.set((r.itemPanelFrame.texture.width-8)/6/n.width,(r.itemPanelFrame.texture.height/2-5)/n.height),r.itemPanelFrame.addChild(n)},a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)s(0,o)}catch(c){n=!0,i=c}finally{try{e||null==a.return||a.return()}finally{if(n)throw i}}this.itemPanelFrame.visible=!1,this.addChild(this.itemPanelFrame)},s.initMenuBarAndMenuButton=function(){var t=this;this.menuButton.interactive=!0,this.menuButton.on("pointertap",(function(){t.onMenuButtonTapped()})),this.menuBar.scale.set(y.game.view.width/7/this.menuBar.width,y.game.view.height/2/this.menuBar.height),this.menuButton.scale.set(this.menuBar.width/this.menuButton.width,this.menuBar.height/6/this.menuButton.height),this.menuBar.scale.y=(y.game.view.height/2-this.menuButton.height)/this.menuBar.texture.height,this.menuBar.position.y=this.menuButton.height,this.menuMoveRate=this.menuBar.width/n.menuMoveFrame,this.menuBar.addChild(this.menuButton);var e=!0,i=!1,o=void 0;try{for(var r,s=this,a=function(t,e){var n=e.value,i=s;n.on("pointertap",(function(){i.onMenuOptionButtonTapped(n)})),n.position.x=s.menuBar.texture.width/2,n.interactive=!0,s.menuBar.addChild(n)},c=this.menuOptionButtons[Symbol.iterator]();!(e=(r=c.next()).done);e=!0)a(0,r)}catch(u){i=!0,o=u}finally{try{e||null==c.return||c.return()}finally{if(i)throw o}}this.addChild(this.menuBar),this.addChild(this.menuButton)},s.isDestroyed=function(){return this._destroyed},s.update=function(t){this.isDestroyed()||(this.isOpen&&this.menuBar.position.x<0&&(this.menuBar.position.x+=this.menuMoveRate),!this.isOpen&&this.menuBar.position.x>-this.menuBar.width&&(this.menuBar.position.x-=this.menuMoveRate))},s.updateItemPanels=function(t){this.itemPanels.forEach((function(t,e){t.removeItem()}));var e=!0,n=!1,i=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value;if(s===w.FROZEN_BANANA){var a=this.itemPanels.get(w.BANANA);if(!a)continue;a.hasItem=!0;var u=c.P6Y.kN[S.Dynamic.items(w.FROZEN_BANANA)];a.optionButton.texture=u,a.itemType=w.FROZEN_BANANA,a.itemTextId="frozen_banana_text",a.optionId="use_frozen_banana"}if(s===w.SHARPENED_PENCIL){var l=this.itemPanels.get(w.PENCIL);if(!l)continue;l.hasItem=!0;var h=c.P6Y.kN[S.Dynamic.items(w.SHARPENED_PENCIL)];l.optionButton.texture=h,l.itemType=w.SHARPENED_PENCIL,l.itemTextId="sharpened_pencil_text",l.optionId="use_sharpened_pencil"}var f=this.itemPanels.get(s);f&&f.addItem()}}catch(p){n=!0,i=p}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}},s.onOptionButtonTapped=function(t){m.playSe(S.Audio.Se.OptionTap),t.isActive?(t.optionType===wt.DoNoting&&(this.messageWindow.visible=!1,this.menuOptionButtons.forEach((function(t,e){t.deactivate()}))),this.delegate.onOptionSelected(t.optionType)):(this.optionButtons.forEach((function(t,e){t.deactivate()})),t.activate())},s.onItemPanelTapped=function(t){if(m.playSe(S.Audio.Se.OptionTap),this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1})),this.messageWindow.visible=!1,t.activate(),t.hasItem){var e=this.texts.get(t.itemTextId);if(!e)return;this.messageWindow.position.y=260,this.messageWindow.visible=!0,e.visible=!0}},s.onMenuOptionButtonTapped=function(t){if(m.playSe(S.Audio.Se.OptionTap),t.isActive)t.deactivate(),this.toggleDisplay(t.optionType,!1);else{var e=this;this.menuOptionButtons.forEach((function(t,n){t.deactivate(),e.toggleDisplay(t.optionType,!1)})),this.toggleDisplay(t.optionType,!0),t.activate()}},s.onMenuButtonTapped=function(){if(m.playSe(S.Audio.Se.OptionTap),this.isOpen=!this.isOpen,!this.isOpen){var t=this;this.menuOptionButtons.forEach((function(e,n){e.deactivate(),t.toggleDisplay(e.optionType,!1)})),this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1})),this.messageWindow.visible=!1}},s.toggleDisplay=function(t,e){if(t===wt.ShowItems&&(this.itemPanelFrame.visible=e,e||(this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1,ge(t,Zt)&&t.deactivate()})),this.messageWindow.visible=!1)),t===wt.ShowBackToTitle){this.messageWindow.position.y=270,this.messageWindow.visible=e;var n=this.texts.get(S.MessageIds.BackToTitle),i=this.texts.get(S.MessageIds.ContinueGame);if(!n)return;if(!i)return;n.visible=e,ge(n,Zt)&&n.activate(),i.visible=e}t===wt.ShowSoundVolume&&(this.soundOption.visible=e)},i=n,r=[{key:"resourceList",get:function(){return[S.UI.MenuBar,S.UI.MenuButton,S.UI.ItemPanelFrame]}}],(o=null)&&me(i.prototype,o),r&&me(i,r),n}(c.W20);function _e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Te(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ee(t){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Re(t,e){return!e||"object"!==xe(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ie(t,e){return(Ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function je(t){return function(t){if(Array.isArray(t))return _e(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return _e(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _e(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Se.menuMoveFrame=10;var xe=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Ce(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ee(t);if(e){var o=Ee(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Re(this,n)}}var Pe=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ie(t,e)}(n,t);var e=Ce(n);function n(){return Te(this,n),e.apply(this,arguments)}return n.prototype.createUiNode=function(t){var e=new c.jyi;if(t){var n,i,o=t.textureName;if(o&&c.P6Y.kN[o]&&(e.texture=c.P6Y.kN[o]),t.anchor)(n=e.anchor).set.apply(n,je(t.anchor));if(t.scale)(i=e.scale).set.apply(i,je(t.scale))}var r=t.optionType;return new Zt(e,r)},n}(E);function Ae(t){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Be(t,e){return!e||"object"!==Ne(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function De(t,e){return(De=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ne=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ke(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Ae(t);if(e){var o=Ae(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Be(this,n)}}var Ue=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&De(t,e)}(n,t);var e=ke(n);function n(t,i,o,r,s){var a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(a=e.call(this,t,r)).hasItem=!1,a.itemType=i,a.optionButton=t,a.itemTextId=o,a.optionId=s;var c=y.game.loader.resources[S.UI.ItemSelectFrame].texture;return c&&(a.frameSprite.texture=c),a.frameSprite.scale.set(1,1),a}var i=n.prototype;return i.addItem=function(){this.hasItem=!0,this.optionButton.texture=c.P6Y.kN[S.Dynamic.items(this.itemType)]},i.removeItem=function(){this.hasItem=!1,this.optionButton.texture=c.P6Y.kN[S.Dynamic.items(0)]},n}(Zt);function Me(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function We(t){return(We=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Le(t,e){return!e||"object"!==Ve(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fe(t,e){return(Fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function He(t){return function(t){if(Array.isArray(t))return Me(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return Me(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Me(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ve=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ze(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=We(t);if(e){var o=We(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Le(this,n)}}var Ke=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fe(t,e)}(n,t);var e=ze(n);function n(){return Ge(this,n),e.apply(this,arguments)}return n.prototype.createUiNode=function(t){var e=new c.jyi;if(t){var n,i,o=t.textureName;if(o&&c.P6Y.kN[o]&&(e.texture=c.P6Y.kN[o]),t.anchor)(n=e.anchor).set.apply(n,He(t.anchor));if(t.scale)(i=e.scale).set.apply(i,He(t.scale))}return new Ue(e,t.itemType,t.itemTextId,t.optionType,t.optionId)},n}(E),Ye=Object.freeze({DownTiles:"downTiles",Position:"position",MessageIds:"messageIds",TextureName:"textureName",Visible:"visible"});function qe(t,e,n){return(qe="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Je(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Je(t){return(Je=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xe(t,e){return!e||"object"!==$e(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ze(t,e){return(Ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $e=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Qe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=Je(t);if(e){var o=Je(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return Xe(this,n)}}var tn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ze(t,e)}(n,t);var e=Qe(n);function n(t){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(i=e.call(this)).isPaused=!1,i.tiles=new Map,i.roomObjects=new Map,i.messages=new Map,i.options=new Map,i.messageWindow=null,i.itemPanels=[],i.menuTexts=new Map,i.soundOption=new c.W20,i.pinPad=new c.W20,i.code=[],i.correctCode=[],i.transitionIn=new b(1,0,-.02),i.transitionOut=new b(0,1,.02),i.state=St.LOADING_RESOURCES,i.sceneName="escape_scene",i.language=t,i.saveData={roomObject:[],mapData:void 0,playerItems:[],roomObjectState:[],code:[],isBalloonExist:!0},i.gameLogic=new Ot,i}var i=n.prototype;return i.beginTransitionIn=function(t,e){var i=this;qe(Je(n.prototype),"beginTransitionIn",this).call(this,(function(){i.state===St.RESOURCE_LOADED&&(i.state=St.READY,t(i),m.playBgm(S.Audio.Bgm.EscapeBGM))}),e)},i.createInitialResourceList=function(){return qe(Je(n.prototype),"createInitialResourceList",this).call(this).concat(S.UI.Tiles,S.UI.TileFrame,S.UI.PlayerAnimation,S.UI.Player,S.UI.RoomObjectMaster,S.UI.Items,S.UI.RoomObjects,de.resourceList,Zt.resourceList,Se.resourceList,[S.UI.Stage,S.Audio.Se.OptionTap,S.Audio.Se.ShowNextText,S.Audio.Se.TileTap,S.Audio.Bgm.EscapeBGM,S.Audio.Bgm.EndingBGM])},i.loadInitialResource=function(t){var e,n,i=this.createInitialResourceList(),o=S.UI.SceneUiGraph(this.sceneName);e="japanese"===this.language?S.UI.EscapeSceneMessage:S.UI.EscapeSceneEnglishMessage,n="japanese"===this.language?S.UI.EscapeSceneOption:S.UI.EscapeSceneEnglishOption;var r=S.UI.EscapeSceneRoomObject;i.push(o),i.push(e),i.push(n),i.push(r);var s=this.filterLoadedAssets(i);s.length>0?y.game.loader.add(s).load(t):t()},i.onInitialResourceLoaded=function(){var t,e=[],n=S.UI.SceneUiGraph(this.sceneName);t="japanese"===this.language?S.UI.EscapeSceneOption:S.UI.EscapeSceneEnglishOption;var i=S.UI.EscapeSceneRoomObject,o=y.game.loader.resources[n].data.nodes;o=(o=o.concat(y.game.loader.resources[t].data.nodes)).concat(y.game.loader.resources[i].data.nodes);var r=!0,s=!1,a=void 0;try{for(var c,u=o[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var l=c.value;"sprite"!==l.type&&"sprite_option"!==l.type&&"room_object"!==l.type&&"item_panel"!==l.type||e.push({name:l.params.textureName,url:l.params.url})}}catch(h){s=!0,a=h}finally{try{r||null==u.return||u.return()}finally{if(s)throw a}}return e},i.onResourceLoaded=function(){var t,e,n=y.game.loader.resources[S.UI.SceneUiGraph(this.sceneName)].data;t="japanese"===this.language?S.UI.EscapeSceneMessage:S.UI.EscapeSceneEnglishMessage,e="japanese"===this.language?S.UI.EscapeSceneOption:S.UI.EscapeSceneEnglishOption;var i=y.game.loader.resources[t].data,o=y.game.loader.resources[e].data,r=y.game.loader.resources[S.UI.EscapeSceneRoomObject].data;this.prepareUiGraphContainer(n),this.prepareUiGraphContainer(i),this.prepareUiGraphContainer(o),this.prepareUiGraphContainer(r);var s=y.game.loader.resources,a=s[S.UI.Stage].data,c=s[S.UI.RoomObjectMaster].data;this.playerAnimationMaster=s[S.UI.PlayerAnimation].data,this.tileSize=a.tileSize,this.initTiles(a,this.tileSize),this.uiGraphContainer.zIndex=1,this.addChild(this.uiGraphContainer),this.initSound(),this.initPinPad(),this.setHitArea(),this.initMenu(),this.initVolumeText(),this.initSoundOption(),this.loadSaveDataFromDB(a,c)},i.setHitArea=function(){var t=this.roomObjects.get("bowl");if(t){t.hitArea=new c.Cdc(t.width/2,t.height/2,30);var e=this.options.get("use_salt");e&&(e.hitArea=new c.AeJ(-75,-25,150,50))}},i.initMenu=function(){var t=[],e=!0,n=!1,i=void 0;try{for(var o,r=S.MenuOptionIds[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=this.options.get(s);a&&t.push(a)}}catch(u){n=!0,i=u}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}var c=new Se(t,this.itemPanels,this.soundOption,this.menuTexts,this);this.menu=c,this.menu.zIndex=3,this.registerUpdatingObject(c),this.addChild(this.menu)},i.initSoundOption=function(){var t=!0,e=!1,n=void 0;try{for(var i,o=S.SoundOptionIds[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var r=i.value,s=this.uiGraph.get(r);s&&this.soundOption.addChild(s)}}catch(a){e=!0,n=a}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}this.soundOption.visible=!1,this.soundOption.zIndex=3,this.addChild(this.soundOption)},i.initCode=function(){var t=this.messages.get("mirror_message_4");t&&("japanese"===this.language?t.text="\u624b\u93e1\u3067\u9996\u306e\u5f8c\u308d\u3092\u898b\u308b\u3068            \u5c0f\u3055\u304f\u300c".concat(this.correctCode[0].toString()+this.correctCode[1].toString()+this.correctCode[2].toString(),"\u300d\u3068\u66f8\u304b\u308c\u3066\u3044\u308b\u3002"):t.text="when you looked at the back of your neck             with the hand mirror, it was written as '".concat(this.correctCode[0].toString()+this.correctCode[1].toString()+this.correctCode[2].toString(),"'"))},i.initPinPad=function(){var t=!0,e=!1,n=void 0;try{for(var i,o=S.PinPadIds[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var r=i.value,s=this.uiGraph.get(r);s&&this.pinPad.addChild(s)}}catch(a){e=!0,n=a}finally{try{t||null==o.return||o.return()}finally{if(e)throw n}}this.pinPad.visible=!1,this.pinPad.zIndex=3,this.addChild(this.pinPad)},i.initVolumeText=function(){var t=Math.round(100*m.bgmVolume),e=Math.round(10*m.seVolume);this.uiGraph.get("bgm_volume").text=t.toString();this.uiGraph.get("se_volume").text=e.toString()},i.initSound=function(){var t=y.game.loader.resources,e=[S.Audio.Se.OptionTap,S.Audio.Se.ShowNextText,S.Audio.Se.TileTap,S.Audio.Bgm.EscapeBGM,S.Audio.Bgm.EndingBGM],n=!0,i=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var a=r.value;m.createSound(a,t[a].buffer)}}catch(c){i=!0,o=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}},i.update=function(t){if(!this.isPaused)switch(this.state){case St.LOADING_RESOURCES:break;case St.READY:this.state=St.INGAME;break;case St.INGAME:case St.FINISHED:this.gameLogic.update()}this.updateRegisteredObjects(t),this.transitionIn.isActive()?this.transitionIn.update(t):this.transitionOut.isActive()&&this.transitionOut.update(t)},i.onRoomObjectTapped=function(t){if(!this.messageWindow){m.playSe(S.Audio.Se.OptionTap),this.roomObjects.forEach((function(t,e){t.interactive=!1})),this.tiles.forEach((function(t,e){t.isActive&&t.toggleFrame(),t.interactive=!1}));var e=this.roomObjects.get(t);e&&(this.spawnMessageWindow(e.messageIds),this.gameLogic.onRoomObjectTapped(t))}},i.onPlayerSpawned=function(t){this.tiles.forEach((function(e){e.tilePosition[0]===t.positionRow&&e.tilePosition[1]===t.positionColumn&&(e.interactive=!1)})),this.player=new _t(this.playerAnimationMaster,this.tileSize,{x:t.positionColumn*this.tileSize,y:t.positionRow*this.tileSize-this.tileSize/3}),this.player.sprite.zIndex=2,this.addChild(this.player.sprite),this.registerUpdatingObject(this.player),this.sortChildren()},i.onPlayerEntityStateChanged=function(t){if(t.state===gt.IDLE&&(this.player.requestAnimation(S.AnimationTypes.Player.WAIT),this.tiles.forEach((function(e){t.positionRow===e.tilePosition[0]&&t.positionColumn===e.tilePosition[1]?e.interactive=!1:e.interactive=!0})),this.roomObjects.forEach((function(e,n){var i=!0,o=!1,r=void 0;try{for(var s,a=e.downTiles[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var c=s.value;(c[0]===t.positionRow-1&&c[1]===t.positionColumn||c[0]===t.positionRow+1&&c[1]===t.positionColumn||c[0]===t.positionRow&&c[1]===t.positionColumn-1||c[0]===t.positionRow&&c[1]===t.positionColumn+1)&&(e.interactive=!0)}}catch(u){o=!0,r=u}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}}))),t.state===gt.WALK&&this.roomObjects.forEach((function(t,e){t.interactive=!1})),t.state===gt.CHECKING){if(t.checkingObject===S.RoomObjects.CLOCK)return void this.player.requestAnimation(S.AnimationTypes.Player.CHACKUP);if(null===t.checkingObject)return;var e=this.roomObjects.get(t.checkingObject);if(!e)return;var n=0,i=0,o=0,r=0,s=!0,a=!1,c=void 0;try{for(var u,l=e.downTiles[Symbol.iterator]();!(s=(u=l.next()).done);s=!0){var h=u.value;h[0]<t.positionRow?n++:h[0]>t.positionRow&&i++,h[1]<t.positionColumn?o++:h[1]>t.positionColumn&&r++}}catch(f){a=!0,c=f}finally{try{s||null==l.return||l.return()}finally{if(a)throw c}}n===e.downTiles.length?this.player.requestAnimation(S.AnimationTypes.Player.CHACKUP):i===e.downTiles.length?this.player.requestAnimation(S.AnimationTypes.Player.CHACKDOWN):o===e.downTiles.length?this.player.requestAnimation(S.AnimationTypes.Player.CHACKLEFT):r===e.downTiles.length&&this.player.requestAnimation(S.AnimationTypes.Player.CHACKRIGHT)}},i.onBgmArrowTapped=function(t){var e=m.bgmVolume;(e+=t)<0?e=0:e>.1&&(e=.1);this.uiGraph.get("bgm_volume").text=Math.round(100*e).toString(),m.bgmVolume=e,m.playSe(S.Audio.Se.OptionTap),this.saveBgmVolumeToDB(m.bgmVolume),m.setSoundVolume(m.bgmVolume,m.seVolume)},i.onSeArrowTapped=function(t){var e=m.seVolume;(e+=t)<0?e=0:e>1&&(e=1);this.uiGraph.get("se_volume").text=Math.round(10*e).toString(),m.seVolume=e,m.playSe(S.Audio.Se.OptionTap),this.saveSeVolumeToDB(m.seVolume)},i.onPinPadTapped=function(t){if(m.playSe(S.Audio.Se.OptionTap),!(this.code.length>=3)){var e;this.code.push(t),e=1===this.code.length?"first":2===this.code.length?"second":"third";var n=this.uiGraph.get("code_".concat(e));n&&(n.text=t.toString())}},i.onPinPadCancelTapped=function(){if(m.playSe(S.Audio.Se.OptionTap),0!==this.code.length){var t;this.code.pop(),t=0===this.code.length?"first":1===this.code.length?"second":"third";var e=this.uiGraph.get("code_".concat(t));e&&(e.text="")}},i.onPinPadEnterTapped=function(){this.gameLogic.onRoomObjectTapped("safe"),m.playSe(S.Audio.Se.OptionTap),this.isPaused=!1;var t=this.uiGraph.get("code_first"),e=this.uiGraph.get("code_second"),n=this.uiGraph.get("code_third");if(t&&e&&n){if(t.text="",e.text="",n.text="",this.code[0]===this.correctCode[0]&&this.code[1]===this.correctCode[1]&&this.code[2]===this.correctCode[2]){this.spawnMessageWindow(["safe_opened","there_is_crossbow",["get_crossbow","do_nothing"]]);var i=this.roomObjects.get("safe");if(!i)return;i.messageIds.pop(),i.messageIds=["safe_message_1","there_is_crossbow",["get_crossbow","do_nothing"]],this.saveRoomObjectToDB(S.RoomObjects.SAFE,Ye.MessageIds,i.messageIds)}else{this.spawnMessageWindow(["wrong_code"])}this.pinPad.visible=!1,this.code=[]}},i.spawnMessageWindow=function(t){this.messages.forEach((function(t,e){t.visible=!0})),this.options.forEach((function(t,e){t.visible=!0}));var e=this.createMessages(t),n=new de(e,this);n.zIndex=3,this.messageWindow=n,this.addChild(n),this.registerUpdatingObject(n)},i.createMessages=function(t){var e=[],n=!0,i=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var a=r.value,c=[];if("string"===typeof a){var u=this.messages.get(a);if(!u)continue;e.push(u)}else{var l=!0,h=!1,f=void 0;try{for(var p,d=a[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var m=p.value,y=this.options.get(m);y&&c.push(y)}}catch(g){h=!0,f=g}finally{try{l||null==d.return||d.return()}finally{if(h)throw f}}e.push(c)}}}catch(g){i=!0,o=g}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return e},i.onMessageWindowClosed=function(){this.gameLogic.onChackingEnd(),this.messageWindow=null},i.onOptionSelected=function(t){if(t!==wt.DoNoting){if(t!==wt.ShowItemOption)return t===wt.ShowPinPad?(this.isPaused=!0,void(this.pinPad.visible=!0)):t===wt.BackToTitle?(this.visible=!1,void this.showTitleScene()):void this.gameLogic.onOptionSelected(t);var e=this,n=[];if(this.itemPanels.forEach((function(t,i){if(t.hasItem){var o=e.options.get(t.optionId);if(!o)return;n.push(o)}})),0===n.length){var i,o=this.messages.get("has_no_item");if(!o)return;null===(i=this.messageWindow)||void 0===i||i.addText(o,1)}else{var r;null===(r=this.messageWindow)||void 0===r||r.addText(n,1)}}},i.onItemUsed=function(t,e,n){var i=this.roomObjects.get(e.id);if(i)if(t===wt.UseTinStatue&&e.id===S.RoomObjects.GAS_STOVE){var o,r,s=this.messages.get("tin_statue_melted"),a=this.messages.get("get_coin");if(!s)return;if(!a)return;null===(o=this.messageWindow)||void 0===o||o.addText(s,1),null===(r=this.messageWindow)||void 0===r||r.addText(a,2),i.messageIds.pop(),i.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.GAS_STOVE,Ye.MessageIds,i.messageIds)}else if(t===wt.UseDVD&&e.id===S.RoomObjects.TV){var u,l,h=this.messages.get("serching"),f=this.messages.get("watched_dvd");if(!h)return;if(!f)return;null===(u=this.messageWindow)||void 0===u||u.addText(h,1),null===(l=this.messageWindow)||void 0===l||l.addText(f,2)}else if(t===wt.UseCoin&&e.id===S.RoomObjects.VENDING_MACHINE){var p,d=this.messages.get("get_banana");if(!d)return;null===(p=this.messageWindow)||void 0===p||p.addText(d,1),i.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.VENDING_MACHINE,Ye.MessageIds,i.messageIds)}else if(t===wt.UseBanana&&e.id===S.RoomObjects.FREEZER){var m,g=this.messages.get("freeze_banana");if(!g)return;null===(m=this.messageWindow)||void 0===m||m.addText(g,1),i.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.FREEZER,Ye.MessageIds,i.messageIds)}else if(t===wt.UseSalt&&e.id===S.RoomObjects.BARREL){var v,b,O=this.messages.get("put_salt_in_barrel"),_=this.messages.get("get_desk_key");if(!O)return;if(!_)return;null===(v=this.messageWindow)||void 0===v||v.addText(O,1),null===(b=this.messageWindow)||void 0===b||b.addText(_,2),i.messageIds.pop(),i.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.BARREL,Ye.MessageIds,i.messageIds)}else if(t===wt.UseDeskKey&&e.id===S.RoomObjects.DESK){var T,E,R,I=[],j=this.messages.get("unlock"),x=this.messages.get("there_is_pencil"),C=this.options.get("get_pencil"),P=this.options.get("do_nothing");if(!j)return;if(!x)return;if(!C)return;if(!P)return;I.push(C),I.push(P),null===(T=this.messageWindow)||void 0===T||T.addText(j,1),null===(E=this.messageWindow)||void 0===E||E.addText(x,2),null===(R=this.messageWindow)||void 0===R||R.addText(I,3)}else if(t===wt.UsePencil&&e.id===S.RoomObjects.GRINDER){var A,B,D=this.messages.get("grind_pencil"),N=this.messages.get("get_sharpened_pencil");if(!D)return;if(!N)return;null===(A=this.messageWindow)||void 0===A||A.addText(D,1),null===(B=this.messageWindow)||void 0===B||B.addText(N,2),i.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.GRINDER,Ye.MessageIds,i.messageIds)}else if(t===wt.UseDetergent&&e.id===S.RoomObjects.MIRROR){var k,U,M,G=[],W=this.messages.get("washed_mirror"),L=this.messages.get("mirror_message_3"),F=this.options.get("use_item"),H=this.options.get("do_nothing");if(!W)return;if(!L)return;if(!F)return;if(!H)return;G.push(F),G.push(H),null===(k=this.messageWindow)||void 0===k||k.addText(W,1),null===(U=this.messageWindow)||void 0===U||U.addText(L,2),null===(M=this.messageWindow)||void 0===M||M.addText(G,3),i.messageIds[1]="mirror_message_3",this.saveRoomObjectToDB(S.RoomObjects.MIRROR,Ye.MessageIds,i.messageIds);var V=c.P6Y.kN["room_object/mirror.png"];i.sprite.texture=V,this.saveRoomObjectToDB(S.RoomObjects.MIRROR,Ye.TextureName,"room_object/mirror.png")}else if(t===wt.UseHandMirror&&e.id===S.RoomObjects.MIRROR&&-1!==e.states.indexOf(bt.Washed)){var z,K=this.messages.get("mirror_message_4");if(!K)return;null===(z=this.messageWindow)||void 0===z||z.addText(K,1)}else if(t===wt.UseCarKey&&e.id===S.RoomObjects.CAR){var Y=this;this.isPaused=!0,this.beginTransitionOut((function(){Y.isPaused=!1,Y.player.sprite.position.set(456.4,426.6);var t=y.game.loader.resources[S.UI.Stage].data.carMovedMapData;Y.resetTiles(t),Y.saveData.mapData=t,Y.saveProgressToDB(),i.position.x=380,Y.saveRoomObjectToDB(S.RoomObjects.CAR,Ye.Position,[i.position.x,i.position.y]),i.downTiles=[[8,6],[8,7],[8,8],[9,6],[9,7],[9,8]],Y.saveRoomObjectToDB(S.RoomObjects.CAR,Ye.DownTiles,i.downTiles),Y.spawnMessageWindow(["moved_car"]),Y.beginTransitionIn((function(){})),i.messageIds.pop(),Y.saveRoomObjectToDB(S.RoomObjects.CAR,Ye.MessageIds,i.messageIds)}),!1)}else if(t===wt.UseCrossBow&&e.id===S.RoomObjects.BALLOON&&-1!==(null===n||void 0===n?void 0:n.indexOf(w.SHARPENED_PENCIL))){var q=this;this.isPaused=!0,this.beginTransitionOut((function(){q.isPaused=!1,i.sprite.visible=!1,q.saveRoomObjectToDB(S.RoomObjects.BALLOON,Ye.Visible,i.sprite.visible);var t=q.tiles.get(65);t&&(t.tileSprite.texture=c.P6Y.kN["stage/floor.png"],q.saveData.isBalloonExist=!1,q.saveProgressToDB(),q.spawnMessageWindow(["find_nail","get_nail"]),q.gameLogic.onRoomObjectTapped(S.RoomObjects.BALLOON),q.beginTransitionIn((function(){})))}),!1)}else if(t===wt.UseFrozenBanana&&e.id===S.RoomObjects.CHAIR&&-1!==(null===n||void 0===n?void 0:n.indexOf(w.NAIL))){var J=this;this.isPaused=!0,this.beginTransitionOut((function(){J.isPaused=!1;var t=c.P6Y.kN["room_object/chair.png"];i.sprite.texture=t,J.saveRoomObjectToDB(S.RoomObjects.CHAIR,Ye.TextureName,"room_object/chair.png"),i.position.set(205,85),J.saveRoomObjectToDB(S.RoomObjects.CHAIR,Ye.Position,[i.position.x,i.position.y]),i.messageIds=["chair_message_1"],J.saveRoomObjectToDB(S.RoomObjects.CHAIR,Ye.MessageIds,i.messageIds),J.spawnMessageWindow(["fix_chair"]),J.gameLogic.onRoomObjectTapped(S.RoomObjects.CHAIR),J.beginTransitionIn((function(){}))}),!1);var X=this.roomObjects.get("clock");if(!X)return;X.messageIds=["clock_message_2","clock_message_3",["set_clock","do_nothing"]],this.saveRoomObjectToDB(S.RoomObjects.CLOCK,Ye.MessageIds,X.messageIds)}else{var Z,$=this.messages.get("can_not_use");if(!$)return;null===(Z=this.messageWindow)||void 0===Z||Z.addText($,1)}},i.onPlayerItemsChanged=function(t){this.saveData.playerItems=t,this.saveProgressToDB(),this.menu.updateItemPanels(t)},i.onRoomObjectOptionSelected=function(t,e){var n=this.roomObjects.get(t.id);if(n){if(e===wt.CheckUnderBed)if(-1===t.states.indexOf(bt.CheckedUnderBed)){var i,o,r=this.messages.get("serching"),s=this.messages.get("get_tin_statue");if(!r)return;if(!s)return;null===(i=this.messageWindow)||void 0===i||i.addText(r,1),null===(o=this.messageWindow)||void 0===o||o.addText(s,2)}else{var a,u=this.messages.get(S.MessageIds.NothingSpecial);if(!u)return;null===(a=this.messageWindow)||void 0===a||a.addText(u,1)}if(e===wt.CheckUnderPillow)if(-1===t.states.indexOf(bt.CheckedUnderPillow)){var l,h,f=this.messages.get("serching"),p=this.messages.get("get_hand_mirror");if(!f)return;if(!p)return;null===(l=this.messageWindow)||void 0===l||l.addText(f,1),null===(h=this.messageWindow)||void 0===h||h.addText(p,2)}else{var d,m=this.messages.get(S.MessageIds.NothingSpecial);if(!m)return;null===(d=this.messageWindow)||void 0===d||d.addText(m,1)}if(e===wt.JumpOnBed)if(-1===t.states.indexOf(bt.JumpedOnBed)){var g,v=this.messages.get("something_on_closet");if(!v)return;null===(g=this.messageWindow)||void 0===g||g.addText(v,1);var b=this.roomObjects.get(S.RoomObjects.CLOSET),w=null===b||void 0===b?void 0:b.messageIds[b.messageIds.length-1];R=w,(null!=(I=Array)&&"undefined"!==typeof Symbol&&I[Symbol.hasInstance]?I[Symbol.hasInstance](R):R instanceof I)&&w.unshift("check_on_closet"),this.saveRoomObjectToDB(S.RoomObjects.CLOSET,Ye.MessageIds,null===b||void 0===b?void 0:b.messageIds)}else if(-1===t.states.indexOf(bt.GotCarKey)){var O,_=this.messages.get("something_on_closet");if(!_)return;null===(O=this.messageWindow)||void 0===O||O.addText(_,1)}else{var T,E=this.messages.get("have_a_fun");if(!E)return;null===(T=this.messageWindow)||void 0===T||T.addText(E,1)}var R,I;if(e===wt.CheckInCloset)if(-1===t.states.indexOf(bt.CheckedInCloset)){var j,x,C=this.messages.get("serching"),P=this.messages.get("get_detergent");if(!C)return;if(!P)return;null===(j=this.messageWindow)||void 0===j||j.addText(C,1),null===(x=this.messageWindow)||void 0===x||x.addText(P,2)}else{var A,B=this.messages.get(S.MessageIds.NothingSpecial);if(!B)return;null===(A=this.messageWindow)||void 0===A||A.addText(B,1)}if(e===wt.CheckOnCloset)if(-1===t.states.indexOf(bt.CheckedOnCloset)){var D,N,k=this.messages.get("serching"),U=this.messages.get("get_car_key");if(!k)return;if(!U)return;null===(D=this.messageWindow)||void 0===D||D.addText(k,1),null===(N=this.messageWindow)||void 0===N||N.addText(U,2)}else{var M,G=this.messages.get(S.MessageIds.NothingSpecial);if(!G)return;null===(M=this.messageWindow)||void 0===M||M.addText(G,1)}if(e===wt.GetSalt){var W,L=this.messages.get("get_salt");if(!L)return;null===(W=this.messageWindow)||void 0===W||W.addText(L,1),n.messageIds.pop(),n.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.CABINET,Ye.MessageIds,n.messageIds)}if(e===wt.GetCrossbow){var F,H=this.messages.get("get_crossbow");if(!H)return;null===(F=this.messageWindow)||void 0===F||F.addText(H,1),n.messageIds.pop(),n.messageIds.pop(),this.saveRoomObjectToDB(S.RoomObjects.SAFE,Ye.MessageIds,n.messageIds)}if(e===wt.GetDVD){var V,z=this.messages.get("get_dvd");if(!z)return;null===(V=this.messageWindow)||void 0===V||V.addText(z,1)}if(e===wt.CheckRightDrawer)if(-1===t.states.indexOf(bt.UsedKey)){var K,Y,q=[],J=this.messages.get("locked"),X=this.options.get("use_item"),Z=this.options.get("do_nothing");if(!J)return;if(!X)return;if(!Z)return;q.push(X),q.push(Z),null===(K=this.messageWindow)||void 0===K||K.addText(J,1),null===(Y=this.messageWindow)||void 0===Y||Y.addText(q,2)}else if(-1===t.states.indexOf(bt.HasNoPencil)){var $,Q,tt=[],et=this.messages.get("there_is_pencil"),nt=this.options.get("get_pencil"),it=this.options.get("do_nothing");if(!et)return;if(!nt)return;if(!it)return;tt.push(nt),tt.push(it),null===($=this.messageWindow)||void 0===$||$.addText(et,1),null===(Q=this.messageWindow)||void 0===Q||Q.addText(tt,2)}else{var ot,rt=this.messages.get(S.MessageIds.NothingSpecial);if(!rt)return;null===(ot=this.messageWindow)||void 0===ot||ot.addText(rt,1)}if(e===wt.CheckLeftDrawer)if(-1===t.states.indexOf(bt.HasNoDVD)){var st,at,ct=[],ut=this.messages.get("there_is_dvd"),lt=this.options.get("get_dvd"),ht=this.options.get("do_nothing");if(!ut)return;if(!lt)return;if(!ht)return;ct.push(lt),ct.push(ht),null===(st=this.messageWindow)||void 0===st||st.addText(ut,1),null===(at=this.messageWindow)||void 0===at||at.addText(ct,2)}else{var ft,pt=this.messages.get(S.MessageIds.NothingSpecial);if(!pt)return;null===(ft=this.messageWindow)||void 0===ft||ft.addText(pt,1)}if(e===wt.GetPenCil){var dt,mt=this.messages.get("get_pencil");if(!mt)return;null===(dt=this.messageWindow)||void 0===dt||dt.addText(mt,1)}if(e===wt.MovePig){var yt,gt=this.messages.get("not_move");if(!gt)return;null===(yt=this.messageWindow)||void 0===yt||yt.addText(gt,1)}if(e===wt.ReadHint){var vt,Ot=[],St=this.options.get("hint_1"),_t=this.options.get("hint_2");if(!St)return;if(!_t)return;Ot.push(St),Ot.push(_t),null===(vt=this.messageWindow)||void 0===vt||vt.addText(Ot,1)}if(e===wt.ReadHint1){var Tt,Et=this.messages.get("hint_1");if(!Et)return;null===(Tt=this.messageWindow)||void 0===Tt||Tt.addText(Et,1)}if(e===wt.ReadHint2){var Rt,It=this.messages.get("hint_2");if(!It)return;null===(Rt=this.messageWindow)||void 0===Rt||Rt.addText(It,1)}if(e===wt.SetTime){var jt=this;this.isPaused=!0,this.beginTransitionOut((function(){jt.isPaused=!1;var t=y.game.loader.resources[S.UI.Stage].data.pigMovedMapData;jt.resetTiles(t),jt.saveData.mapData=t,jt.saveProgressToDB();var e=jt.roomObjects.get("pig");if(e){var i=c.P6Y.kN["room_object/pig2.png"],o=c.P6Y.kN["room_object/clock_12_00.png"];e.sprite.texture=i,jt.saveRoomObjectToDB(S.RoomObjects.PIG,Ye.TextureName,"room_object/pig2.png"),n.sprite.texture=o,jt.saveRoomObjectToDB(S.RoomObjects.CLOCK,Ye.TextureName,"room_object/clock_12_00.png"),e.position.set(40,565),jt.saveRoomObjectToDB(S.RoomObjects.PIG,Ye.Position,[e.position.x,e.position.y]),e.downTiles=[[9,1]],jt.saveRoomObjectToDB(S.RoomObjects.PIG,Ye.DownTiles,e.downTiles),e.messageIds=["pig_message_2"],jt.saveRoomObjectToDB(S.RoomObjects.PIG,Ye.MessageIds,e.messageIds),jt.spawnMessageWindow(["moved_pig"]),jt.beginTransitionIn((function(){})),n.messageIds.pop(),n.messageIds.pop(),jt.saveRoomObjectToDB(S.RoomObjects.CLOCK,Ye.MessageIds,n.messageIds)}}),!1)}}},i.onPlayerEntityWalked=function(t){switch(t.walkDirection){case mt.UP:this.player.requestAnimation(S.AnimationTypes.Player.WALKUP);break;case mt.DOWN:this.player.requestAnimation(S.AnimationTypes.Player.WALKDOWN);break;case mt.LEFT:this.player.requestAnimation(S.AnimationTypes.Player.WALKLEFT);break;case mt.RIGHT:this.player.requestAnimation(S.AnimationTypes.Player.WALKRIGHT)}if(this.tiles.forEach((function(e){t.positionRow===e.tilePosition[0]&&t.positionColumn===e.tilePosition[1]?e.interactive=!1:e.interactive=!0})),t.walkDirection===mt.UP||t.walkDirection===mt.DOWN?this.player.sprite.y=this.player.spawnedPosition.y+t.distanceRow:this.player.sprite.x=this.player.spawnedPosition.x+t.distanceColumn,3===t.positionRow&&4===t.positionColumn||3===t.positionRow&&5===t.positionColumn||3===t.positionRow&&6===t.positionColumn||4===t.positionRow&&4===t.positionColumn||4===t.positionRow&&5===t.positionColumn||4===t.positionRow&&6===t.positionColumn||5===t.positionRow&&5===t.positionColumn){if(0===this.player.sprite.zIndex)return;this.player.sprite.zIndex=0,this.sortChildren()}else{if(2===this.player.sprite.zIndex)return;this.player.sprite.zIndex=2,this.sortChildren()}},i.onTileTapped=function(t){var e=this;if(!this.isPaused&&!this.messageWindow){var n=!1;this.tiles.forEach((function(i){i.isActive&&t.tilePosition[0]===i.tilePosition[0]&&t.tilePosition[1]===i.tilePosition[1]?(e.gameLogic.requestWalk(t.tilePosition),t.toggleFrame(),n=!0):i.isActive&&(i.toggleFrame(),n=!0)})),!1===n&&t.toggleFrame()}},i.initRoomObject=function(t){var e=!0,n=!1,i=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=this.roomObjects.get(s.id);if(!a)return;if(s.downTiles&&(a.downTiles=s.downTiles),s.messageIds&&(a.messageIds=s.messageIds),s.position&&a.position.set(s.position[0],s.position[1]),s.textureName){var u=c.P6Y.kN[s.textureName];a.sprite.texture=u}void 0!==s.visible&&(a.sprite.visible=s.visible)}}catch(l){n=!0,i=l}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}},i.initTiles=function(t,e){for(var n=this,i=function(i){for(var r=n,s=function(n){var o=r,s=a[n],c=new xt(s,[i,n],e);c.position.set(n*r.tileSize,i*r.tileSize),1!==t.mapData[i][n]&&(c.touchable=!0,c.interactive=!0),c.on("pointertap",(function(){o.onTileTapped(c)}));var u=i.toString(),l=n.toString();r.tiles.set(Number(u+l),c),r.addChild(c)},a=o[i],c=0;c<a.length;c++)s(c)},o=t.tileData,r=0;r<o.length;r++)i(r)},i.onGameOver=function(){var t=this;this.isPaused=!0,this.menu.visible=!1,this.soundOption.visible=!1,this.deleteSaveData(),m.destroySound(S.Audio.Bgm.EscapeBGM),this.beginTransitionOut((function(){m.playBgm(S.Audio.Bgm.EndingBGM,6),t.spawnMessageWindow(["serching","wake_message_1","wake_message_2","wake_message_3","thanks_message",["back_to_title_2"]])})),this.state=St.FINISHED},i.getCustomUiGraphFactory=function(t){return"room_object"===t?new Vt:"text_option"===t||"menu_text_option"===t?new se:"sprite_option"===t?new Pe:"item_panel"===t?new Ke:null},i.prepareUiGraphContainer=function(t){var e=!0,n=!1,i=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=V.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var c=a.createUiNodeByGraphElement(s);c&&(s.events&&a.attachUiEventByGraphElement(s.events,c,this),"room_object"===s.type?(this.roomObjects.set(s.id,c),this.saveData.roomObject.push({id:s.id})):"message"===s.type?this.messages.set(s.id,c):"menu_text"===s.type||"menu_text_option"===s.type?this.menuTexts.set(s.id,c):"text_option"===s.type||"sprite_option"===s.type?this.options.set(s.id,c):"item_panel"===s.type?this.itemPanels.push(c):this.uiGraph.set(s.id,c),"room_object"===s.type&&this.uiGraphContainer.addChild(c))}}}catch(u){n=!0,i=u}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}},i.resetTiles=function(t){for(var e=0;e<t.length;e++)for(var n=t[e],i=0;i<n.length;i++){var o=t[e][i],r=e.toString(),s=i.toString(),a=this.tiles.get(Number(r+s));a&&(0===o?(a.touchable=!0,a.interactive=!0):(a.touchable=!1,a.interactive=!1))}},i.showTitleScene=function(){m.paused=!1,m.sceneIsPaused=!1,this.destroySound(),y.loadScene(new cn)},i.saveRoomObjectToDB=function(t,e,n){var i=!0,o=!1,r=void 0;try{for(var s,a=this.saveData.roomObject[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var c=s.value;if(c.id===t)switch(e){case"downTiles":c.downTiles=n;break;case"messageIds":c.messageIds=n;break;case"position":c.position=n;break;case"textureName":c.textureName=n;break;case"visible":c.visible=n}}}catch(u){o=!0,r=u}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}this.saveProgressToDB()},i.saveProgressToDB=function(){p.put("saveData",this.saveData)},i.loadSaveDataFromDB=function(t,e){var n=this;p.get("saveData",(function(i){if(i){if(n.saveData=i,n.initRoomObject(n.saveData.roomObject),void 0!==n.saveData.mapData&&n.resetTiles(n.saveData.mapData),0!==n.saveData.playerItems.length&&n.menu.updateItemPanels(n.saveData.playerItems),0!==n.saveData.code.length&&(n.correctCode=n.saveData.code),!n.saveData.isBalloonExist){var o=n.tiles.get(65);if(!o)return;o.tileSprite.texture=c.P6Y.kN["stage/floor.png"]}}else{n.spawnMessageWindow(["start_escape"]);for(var r=0;r<3;r++){var s=Math.floor(10*Math.random());n.correctCode.push(s)}n.saveData.code=n.correctCode,n.saveProgressToDB()}n.initCode(),n.gameLogic.init({delegator:n,stageMaster:t,roomObjectMaster:e,saveData:n.saveData}),n.transitionIn.isFinished()?n.state=St.READY:n.state=St.RESOURCE_LOADED}))},i.saveBgmVolumeToDB=function(t){p.put("bgmVolume",t)},i.saveSeVolumeToDB=function(t){p.put("seVolume",t)},i.deleteSaveData=function(){p.delete("saveData")},n}($);function en(t,e,n){return(en="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=nn(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function nn(t){return(nn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function on(t,e){return!e||"object"!==sn(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function rn(t,e){return(rn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sn=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function an(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=nn(t);if(e){var o=nn(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return on(this,n)}}var cn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rn(t,e)}(n,t);var e=an(n);function n(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(t=e.call(this)).title1MoveRate=0,t.title2MoveRate=0,t.title3MoveRate=0,t.languageOption=new c.W20,t.confirmation=new c.W20,t.hasSaveData=!1,t.sceneName="title_scene",t.transitionIn=new b(1,0,-.02),t.transitionOut=new b(0,1,.02),t.loadSaveDataFromDB(),t}var i=n.prototype;return i.createInitialResourceList=function(){var t=en(nn(n.prototype),"createInitialResourceList",this).call(this);return t.push(S.Audio.Bgm.TitleBgm),t.push(S.Audio.Se.OptionTap),t},i.update=function(t){en(nn(n.prototype),"update",this).call(this,t),this.language?(this.updateTitles(),this.updateButtons()):this.elapsedFrameCount=0,90===this.elapsedFrameCount&&this.playBgmIfNeeded()},i.onResourceLoaded=function(){en(nn(n.prototype),"onResourceLoaded",this).call(this),this.setTitleMoveDistance(),this.languageOption.visible=!1,this.confirmation.visible=!1,this.uiGraphContainer.addChild(this.languageOption),this.uiGraphContainer.addChild(this.confirmation),this.addChild(this.uiGraphContainer),this.loadLanguageFromDB(),this.initSound()},i.initSound=function(){var t=y.game.loader.resources,e=[S.Audio.Se.OptionTap],n=!0,i=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var a=r.value;m.createSound(a,t[a].buffer)}}catch(c){i=!0,o=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}},i.onLanguageSelected=function(t){m.playSe(S.Audio.Se.OptionTap);var e=this.uiGraph.get("new_game"),n=this.uiGraph.get("continue"),i=this.uiGraph.get("option"),o=this.uiGraph.get("credit");e&&n&&i&&o&&(e.interactive=!0,n.interactive=!0,i.interactive=!0,o.interactive=!0,this.languageOption.visible=!1,this.language=t,this.saveLanguageToDB(t))},i.easeOutQuint=function(t){return 1-Math.pow(1-t,5)},i.updateTitles=function(){var t=this.uiGraph.get("title_1"),e=this.uiGraph.get("title_2"),n=this.uiGraph.get("title_3");t&&e&&n&&(t.position.x===this.title1MoveDistance&&e.position.x===this.title2MoveDistance&&n.position.x===this.title3MoveDistance||(t.position.x>=this.title1MoveDistance?t.position.x=this.title1MoveDistance:(this.title1MoveRate+=10/this.title1MoveDistance,t.position.x=this.title1MoveDistance*this.easeOutQuint(this.title1MoveRate)),e.position.x>=this.title2MoveDistance?e.position.x=this.title2MoveDistance:this.elapsedFrameCount>=20&&(this.title2MoveRate+=10/this.title2MoveDistance,e.position.x=this.title2MoveDistance*this.easeOutQuint(this.title2MoveRate)),n.position.x>=this.title3MoveDistance?n.position.x=this.title3MoveDistance:this.elapsedFrameCount>=40&&(this.title3MoveRate+=10/this.title3MoveDistance,n.position.x=this.title3MoveDistance*this.easeOutQuint(this.title3MoveRate))))},i.updateButtons=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),n=this.uiGraph.get("continue_2"),i=this.uiGraph.get("option"),o=this.uiGraph.get("credit");t&&e&&n&&i&&o&&(t.visible&&e.visible||n.visible&&i.visible&&o.visible||this.elapsedFrameCount>=80&&(t.visible=!0,this.hasSaveData?e.visible=!0:n.visible=!0,i.visible=!0,o.visible=!0))},i.setTitleMoveDistance=function(){var t=this.uiGraph.get("title_1"),e=this.uiGraph.get("title_2"),n=this.uiGraph.get("title_3");t&&e&&n&&(this.title1MoveDistance=320+t.width/2,this.title2MoveDistance=320+e.width/2,this.title3MoveDistance=320+n.width/2)},i.newGame=function(){this.isOver||(m.playSe(S.Audio.Se.OptionTap),this.deleteSaveData(),this.onContinueButtonTouched())},i.cancelNewGame=function(){if(!this.isOver){m.playSe(S.Audio.Se.OptionTap);var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),n=this.uiGraph.get("option"),i=this.uiGraph.get("credit");t&&e&&n&&i&&(t.interactive=!0,e.interactive=!0,n.interactive=!0,i.interactive=!0,this.confirmation.visible=!1)}},i.onNewGameButtonTouched=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(m.playSe(S.Audio.Se.OptionTap),this.hasSaveData?this.showConfirmation():this.onContinueButtonTouched())},i.onContinueButtonTouched=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(m.destroySound(S.Audio.Bgm.TitleBgm),m.playSe(S.Audio.Se.OptionTap),y.loadScene(new tn(this.language)),this.isOver=!0)},i.showOptionScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,m.playSe(S.Audio.Se.OptionTap),y.loadScene(new rt(this.language)))},i.showCreditScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,m.playSe(S.Audio.Se.OptionTap),y.loadScene(new ft))},i.showLanguageOption=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),n=this.uiGraph.get("option"),i=this.uiGraph.get("credit");t&&e&&n&&i&&(t.interactive=!1,e.interactive=!1,n.interactive=!1,i.interactive=!1,this.languageOption.visible=!0)},i.showConfirmation=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),n=this.uiGraph.get("option"),i=this.uiGraph.get("credit");t&&e&&n&&i&&(t.interactive=!1,e.interactive=!1,n.interactive=!1,i.interactive=!1,this.confirmation.visible=!0)},i.saveLanguageToDB=function(t){p.put("language",t)},i.loadLanguageFromDB=function(){var t=this;p.get("language",(function(e){if(e?t.language=e:t.showLanguageOption(),"japanese"===e){var n=t.uiGraph.get("confirm_message_english");if(!n)return;n.visible=!1}else{var i=t.uiGraph.get("confirm_message");if(!i)return;i.visible=!1}}))},i.prepareUiGraphContainer=function(t){var e=!0,n=!1,i=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=V.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var c=a.createUiNodeByGraphElement(s);c&&(s.events&&a.attachUiEventByGraphElement(s.events,c,this),this.uiGraph.set(s.id,c),"language_option_sprite"===s.type||"language_option_text"===s.type?this.languageOption.addChild(c):"confirmation_sprite"===s.type||"confirmation_text"===s.type?this.confirmation.addChild(c):this.uiGraphContainer.addChild(c))}}}catch(u){n=!0,i=u}finally{try{e||null==r.return||r.return()}finally{if(n)throw i}}},i.playBgmIfNeeded=function(){var t=S.Audio.Bgm.TitleBgm;if(!m.hasSound(t)){var e=y.game.loader.resources[t];m.createSound(t,e.buffer),m.playBgm(t,1.5)}},i.loadSaveDataFromDB=function(){var t=this;p.get("saveData",(function(e){e&&(t.hasSaveData=!0)}))},i.deleteSaveData=function(){p.delete("saveData")},n}($);function un(t,e,n){return(un="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ln(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function ln(t){return(ln=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hn(t,e){return!e||"object"!==pn(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fn(t,e){return(fn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pn=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function dn(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=ln(t);if(e){var o=ln(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return hn(this,n)}}var mn=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&fn(t,e)}(n,t);var e=dn(n);function n(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(t=e.call(this)).sceneName="start_scene",t.transitionIn=new b(1,0,-.02),t.transitionOut=new b(0,1,.02),t.interactive=!0,t.on("pointerdown",(function(){t.showTitleScene()})),t}var i=n.prototype;return i.createInitialResourceList=function(){var t=un(ln(n.prototype),"createInitialResourceList",this).call(this);return t.push(S.Audio.Se.OptionTap),t},i.update=function(t){un(ln(n.prototype),"update",this).call(this,t),this.elapsedFrameCount%40===0&&(this.startButton.visible=!this.startButton.visible)},i.onResourceLoaded=function(){un(ln(n.prototype),"onResourceLoaded",this).call(this),this.addChild(this.uiGraphContainer);var t=this.uiGraph.get("start_button");t&&(this.startButton=t,this.initSound())},i.initSound=function(){var t=y.game.loader.resources,e=[S.Audio.Se.OptionTap],n=!0,i=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var a=r.value;m.createSound(a,t[a].buffer)}}catch(c){i=!0,o=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}},i.showTitleScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,m.playSe(S.Audio.Se.OptionTap),y.loadScene(new cn))},n}($),yn=n(5933);var gn=(0,o.default)(),vn=(gn.serverRuntimeConfig,gn.publicRuntimeConfig),bn=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.startGame=function(){yn.load({custom:{families:[S.FontFamily.Default],urls:["".concat(vn.staticFolder,"/font.css")]},active:function(){t.initGame()},timeout:15e3})},t.initGame=function(){y.start({width:640,height:640,backgroundColor:0}),y.loadScene(new mn)},t}(),wn=n(7294);function On(){return(0,wn.useEffect)((function(){bn.startGame()})),(0,i.jsx)("div",{id:"play-game"})}},5933:function(t,e,n){var i;!function(){function o(t,e,n){return t.call.apply(t.bind,arguments)}function r(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function s(t,e,n){return(s=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:r).apply(null,arguments)}var a=Date.now||function(){return+new Date};function c(t,e){this.a=t,this.o=e||t,this.c=this.o.document}var u=!!window.FontFace;function l(t,e,n,i){if(e=t.c.createElement(e),n)for(var o in n)n.hasOwnProperty(o)&&("style"==o?e.style.cssText=n[o]:e.setAttribute(o,n[o]));return i&&e.appendChild(t.c.createTextNode(i)),e}function h(t,e,n){(t=t.c.getElementsByTagName(e)[0])||(t=document.documentElement),t.insertBefore(n,t.lastChild)}function f(t){t.parentNode&&t.parentNode.removeChild(t)}function p(t,e,n){e=e||[],n=n||[];for(var i=t.className.split(/\s+/),o=0;o<e.length;o+=1){for(var r=!1,s=0;s<i.length;s+=1)if(e[o]===i[s]){r=!0;break}r||i.push(e[o])}for(e=[],o=0;o<i.length;o+=1){for(r=!1,s=0;s<n.length;s+=1)if(i[o]===n[s]){r=!0;break}r||e.push(i[o])}t.className=e.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function d(t,e){for(var n=t.className.split(/\s+/),i=0,o=n.length;i<o;i++)if(n[i]==e)return!0;return!1}function m(t,e,n){function i(){a&&o&&r&&(a(s),a=null)}e=l(t,"link",{rel:"stylesheet",href:e,media:"all"});var o=!1,r=!0,s=null,a=n||null;u?(e.onload=function(){o=!0,i()},e.onerror=function(){o=!0,s=Error("Stylesheet failed to load"),i()}):setTimeout((function(){o=!0,i()}),0),h(t,"head",e)}function y(t,e,n,i){var o=t.c.getElementsByTagName("head")[0];if(o){var r=l(t,"script",{src:e}),s=!1;return r.onload=r.onreadystatechange=function(){s||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(s=!0,n&&n(null),r.onload=r.onreadystatechange=null,"HEAD"==r.parentNode.tagName&&o.removeChild(r))},o.appendChild(r),setTimeout((function(){s||(s=!0,n&&n(Error("Script load timeout")))}),i||5e3),r}return null}function g(){this.a=0,this.c=null}function v(t){return t.a++,function(){t.a--,w(t)}}function b(t,e){t.c=e,w(t)}function w(t){0==t.a&&t.c&&(t.c(),t.c=null)}function O(t){this.a=t||"-"}function S(t,e){this.c=t,this.f=4,this.a="n";var n=(e||"n4").match(/^([nio])([1-9])$/i);n&&(this.a=n[1],this.f=parseInt(n[2],10))}function _(t){var e=[];t=t.split(/,\s*/);for(var n=0;n<t.length;n++){var i=t[n].replace(/['"]/g,"");-1!=i.indexOf(" ")||/^\d/.test(i)?e.push("'"+i+"'"):e.push(i)}return e.join(",")}function T(t){return t.a+t.f}function E(t){var e="normal";return"o"===t.a?e="oblique":"i"===t.a&&(e="italic"),e}function R(t){var e=4,n="n",i=null;return t&&((i=t.match(/(normal|oblique|italic)/i))&&i[1]&&(n=i[1].substr(0,1).toLowerCase()),(i=t.match(/([1-9]00|normal|bold)/i))&&i[1]&&(/bold/i.test(i[1])?e=7:/[1-9]00/.test(i[1])&&(e=parseInt(i[1].substr(0,1),10)))),n+e}function I(t,e){this.c=t,this.f=t.o.document.documentElement,this.h=e,this.a=new O("-"),this.j=!1!==e.events,this.g=!1!==e.classes}function j(t){if(t.g){var e=d(t.f,t.a.c("wf","active")),n=[],i=[t.a.c("wf","loading")];e||n.push(t.a.c("wf","inactive")),p(t.f,n,i)}x(t,"inactive")}function x(t,e,n){t.j&&t.h[e]&&(n?t.h[e](n.c,T(n)):t.h[e]())}function C(){this.c={}}function P(t,e){this.c=t,this.f=e,this.a=l(this.c,"span",{"aria-hidden":"true"},this.f)}function A(t){h(t.c,"body",t.a)}function B(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+_(t.c)+";font-style:"+E(t)+";font-weight:"+t.f+"00;"}function D(t,e,n,i,o,r){this.g=t,this.j=e,this.a=i,this.c=n,this.f=o||3e3,this.h=r||void 0}function N(t,e,n,i,o,r,s){this.v=t,this.B=e,this.c=n,this.a=i,this.s=s||"BESbswy",this.f={},this.w=o||3e3,this.u=r||null,this.m=this.j=this.h=this.g=null,this.g=new P(this.c,this.s),this.h=new P(this.c,this.s),this.j=new P(this.c,this.s),this.m=new P(this.c,this.s),t=B(t=new S(this.a.c+",serif",T(this.a))),this.g.a.style.cssText=t,t=B(t=new S(this.a.c+",sans-serif",T(this.a))),this.h.a.style.cssText=t,t=B(t=new S("serif",T(this.a))),this.j.a.style.cssText=t,t=B(t=new S("sans-serif",T(this.a))),this.m.a.style.cssText=t,A(this.g),A(this.h),A(this.j),A(this.m)}O.prototype.c=function(t){for(var e=[],n=0;n<arguments.length;n++)e.push(arguments[n].replace(/[\W_]+/g,"").toLowerCase());return e.join(this.a)},D.prototype.start=function(){var t=this.c.o.document,e=this,n=a(),i=new Promise((function(i,o){!function r(){a()-n>=e.f?o():t.fonts.load(function(t){return E(t)+" "+t.f+"00 300px "+_(t.c)}(e.a),e.h).then((function(t){1<=t.length?i():setTimeout(r,25)}),(function(){o()}))}()})),o=null,r=new Promise((function(t,n){o=setTimeout(n,e.f)}));Promise.race([r,i]).then((function(){o&&(clearTimeout(o),o=null),e.g(e.a)}),(function(){e.j(e.a)}))};var k={D:"serif",C:"sans-serif"},U=null;function M(){if(null===U){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);U=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))}return U}function G(t,e,n){for(var i in k)if(k.hasOwnProperty(i)&&e===t.f[k[i]]&&n===t.f[k[i]])return!0;return!1}function W(t){var e,n=t.g.a.offsetWidth,i=t.h.a.offsetWidth;(e=n===t.f.serif&&i===t.f["sans-serif"])||(e=M()&&G(t,n,i)),e?a()-t.A>=t.w?M()&&G(t,n,i)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?L(t,t.v):L(t,t.B):function(t){setTimeout(s((function(){W(this)}),t),50)}(t):L(t,t.v)}function L(t,e){setTimeout(s((function(){f(this.g.a),f(this.h.a),f(this.j.a),f(this.m.a),e(this.a)}),t),0)}function F(t,e,n){this.c=t,this.a=e,this.f=0,this.m=this.j=!1,this.s=n}N.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=a(),W(this)};var H=null;function V(t){0==--t.f&&t.j&&(t.m?((t=t.a).g&&p(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),x(t,"active")):j(t.a))}function z(t){this.j=t,this.a=new C,this.h=0,this.f=this.g=!0}function K(t,e,n,i,o){var r=0==--t.h;(t.f||t.g)&&setTimeout((function(){var t=o||null,a=i||{};if(0===n.length&&r)j(e.a);else{e.f+=n.length,r&&(e.j=r);var c,u=[];for(c=0;c<n.length;c++){var l=n[c],h=a[l.c],f=e.a,d=l;if(f.g&&p(f.f,[f.a.c("wf",d.c,T(d).toString(),"loading")]),x(f,"fontloading",d),f=null,null===H)if(window.FontFace){d=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var m=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);H=d?42<parseInt(d[1],10):!m}else H=!1;f=H?new D(s(e.g,e),s(e.h,e),e.c,l,e.s,h):new N(s(e.g,e),s(e.h,e),e.c,l,e.s,t,h),u.push(f)}for(c=0;c<u.length;c++)u[c].start()}}),0)}function Y(t,e){this.c=t,this.a=e}function q(t,e){this.c=t,this.a=e}function J(t,e){this.c=t||X,this.a=[],this.f=[],this.g=e||""}F.prototype.g=function(t){var e=this.a;e.g&&p(e.f,[e.a.c("wf",t.c,T(t).toString(),"active")],[e.a.c("wf",t.c,T(t).toString(),"loading"),e.a.c("wf",t.c,T(t).toString(),"inactive")]),x(e,"fontactive",t),this.m=!0,V(this)},F.prototype.h=function(t){var e=this.a;if(e.g){var n=d(e.f,e.a.c("wf",t.c,T(t).toString(),"active")),i=[],o=[e.a.c("wf",t.c,T(t).toString(),"loading")];n||i.push(e.a.c("wf",t.c,T(t).toString(),"inactive")),p(e.f,i,o)}x(e,"fontinactive",t),V(this)},z.prototype.load=function(t){this.c=new c(this.j,t.context||this.j),this.g=!1!==t.events,this.f=!1!==t.classes,function(t,e,n){var i=[],o=n.timeout;!function(t){t.g&&p(t.f,[t.a.c("wf","loading")]),x(t,"loading")}(e);i=function(t,e,n){var i,o=[];for(i in e)if(e.hasOwnProperty(i)){var r=t.c[i];r&&o.push(r(e[i],n))}return o}(t.a,n,t.c);var r=new F(t.c,e,o);for(t.h=i.length,e=0,n=i.length;e<n;e++)i[e].load((function(e,n,i){K(t,r,e,n,i)}))}(this,new I(this.c,t),t)},Y.prototype.load=function(t){function e(){if(r["__mti_fntLst"+i]){var n,o=r["__mti_fntLst"+i](),s=[];if(o)for(var a=0;a<o.length;a++){var c=o[a].fontfamily;void 0!=o[a].fontStyle&&void 0!=o[a].fontWeight?(n=o[a].fontStyle+o[a].fontWeight,s.push(new S(c,n))):s.push(new S(c))}t(s)}else setTimeout((function(){e()}),50)}var n=this,i=n.a.projectId,o=n.a.version;if(i){var r=n.c.o;y(this.c,(n.a.api||"https://fast.fonts.net/jsapi")+"/"+i+".js"+(o?"?v="+o:""),(function(o){o?t([]):(r["__MonotypeConfiguration__"+i]=function(){return n.a},e())})).id="__MonotypeAPIScript__"+i}else t([])},q.prototype.load=function(t){var e,n,i=this.a.urls||[],o=this.a.families||[],r=this.a.testStrings||{},s=new g;for(e=0,n=i.length;e<n;e++)m(this.c,i[e],v(s));var a=[];for(e=0,n=o.length;e<n;e++)if((i=o[e].split(":"))[1])for(var c=i[1].split(","),u=0;u<c.length;u+=1)a.push(new S(i[0],c[u]));else a.push(new S(i[0]));b(s,(function(){t(a,r)}))};var X="https://fonts.googleapis.com/css";function Z(t){this.f=t,this.a=[],this.c={}}var $={latin:"BESbswy","latin-ext":"\xe7\xf6\xfc\u011f\u015f",cyrillic:"\u0439\u044f\u0416",greek:"\u03b1\u03b2\u03a3",khmer:"\u1780\u1781\u1782",Hanuman:"\u1780\u1781\u1782"},Q={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},tt={i:"i",italic:"i",n:"n",normal:"n"},et=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function nt(t,e){this.c=t,this.a=e}var it={Arimo:!0,Cousine:!0,Tinos:!0};function ot(t,e){this.c=t,this.a=e}function rt(t,e){this.c=t,this.f=e,this.a=[]}nt.prototype.load=function(t){var e=new g,n=this.c,i=new J(this.a.api,this.a.text),o=this.a.families;!function(t,e){for(var n=e.length,i=0;i<n;i++){var o=e[i].split(":");3==o.length&&t.f.push(o.pop());var r="";2==o.length&&""!=o[1]&&(r=":"),t.a.push(o.join(r))}}(i,o);var r=new Z(o);!function(t){for(var e=t.f.length,n=0;n<e;n++){var i=t.f[n].split(":"),o=i[0].replace(/\+/g," "),r=["n4"];if(2<=i.length){var s;if(s=[],a=i[1])for(var a,c=(a=a.split(",")).length,u=0;u<c;u++){var l;if((l=a[u]).match(/^[\w-]+$/))if(null==(h=et.exec(l.toLowerCase())))l="";else{if(l=null==(l=h[2])||""==l?"n":tt[l],null==(h=h[1])||""==h)h="4";else var h=Q[h]||(isNaN(h)?"4":h.substr(0,1));l=[l,h].join("")}else l="";l&&s.push(l)}0<s.length&&(r=s),3==i.length&&(s=[],0<(i=(i=i[2])?i.split(","):s).length&&(i=$[i[0]])&&(t.c[o]=i))}for(t.c[o]||(i=$[o])&&(t.c[o]=i),i=0;i<r.length;i+=1)t.a.push(new S(o,r[i]))}}(r),m(n,function(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var e=t.a.length,n=[],i=0;i<e;i++)n.push(t.a[i].replace(/ /g,"+"));return e=t.c+"?family="+n.join("%7C"),0<t.f.length&&(e+="&subset="+t.f.join(",")),0<t.g.length&&(e+="&text="+encodeURIComponent(t.g)),e}(i),v(e)),b(e,(function(){t(r.a,r.c,it)}))},ot.prototype.load=function(t){var e=this.a.id,n=this.c.o;e?y(this.c,(this.a.api||"https://use.typekit.net")+"/"+e+".js",(function(e){if(e)t([]);else if(n.Typekit&&n.Typekit.config&&n.Typekit.config.fn){e=n.Typekit.config.fn;for(var i=[],o=0;o<e.length;o+=2)for(var r=e[o],s=e[o+1],a=0;a<s.length;a++)i.push(new S(r,s[a]));try{n.Typekit.load({events:!1,classes:!1,async:!0})}catch(c){}t(i)}}),2e3):t([])},rt.prototype.load=function(t){var e=this.f.id,n=this.c.o,i=this;e?(n.__webfontfontdeckmodule__||(n.__webfontfontdeckmodule__={}),n.__webfontfontdeckmodule__[e]=function(e,n){for(var o=0,r=n.fonts.length;o<r;++o){var s=n.fonts[o];i.a.push(new S(s.name,R("font-weight:"+s.weight+";font-style:"+s.style)))}t(i.a)},y(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(t){return t.o.location.hostname||t.a.location.hostname}(this.c)+"/"+e+".js",(function(e){e&&t([])}))):t([])};var st=new z(window);st.a.c.custom=function(t,e){return new q(e,t)},st.a.c.fontdeck=function(t,e){return new rt(e,t)},st.a.c.monotype=function(t,e){return new Y(e,t)},st.a.c.typekit=function(t,e){return new ot(e,t)},st.a.c.google=function(t,e){return new nt(e,t)};var at={load:s(st.load,st)};void 0===(i=function(){return at}.call(e,n,e,t))||(t.exports=i)}()}}]);