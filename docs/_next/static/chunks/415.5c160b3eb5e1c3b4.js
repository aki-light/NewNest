"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[415],{415:function(t,e,i){i.r(e),i.d(e,{default:function(){return yi}});var n=i(5893),o=(0,i(1752).default)(),r=(o.serverRuntimeConfig,o.publicRuntimeConfig),s=Object.freeze({ResourceBaseUrl:"".concat(r.staticFolder,"/game_sources/escape_game_1/assets/")}),a=i(8866),u=i(3631);function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.loop=!1,this.played=!1,this.paused=!1,this.offset=0,this.playedAt=0,this.volumeRate=void 0,d.sharedContext&&(this.buffer=e,this.gainNode=d.sharedContext.createGain())}var e,i,n,o=t.prototype;return o.play=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,n=this,o=d.sharedContext;o&&(this.loop=t,this.source=o.createBufferSource(),this.source.loop=this.loop,this.source.loopStart=0,this.source.loopEnd=this.buffer.duration,this.source.buffer=this.buffer,this.source.onended=function(){return n.stop()},i?(this.gainNode.gain.value=t?d.bgmVolume*i:d.seVolume*i,this.volumeRate=i):this.gainNode.gain.value=t?d.bgmVolume:d.seVolume,this.gainNode.connect(o.destination),this.source.connect(this.gainNode),this.source.start(0,e),this.played=!0,this.playedAt=o.currentTime-e,this.paused=!1)},o.stop=function(){if(this.source&&this.played){this.source.disconnect();try{this.source.buffer=null}catch(t){}this.source.onended=null,this.source=null,this.paused=!1}},o.pause=function(){!this.paused&&this.played&&this.source&&(this.offset=this.elapsedTime,this.stop(),this.paused=!0)},o.resume=function(){this.paused&&this.played&&(this.play(this.loop,this.offset,this.volumeRate),this.paused=!1)},o.isPosed=function(){return this.paused},e=t,(i=[{key:"volume",get:function(){return this.gainNode?this.gainNode.gain.value:-1},set:function(t){this.gainNode&&(this.gainNode.gain.value=t)}},{key:"elapsedTime",get:function(){if(this.paused)return this.offset;var t=d.sharedContext;if(!this.source||!t)return 0;var e=t.currentTime-this.playedAt;if(this.loop){var i=this.source.loopEnd-this.source.loopStart;if(e>i)return e%i}return e}}])&&c(e.prototype,i),n&&c(e,n),t}();var h=window.indexedDB||window.webkitIndexedDB,p=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.init=function(e,i){if(!h)throw new Error("indexed db is not supported");var n=h.open(t.dbName,t.dbVersion);n.onupgradeneeded=function(e){t.upgradeDB(e)},n.onsuccess=function(e){var n=e.target.result;t.db=n,i()},n.onerror=function(t){return e(t)}},t.put=function(e,i,n,o){var r=t.getStoreObject();if(r){var s=t.createRecordObject(e,i),a=r.put(s);n&&(a.onsuccess=function(t){n(t)}),o&&(a.onerror=function(t){o(t)})}else o&&o()},t.get=function(e,i,n){var o=t.getStoreObject();if(o){var r=o.get(e);r.onsuccess=function(t){var e=t.target.result;e?i(e.value,e.key):i(void 0,void 0)},n&&(r.onerror=function(t){n(t)})}else n&&n()},t.delete=function(e,i,n){var o=t.getStoreObject();if(o){var r=o.delete(e);i&&(r.onsuccess=function(t){i(t)}),n&&(r.onerror=function(t){n(t)})}else n&&n()},t.clear=function(e,i){var n=t.getStoreObject();if(n){var o=n.clear();e&&(o.onsuccess=function(t){e(t)}),i&&(o.onerror=function(t){i(t)})}else i&&i()},t.upgradeDB=function(e){var i=e.target.result,n=t.storeIndex,o=t.storeName;i.createObjectStore(o,{keyPath:n}).createIndex(n,n,{unique:!0})},t.getStoreObject=function(){if(!t.db)return null;var e=t.storeName;return t.db.transaction(e,"readwrite").objectStore(e)},t.createRecordObject=function(t,e){return{key:t,value:e}},t}();function f(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}p.dbName="escape-game-db",p.dbVersion=1,p.storeName="escape-game-store",p.storeIndex="key",p.db=null;var d=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i,n;return t.init=function(e){if(e)t.context=e;else{var i=window.AudioContext||window.webkitAudioContext;t.context=new i}var n=(0,u.qY)();n&&(t.setSoundInitializeEvent(n),t.useWebAudio(),t.setWindowLifeCycleEvent(n))},t.update=function(e){if(t.sharedContext){var i=t.killingSounds;if(i.length>0){var n=[],o=!0,r=!1,s=void 0;try{for(var a,u=i[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;t.sharedContext.currentTime>=c.endAt?c.sound.stop():n.push(c)}}catch(l){r=!0,s=l}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}t.killingSounds=n}}},t.useWebAudio=function(){if(!t.webAudioInitialized){var e=t.supportedExtensions,i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var u=r.value,c=a.kCJ;c.setExtensionXhrType(u,c.XHR_RESPONSE_TYPE.BUFFER),c.setExtensionLoadType(u,c.LOAD_TYPE.XHR)}}catch(l){n=!0,o=l}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}m.game.loader.use(t.parsingMiddleware()),t.webAudioInitialized=!0}},t.parsingMiddleware=function(){return function(e,i){var n,o=t.supportedExtensions,r=e.url.split(".")[1];r&&-1!==o.indexOf(r)?null===(n=t.sharedContext)||void 0===n||n.decodeAudioData(e.data,(function(t){e.buffer=t,i()})):i()}},t.setSoundInitializeEvent=function(e){var i,n=void 0===document.ontouchend?"mousedown":"touched",o=e.version?e.version.split(".")[0]:"0";if("chrome"===e.name&&Number.parseInt(o,10)>=66)i=function(){t.sharedContext&&t.sharedContext.resume(),document.body.removeEventListener(n,i)};else{if("safari"!==e.name)return;i=function(){if(t.sharedContext){var e=t.sharedContext.createBufferSource();e.buffer=t.sharedContext.createBuffer(1,1,44100),e.connect(t.sharedContext.destination),e.start(0),e.disconnect()}document.body.removeEventListener(n,i)}}document.body.addEventListener(n,i)},t.setWindowLifeCycleEvent=function(e){"safari"===e.name?document.addEventListener("webkitvisibilitychange",(function(){document.webkitHidden?t.pauseBgm():t.resumeBgm()})):document.addEventListener("visibilitychange",(function(){document.hidden?t.pauseBgm():t.resumeBgm()}))},t.registerSound=function(e,i){t.managedSounds.set(e,i)},t.unregisterSound=function(e){t.managedSounds.delete(e)},t.getSound=function(e){return t.managedSounds.get(e)},t.createSound=function(e,i){var n=new l(i);return t.registerSound(e,n),n},t.hasSound=function(e){return t.managedSounds.has(e)},t.destroySound=function(e){var i=this.getSound(e);t.unregisterSound(e),null===i||void 0===i||i.stop()},t.pauseBgm=function(){t.paused||(t.paused=!0,t.managedSounds.forEach((function(t){t.pause()})))},t.resumeBgm=function(){t.sceneIsPaused||t.paused&&(t.paused=!1,t.managedSounds.forEach((function(t){t.resume()})))},t.fade=function(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.sharedContext){var r=t.sharedContext.currentTime+n;e.gainNode.gain.exponentialRampToValueAtTime(i,r),o&&t.killingSounds.push({sound:e,endAt:r})}},t.playBgm=function(e,i){var n=t.getSound(e);null===n||void 0===n||n.play(!0,0,i)},t.stopBgm=function(e){var i=t.getSound(e);null===i||void 0===i||i.stop()},t.playSe=function(e){var i=t.getSound(e);null===i||void 0===i||i.play()},t.setSoundVolume=function(e,i){t.managedSounds.forEach((function(t){t.loop?t.volume=e:t.volume=i}))},t.loadSoundOptionFromDB=function(){p.get("bgmVolume",(function(e){t.bgmVolume=0===e?0:e||.05})),p.get("seVolume",(function(e){t.seVolume=0===e?0:e||.5}))},e=t,n=[{key:"sharedContext",get:function(){return t.context}}],(i=null)&&f(e.prototype,i),n&&f(e,n),t}();d.supportedExtensions=["mp3"],d.webAudioInitialized=!1,d.context=null,d.paused=!1,d.killingSounds=[],d.managedSounds=new Map,d.sceneIsPaused=!1;var m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.start=function(e){t.game=new a.MxU(e),p.init((function(t){throw new Error("indexed db could not be initialized")}),(function(){d.loadSoundOptionFromDB()})),d.init();var i=document.getElementById("play-game");i&&(i.appendChild(t.game.view),t.game.loader.baseUrl=s.ResourceBaseUrl,t.game.ticker.add((function(e){var i;null===(i=t.currentScene)||void 0===i||i.update(e),d.update(e)})),t.resizeCanvas(),window.addEventListener("resize",t.resizeCanvas))},t.transitionInIfPossible=function(e){var i;return!(!t.sceneResourceLoaded||!t.sceneTransitionOutFinished)&&(null===(i=t.currentScene)||void 0===i||i.destroy(),t.currentScene=e,t.game.stage.addChild(e),e.beginTransitionIn((function(){})),!0)},t.loadScene=function(e){t.currentScene?(t.sceneResourceLoaded=!1,t.sceneTransitionOutFinished=!1,e.beginLoadResource((function(){t.sceneResourceLoaded=!0,t.transitionInIfPossible(e)})),t.currentScene.beginTransitionOut((function(){t.sceneTransitionOutFinished=!0,t.transitionInIfPossible(e)}))):(t.sceneTransitionOutFinished=!0,e.beginLoadResource((function(){t.sceneResourceLoaded=!0,t.transitionInIfPossible(e)})))},t.resizeCanvas=function(){var e,i,n=t.game,o=n.renderer,r=o.width/o.height;window.innerWidth/window.innerHeight>r?(e=window.innerHeight*(o.width/o.height),i=window.innerHeight):(e=window.innerWidth,i=window.innerWidth*(o.height/o.width)),(e>=500||i>=500)&&(e=500,i=500),n.view.style.width="".concat(e-20,"px"),n.view.style.height="".concat(i-20,"px")},t}();m.sceneTransitionOutFinished=!0,m.sceneResourceLoaded=!1;var y=i(4051),g=i.n(y);var v=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.container=new a.W20,this.overlay=new a.TCu,this.transitionBegan=!1,this.transitionFinished=!1,this.onTransitionFinished=function(){},this.afterFinishedVisible=!1,this.alphaFrom=e,this.alphaTo=i,this.alphaProgress=n;var o=m.game.view.width,r=m.game.view.height;this.overlay.beginFill(0),this.overlay.moveTo(0,0),this.overlay.lineTo(o,0),this.overlay.lineTo(o,r),this.overlay.lineTo(0,r),this.overlay.endFill(),this.overlay.alpha=this.alphaFrom,this.container.addChild(this.overlay)}var e=t.prototype;return e.getContainer=function(){return this.container},e.begin=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.afterFinishedVisible=t,this.container.visible=!0,this.overlay.alpha=this.alphaFrom,this.transitionBegan=!0,this.transitionFinished=!1},e.isBegan=function(){return this.transitionBegan},e.isFinished=function(){return this.transitionFinished},e.isActive=function(){return this.isBegan()&&!this.isFinished()},e.update=function(t){this.alphaTo<=this.alphaFrom&&this.overlay.alpha<=this.alphaTo||this.alphaTo>=this.alphaFrom&&this.overlay.alpha>=this.alphaTo?(this.afterFinishedVisible||(this.container.visible=!1),this.transitionBegan=!1,this.onTransitionFinished(),this.transitionFinished=!0):this.overlay.alpha+=this.alphaProgress},e.setCallback=function(t){this.onTransitionFinished=t},t}(),b=Object.freeze({NOTHING:0,CAR_KEY:1,DESK_KEY:2,BANANA:3,PENCIL:4,NAIL:5,SALT:6,TIN_STATUE:7,COIN:8,CROSSBOW:9,DETERGENT:10,HAND_MIRROR:11,DVD:12,FROZEN_BANANA:13,SHARPENED_PENCIL:14}),w=Object.freeze({NormalFloor:0,NormalWall:1,TileWithShadow:2}),O=Object.freeze({UI:{SceneUiGraph:function(t){return"ui_graph/".concat(t,".json")},EscapeSceneMessage:"ui_graph/escape_scene_message.json",EscapeSceneEnglishMessage:"ui_graph/escape_scene_message_english.json",EscapeSceneOption:"ui_graph/escape_scene_option.json",EscapeSceneEnglishOption:"ui_graph/escape_scene_option_english.json",EscapeSceneRoomObject:"ui_graph/escape_scene_room_object.json",Stage:"master/stage_master.json",PlayerAnimation:"master/player_animation_master.json",RoomObjectMaster:"master/room_object_master.json",Player:"player/player.json",TileFrame:"stage/tile_frame.png",Tiles:["stage/floor.png","stage/wall.png","stage/floor_with_shadow.png"],Items:["items/tin_statue.png","items/coin.png","items/banana.png","items/frozen_banana.png","items/salt.png","items/desk_key.png","items/pencil.png","items/sharpened_pencil.png","items/hand_mirror.png","items/detergent.png","items/car_key.png","items/crossbow.png","items/nail.png","items/dvd.png"],RoomObjects:["room_object/mirror.png","room_object/chair.png","room_object/pig2.png","room_object/clock_12_00.png"],MessageWindow:"ui/message_window.png",OptionFrame:"ui/option_frame.png",ItemSelectFrame:"ui/item_select_frame.png",ItemPanelFrame:"ui/item_panel_frame.png",MenuBar:"ui/menu_bar.png",MenuButton:"ui/menu_button.png"},Dynamic:{items:function(t){switch(t){case b.NOTHING:return"items/no_item.png";case b.TIN_STATUE:return"items/tin_statue.png";case b.COIN:return"items/coin.png";case b.BANANA:return"items/banana.png";case b.FROZEN_BANANA:return"items/frozen_banana.png";case b.SALT:return"items/salt.png";case b.PENCIL:return"items/pencil.png";case b.SHARPENED_PENCIL:return"items/sharpened_pencil.png";case b.NAIL:return"items/nail.png";case b.HAND_MIRROR:return"items/hand_mirror.png";case b.DVD:return"items/dvd.png";case b.DETERGENT:return"items/detergent.png";case b.DESK_KEY:return"items/desk_key.png";case b.CROSSBOW:return"items/crossbow.png";case b.CAR_KEY:return"items/car_key.png";default:return""}},tiles:function(t){switch(t){case w.NormalFloor:return"stage/floor.png";case w.NormalWall:return"stage/wall.png";case w.TileWithShadow:return"stage/floor_with_shadow.png";default:return""}}},AnimationTypes:{Player:Object.freeze({WAIT:"wait",WALKUP:"walk_up",WALKDOWN:"walk_down",WALKLEFT:"walk_left",WALKRIGHT:"walk_right",CHACKUP:"chack_up",CHACKDOWN:"chack_down",CHACKLEFT:"chack_left",CHACKRIGHT:"chack_right"})},SoundOptionIds:["sound_option_frame","bgm_volume","se_volume","bgm","se","bgm_volume_up","bgm_volume_down","se_volume_up","se_volume_down"],PinPadIds:["pin_pad","code_first","code_second","code_third","pad_cancel","pad_enter","pad_0","pad_1","pad_2","pad_3","pad_4","pad_5","pad_6","pad_7","pad_8","pad_9"],MenuOptionIds:["item_bag","return","sound_volume"],RoomObjects:{TV:"tv",DESK:"desk",DOOR:"door",BED:"bed",GAS_STOVE:"gas_stove",VENDING_MACHINE:"vending_machine",FREEZER:"freezer",CABINET:"cabinet",BARREL:"barrel",GRINDER:"grinder",CAR:"car",BALLOON:"balloon",MIRROR:"mirror",CHAIR:"chair",CLOCK:"clock",PIG:"pig",CLOSET:"closet",SAFE:"safe",BOOK_SHELF:"book_shelf"},MessageIds:{NothingSpecial:"nothing_special",BackToTitle:"back_to_title",ContinueGame:"continue_game"},Audio:{Bgm:{EscapeBGM:"audio/escape_bgm.mp3",EndingBGM:"audio/ending_bgm.mp3",TitleBgm:"audio/title_bgm.mp3"},Se:{ShowNextText:"audio/show_next_text.mp3",OptionTap:"audio/option_tap.mp3",TileTap:"audio/tile_tap.mp3"}},FontFamily:{Default:"MPLUS1p-Regular"}});function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function _(t){return function(t){if(Array.isArray(t))return S(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return S(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return S(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var E=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e=t.prototype;return e.createUiNode=function(t){return new a.W20},e.createUiNodeByGraphElement=function(t){var e=this.createUiNode(t.params);return e&&(e.name=t.id,e.position.set(t.position[0],t.position[1]),t.invisible&&(e.visible=!1),t.interactive&&(e.interactive=!0)),e},e.attachUiEventByGraphElement=function(t,e,i){var n=!0,o=!1,r=void 0;try{for(var s,a=function(t,n){var o,r=n.value,s=i[r.callback];if(!s)return"continue";e.on(r.type,(function(){return(o=s).call.apply(o,[i].concat(_(r.arguments)))}))},u=t[Symbol.iterator]();!(n=(s=u.next()).done);n=!0)a(0,s)}catch(c){o=!0,r=c}finally{try{n||null==u.return||u.return()}finally{if(o)throw r}}},t}();function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function j(t,e){return!e||"object"!==P(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function x(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return T(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return T(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var P=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function A(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=I(t);if(e){var o=I(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return j(this,i)}}var B=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(i,t);var e=A(i);function i(){return R(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e={};t&&(void 0!==t.family&&(e.fontFamily=t.family),void 0!==t.size&&(e.fontSize=t.size),void 0!==t.color&&(e.fill=t.color),void 0!==t.padding&&(e.padding=t.padding),void 0!==t.wordWrap&&(e.wordWrap=t.wordWrap),void 0!==t.wordWrapWidth&&(e.wordWrapWidth=t.wordWrapWidth));var i,n=new a.pn8(e),o=new a.xvT(t&&t.text?t.text:"",n);t&&void 0!==t.anchor&&(i=o.anchor).set.apply(i,x(t.anchor));return o},i}(E);function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function U(t,e){return!e||"object"!==W(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function G(t){return function(t){if(Array.isArray(t))return D(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return D(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return D(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var W=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function L(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=k(t);if(e){var o=k(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return U(this,i)}}var F=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(i,t);var e=L(i);function i(){return N(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e=new a.jyi;if(t){var i,n,o=t.textureName;if(o&&a.P6Y.kN[o]&&(e.texture=a.P6Y.kN[o]),t.anchor)(i=e.anchor).set.apply(i,G(t.anchor));if(t.scale)(n=e.scale).set.apply(n,G(t.scale))}return e},i}(E);var V=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.getFactory=function(e){if(!t.cashedFactory[e]){var i;switch(e){case"text":case"message":case"language_option_text":case"confirmation_text":case"credit_text":case"menu_text":i=B;break;case"language_option_sprite":case"confirmation_sprite":case"sprite":i=F}if(!i)return null;t.cashedFactory[e]=new i}return t.cashedFactory[e]},t}();function H(t,e,i,n,o,r,s){try{var a=t[r](s),u=a.value}catch(c){return void i(c)}a.done?e(u):Promise.resolve(u).then(n,o)}function z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K(t){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Y(t,e){return!e||"object"!==J(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function q(t,e){return(q=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}V.cashedFactory={};var J=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Z(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=K(t);if(e){var o=K(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Y(this,i)}}var X=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&q(t,e)}(i,t);var e=Z(i);function i(){var t;return z(this,i),(t=e.apply(this,arguments)).transitionIn=new v(1,0,-.02),t.transitionOut=new v(0,1,.02),t.objectsToUpdate=[],t.elapsedFrameCount=0,t.uiGraphContainer=new a.W20,t.uiGraph=new Map,t.isOver=!1,t}var n=i.prototype;return n.update=function(t){this.elapsedFrameCount++,this.updateRegisteredObjects(t),this.transitionIn.isActive()?this.transitionIn.update(t):this.transitionOut.isActive()&&this.transitionOut.update(t)},n.registerUpdatingObject=function(t){this.objectsToUpdate.push(t)},n.updateRegisteredObjects=function(t){var e=[],i=!0,n=!1,o=void 0;try{for(var r,s=this.objectsToUpdate[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;a&&!a.isDestroyed()&&(a.update(t),e.push(a))}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}this.objectsToUpdate=e},n.beginTransitionIn=function(t,e){this.transitionIn.setCallback((function(){return t()}));var i=this.transitionIn.getContainer();i&&this.addChild(i),this.transitionIn.begin(e)},n.beginTransitionOut=function(t,e){this.transitionOut.setCallback((function(){return t()}));var i=this.transitionOut.getContainer();i&&this.addChild(i),this.transitionOut.begin(e)},n.createInitialResourceList=function(){return[]},n.beginLoadResource=function(t){var e,i=this;return(e=g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(t){i.loadInitialResource((function(){return t(null)}))}));case 2:return e.next=4,new Promise((function(t){var e=i.onInitialResourceLoaded();i.loadAdditionalResource(e,(function(){return t(null)}))}));case 4:i.onResourceLoaded(),t();case 6:case"end":return e.stop()}}),e)})),function(){var t=this,i=arguments;return new Promise((function(n,o){var r=e.apply(t,i);function s(t){H(r,n,o,s,a,"next",t)}function a(t){H(r,n,o,s,a,"throw",t)}s(void 0)}))})()},n.loadInitialResource=function(t){var e=this.createInitialResourceList(),i=O.UI.SceneUiGraph(this.sceneName);e.push(i);var n=this.filterLoadedAssets(e);n.length>0?m.game.loader.add(n).load(t):t()},n.onInitialResourceLoaded=function(){var t=[],e=O.UI.SceneUiGraph(this.sceneName),i=m.game.loader.resources[e],n=!0,o=!1,r=void 0;try{for(var s,a=i.data.nodes[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;"sprite"!==u.type&&"sprite_option"!==u.type&&"room_object"!==u.type&&"item_panel"!==u.type&&"language_option_sprite"!==u.type&&"confirmation_sprite"!==u.type||t.push({name:u.params.textureName,url:u.params.url})}}catch(c){o=!0,r=c}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}return t},n.loadAdditionalResource=function(t,e){m.game.loader.add(this.filterLoadedAssets(t)).load(e)},n.onResourceLoaded=function(){var t=O.UI.SceneUiGraph(this.sceneName),e=m.game.loader.resources[t].data;this.prepareUiGraphContainer(e)},n.filterLoadedAssets=function(t){var e=new Map,i=!0,n=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;"string"===typeof a?m.game.loader.resources[a]||e.has(a)||e.set(a,{name:a,url:a}):m.game.loader.resources[a.name]||e.has(a.name)||e.set(a.name,a)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return Array.from(e.values())},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=V.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),this.uiGraph.set(s.id,u),this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.getCustomUiGraphFactory=function(t){return null},n.destroySound=function(){var t=m.game.loader.resources,e=Object.keys(t),i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;t[a].buffer&&d.destroySound(a)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},i}(a.W20);function $(t,e,i){return($="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Q(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function Q(t){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tt(t,e){return!e||"object"!==it(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var it=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function nt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Q(t);if(e){var o=Q(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return tt(this,i)}}var ot=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(i,t);var e=nt(i);function i(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=e.call(this)).sceneName="option_scene",n.language=t,n.transitionIn=new v(1,0,-.02),n.transitionOut=new v(0,1,.02),n}var n=i.prototype;return n.onResourceLoaded=function(){$(Q(i.prototype),"onResourceLoaded",this).call(this),this.initVolumeGraph(),this.initLanguageButton(),this.addChild(this.uiGraphContainer)},n.initLanguageButton=function(){var t=this.uiGraph.get("japanese"),e=this.uiGraph.get("japanese_2"),i=this.uiGraph.get("english"),n=this.uiGraph.get("english_2");t&&e&&i&&n&&("japanese"===this.language?(t.visible=!0,e.visible=!1,i.visible=!1,n.visible=!0):(t.visible=!1,e.visible=!0,i.visible=!0,n.visible=!1))},n.onLanguageSelected=function(t){d.playSe(O.Audio.Se.OptionTap);var e=this.uiGraph.get("japanese"),i=this.uiGraph.get("japanese_2"),n=this.uiGraph.get("english"),o=this.uiGraph.get("english_2");e&&i&&n&&o&&("japanese"===t?(e.visible=!0,i.visible=!1,n.visible=!1,o.visible=!0):(e.visible=!1,i.visible=!0,n.visible=!0,o.visible=!1),this.saveLanguageToDB(t))},n.initVolumeGraph=function(){for(var t=d.bgmVolume,e=d.seVolume,i=Math.round(100*t)+1,n=Math.round(10*e)+1;i<=10;i++){var o="bgm_volume_".concat(i);this.uiGraph.get(o).visible=!1}for(;n<=10;n++){var r="se_volume_".concat(n);this.uiGraph.get(r).visible=!1}},n.showTitleScene=function(){this.transitionIn.isActive()||this.transitionOut.isActive()||(d.playSe(O.Audio.Se.OptionTap),m.loadScene(new si))},n.onBgmArrowDown=function(t){var e=d.bgmVolume;if(t<0){if(0===e)return;var i="bgm_volume_".concat(Math.round(100*e));this.uiGraph.get(i).visible=!1}else{if(.1===e)return;var n="bgm_volume_".concat(Math.round(100*e+1));this.uiGraph.get(n).visible=!0}(e+=t)<.001?e=0:e>.0999&&(e=.1),d.bgmVolume=e,d.playSe(O.Audio.Se.OptionTap),this.saveBgmVolumeToDB(d.bgmVolume),d.setSoundVolume(d.bgmVolume,d.seVolume)},n.onSeArrowDown=function(t){var e=d.seVolume;if(t<0){if(0===e)return;var i="se_volume_".concat(Math.round(10*e));this.uiGraph.get(i).visible=!1}else{if(1===e)return;var n="se_volume_".concat(Math.round(10*e+1));this.uiGraph.get(n).visible=!0}(e+=t)<.001?e=0:e>.999&&(e=1),d.seVolume=e,d.playSe(O.Audio.Se.OptionTap),this.saveSeVolumeToDB(d.seVolume)},n.saveLanguageToDB=function(t){p.put("language",t)},n.saveBgmVolumeToDB=function(t){p.put("bgmVolume",t)},n.saveSeVolumeToDB=function(t){p.put("seVolume",t)},i}(X);function rt(t,e,i){return(rt="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=st(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function at(t,e){return!e||"object"!==ct(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ut(t,e){return(ut=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ct=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function lt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=st(t);if(e){var o=st(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return at(this,i)}}var ht=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ut(t,e)}(i,t);var e=lt(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=e.call(this)).creditContainer=new a.W20,t.currentPage=0,t.currentPageNumber=1,t.sceneName="credit_scene",t.transitionIn=new v(1,0,-.02),t.transitionOut=new v(0,1,.02),t}var n=i.prototype;return n.onResourceLoaded=function(){rt(st(i.prototype),"onResourceLoaded",this).call(this),this.addChild(this.uiGraphContainer),this.addChild(this.creditContainer)},n.changePage=function(t){d.playSe(O.Audio.Se.OptionTap),t<0?this.currentPageNumber+=1:this.currentPageNumber-=1,this.currentPage=this.currentPage+t,this.currentPage<-6?(this.currentPage=0,this.currentPageNumber=1):this.currentPage>0&&(this.currentPage=-6,this.currentPageNumber=7),this.creditContainer.position.x=640*this.currentPage;var e=this.uiGraph.get("page_number");e&&(e.text=this.currentPageNumber.toString())},n.showTitleScene=function(){this.transitionIn.isActive()||this.transitionOut.isActive()||(d.playSe(O.Audio.Se.OptionTap),m.loadScene(new si))},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=V.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),this.uiGraph.set(s.id,u),"credit_text"===s.type?this.creditContainer.addChild(u):this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},i}(X);var pt=function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.state=0,this.walkDirection=null,this.walkSpeed=4,this.walkCount=0,this.distanceRow=0,this.distanceColumn=0,this.checkingObject=null,this.items=[],this.positionRow=e,this.positionColumn=i},ft=Object.freeze({NONE:0,OBJECT:1,GOAL:2}),dt=Object.freeze({UP:0,LEFT:1,DOWN:2,RIGHT:3});var mt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.init=function(e){t.map=e,t.states=[],t.policy.clear(),t.direction.clear();for(var i=0;i<e.length;i++)for(var n=0;n<e[0].length;n++)t.states.push([i,n]);var o=!0,r=!1,s=void 0;try{for(var a,u=t.states[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;t.value.set(c,0);var l=!0,h=!1,p=void 0;try{for(var f,d=t.actions[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value;t.policy.set([c,m],0)}}catch(y){h=!0,p=y}finally{try{l||null==d.return||d.return()}finally{if(h)throw p}}}}catch(y){r=!0,s=y}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}t.direction.set(t.actions[0],dt.UP),t.direction.set(t.actions[1],dt.LEFT),t.direction.set(t.actions[2],dt.DOWN),t.direction.set(t.actions[3],dt.RIGHT)},t.move=function(e,i){if(e[0]===t.goal[0]&&e[1]===t.goal[1])return[0,e];var n=[e[0]+i[0],e[1]+i[1]];return n[0]<0||n[1]<0||n[0]>=t.map.length||n[1]>=t.map[0].length||t.map[n[0]][n[1]]===ft.OBJECT?[-1,e]:[-1,n]},t.policyUpdate=function(e){var i,n=-Math.pow(10,10),o=!0,r=!1,s=void 0;try{for(var a,u=t.actions[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value,l=t.move(e,c),h=0,p=!0,f=!1,d=void 0;try{for(var m,y=t.states[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var g=m.value;g[0]===l[1][0]&&g[1]===l[1][1]&&(h=l[0]+t.value.get(g))}}catch(v){f=!0,d=v}finally{try{p||null==y.return||y.return()}finally{if(f)throw d}}h>n&&(n=h,i=c)}}catch(v){r=!0,s=v}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}return t.policy.forEach((function(n,o){o[0][0]===e[0]&&o[0][1]===e[1]&&o[1][0]===i[0]&&o[1][1]===i[1]?t.policy.set(o,1):o[0][0]===e[0]&&o[0][1]===e[1]&&t.policy.set(o,0)})),n},t.valueIteration=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.01,i=0;;){var n=0,o=!0,r=!1,s=void 0;try{for(var a,u=t.states[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;if(1!==t.map[c[0]][c[1]]){var l=t.policyUpdate(c);n=Math.max(n,Math.abs(t.value.get(c)-l)),t.value.set(c,l)}}}catch(h){r=!0,s=h}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}if(++i>=t.maxIterate)break;if(n<e)break}},t.createBestPolicy=function(){t.policy.forEach((function(e,i){if(1===e){var n=t.direction.get(i[1]);t.bestPolicy.set(i[0],n)}}))},t.getRoutePlan=function(e,i){t.goal=i,t.valueIteration(),t.createBestPolicy();for(var n=[],o=e,r=!1,s=0;!r;){if(++s>=t.maxIterate)return[];var a=!0,u=!1,c=void 0;try{for(var l,h=t.states[Symbol.iterator]();!(a=(l=h.next()).done);a=!0){var p=l.value;if(p[0]===o[0]&&p[1]===o[1]){var f=t.bestPolicy.get(p);switch(f){case 0:o[0]=o[0]-1;break;case 1:o[1]=o[1]-1;break;case 2:o[0]=o[0]+1;break;case 3:o[1]=o[1]+1}o[0]===i[0]&&o[1]===i[1]&&(r=!0),n.push(f);break}}}catch(d){u=!0,c=d}finally{try{a||null==h.return||h.return()}finally{if(u)throw c}}}return n},t}();mt.states=[],mt.actions=[[-1,0],[0,-1],[1,0],[0,1]],mt.policy=new Map,mt.bestPolicy=new Map,mt.value=new Map,mt.direction=new Map,mt.maxIterate=100;var yt=Object.freeze({IDLE:0,WALK:1,CHECKING:2});var gt=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.states=[],this.id=e},vt=Object.freeze({CheckedUnderBed:0,UsedKey:1,HasNoPencil:2,CheckedUnderPillow:3,CheckedInCloset:4,JumpedOnBed:5,CheckedOnCloset:6,GotCarKey:7,Washed:8,HasNoDVD:9}),bt=Object.freeze({DoNoting:1,BackToTitle:6,ShowItems:7,ShowBackToTitle:8,ShowSoundVolume:9,ShowItemOption:10,JumpOnBed:11,CheckUnderBed:12,CheckUnderPillow:13,UseTinStatue:14,UseCoin:15,UseBanana:16,UseCarKey:17,UseNail:18,UseFrozenBanana:19,UseSalt:20,UseCrossBow:21,UseDetergent:22,UseHandMirror:23,UseDVD:24,UsePencil:25,GetSalt:26,UseDeskKey:27,CheckLeftDrawer:28,CheckRightDrawer:29,GetPenCil:30,UseShapenedPencil:31,CheckInCloset:32,CheckOnCloset:33,ShowPinPad:34,GetCrossbow:35,SetTime:36,Escape:37,MovePig:38,GetDVD:39,ReadHint:40,ReadHint1:41,ReadHint2:42});var wt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.walkRequests=[],this.roomObjectEntities=new Map}var e=t.prototype;return e.init=function(t){this.delegator=t.delegator,this.stageMaster=t.stageMaster,this.saveData=t.saveData,this.saveData.mapData?mt.init(this.saveData.mapData):mt.init(this.stageMaster.mapData),this.tileSize=this.stageMaster.tileSize,0!==this.saveData.roomObjectState.length?this.setRoomObjectEntities(this.saveData.roomObjectState):this.setRoomObjectEntities(t.roomObjectMaster),this.playerEntity=new pt(4,7),0!==this.saveData.playerItems.length&&(this.playerEntity.items=this.saveData.playerItems),this.delegator.onPlayerSpawned(this.playerEntity)},e.update=function(){this.updatePlayerDistance(),this.updatePlayerState()},e.updatePlayerState=function(){this.playerEntity.state===yt.WALK&&this.updateWalkState(),this.playerEntity.state===yt.IDLE&&this.updateIdleState(),this.playerEntity.state===yt.CHECKING&&this.updateChackingState()},e.updateIdleState=function(){0!==this.walkRequests.length&&(this.playerEntity.state=yt.WALK,this.delegator.onPlayerEntityStateChanged(this.playerEntity)),this.playerEntity.checkingObject&&(this.playerEntity.state=yt.CHECKING,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updateWalkState=function(){0===this.walkRequests.length&&this.playerEntity.walkCount*this.playerEntity.walkSpeed%this.tileSize===0&&(this.playerEntity.walkCount=0,this.playerEntity.state=yt.IDLE,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updateChackingState=function(){this.playerEntity.checkingObject||(this.playerEntity.state=yt.IDLE,this.delegator.onPlayerEntityStateChanged(this.playerEntity))},e.updatePlayerDistance=function(){if(this.playerEntity.state===yt.WALK){if(this.playerEntity.walkCount*this.playerEntity.walkSpeed%this.tileSize===0)switch(this.walkRequests.shift()){case dt.UP:this.playerEntity.walkDirection=dt.UP,this.playerEntity.positionRow+=-1;break;case dt.DOWN:this.playerEntity.walkDirection=dt.DOWN,this.playerEntity.positionRow+=1;break;case dt.LEFT:this.playerEntity.walkDirection=dt.LEFT,this.playerEntity.positionColumn+=-1;break;case dt.RIGHT:this.playerEntity.walkDirection=dt.RIGHT,this.playerEntity.positionColumn+=1}switch(this.playerEntity.walkDirection){case dt.UP:this.playerEntity.distanceRow-=this.playerEntity.walkSpeed;break;case dt.DOWN:this.playerEntity.distanceRow+=this.playerEntity.walkSpeed;break;case dt.LEFT:this.playerEntity.distanceColumn-=this.playerEntity.walkSpeed;break;case dt.RIGHT:this.playerEntity.distanceColumn+=this.playerEntity.walkSpeed}this.playerEntity.walkCount++,this.delegator.onPlayerEntityWalked(this.playerEntity)}},e.onRoomObjectTapped=function(t){this.playerEntity.checkingObject=t},e.onOptionSelected=function(t){if(this.playerEntity.checkingObject){var e=this.roomObjectEntities.get(this.playerEntity.checkingObject);if(e){if(t===bt.UseHandMirror&&this.delegator.onItemUsed(t,e),t===bt.UseShapenedPencil&&this.delegator.onItemUsed(t,e),t===bt.UseNail&&this.delegator.onItemUsed(t,e),t===bt.UseDVD&&this.delegator.onItemUsed(t,e),t===bt.CheckRightDrawer&&this.delegator.onRoomObjectOptionSelected(e,t),t===bt.CheckLeftDrawer&&this.delegator.onRoomObjectOptionSelected(e,t),t===bt.MovePig&&this.delegator.onRoomObjectOptionSelected(e,t),t===bt.ReadHint&&this.delegator.onRoomObjectOptionSelected(e,t),t===bt.ReadHint1&&this.delegator.onRoomObjectOptionSelected(e,t),t===bt.ReadHint2&&this.delegator.onRoomObjectOptionSelected(e,t),t===bt.Escape&&this.delegator.onGameOver(),t===bt.CheckUnderBed&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(vt.CheckedUnderBed)&&(this.playerEntity.items.push(b.TIN_STATUE),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(vt.CheckedUnderBed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===bt.CheckUnderPillow&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(vt.CheckedUnderPillow)&&(this.playerEntity.items.push(b.HAND_MIRROR),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(vt.CheckedUnderPillow),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===bt.JumpOnBed&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(vt.JumpedOnBed)&&(e.states.push(vt.JumpedOnBed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===bt.CheckInCloset&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(vt.CheckedInCloset)&&(this.playerEntity.items.push(b.DETERGENT),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(vt.CheckedInCloset),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB())),t===bt.CheckOnCloset&&(this.delegator.onRoomObjectOptionSelected(e,t),-1===e.states.indexOf(vt.CheckedOnCloset))){this.playerEntity.items.push(b.CAR_KEY),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(vt.CheckedOnCloset),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB();var i=this.roomObjectEntities.get(O.RoomObjects.BED);null===i||void 0===i||i.states.push(vt.GotCarKey),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()}if(t===bt.UseDetergent){if(this.playerEntity.checkingObject===O.RoomObjects.MIRROR){var n=this.playerEntity.items.indexOf(b.DETERGENT);this.playerEntity.items.splice(n,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(vt.Washed),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()}this.delegator.onItemUsed(t,e)}if(t===bt.UseFrozenBanana)if(this.playerEntity.checkingObject===O.RoomObjects.CHAIR&&-1!==this.playerEntity.items.indexOf(b.NAIL)){this.delegator.onItemUsed(t,e,this.playerEntity.items);var o=this.playerEntity.items.indexOf(b.FROZEN_BANANA);this.playerEntity.items.splice(o,1);var r=this.playerEntity.items.indexOf(b.NAIL);this.playerEntity.items.splice(r,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}else this.delegator.onItemUsed(t,e,this.playerEntity.items);if(t===bt.UseTinStatue){if(this.playerEntity.checkingObject===O.RoomObjects.GAS_STOVE){var s=this.playerEntity.items.indexOf(b.TIN_STATUE);this.playerEntity.items.splice(s,1),this.playerEntity.items.push(b.COIN),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===bt.UseCoin){if(this.playerEntity.checkingObject===O.RoomObjects.VENDING_MACHINE){var a=this.playerEntity.items.indexOf(b.COIN);this.playerEntity.items.splice(a,1),this.playerEntity.items.push(b.BANANA),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===bt.UseBanana){if(this.playerEntity.checkingObject===O.RoomObjects.FREEZER){var u=this.playerEntity.items.indexOf(b.BANANA);this.playerEntity.items.splice(u,1),this.playerEntity.items.push(b.FROZEN_BANANA),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===bt.UseSalt){if(this.playerEntity.checkingObject===O.RoomObjects.BARREL){var c=this.playerEntity.items.indexOf(b.SALT);this.playerEntity.items.splice(c,1),this.playerEntity.items.push(b.DESK_KEY),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===bt.UseDeskKey){if(this.playerEntity.checkingObject===O.RoomObjects.DESK){var l=this.playerEntity.items.indexOf(b.DESK_KEY);this.playerEntity.items.splice(l,1),e.states.push(vt.UsedKey),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB(),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===bt.UsePencil){if(this.playerEntity.checkingObject===O.RoomObjects.GRINDER){var h=this.playerEntity.items.indexOf(b.PENCIL);this.playerEntity.items.splice(h,1),this.playerEntity.items.push(b.SHARPENED_PENCIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}this.delegator.onItemUsed(t,e)}if(t===bt.UseCrossBow)if(this.playerEntity.checkingObject===O.RoomObjects.BALLOON&&-1!==this.playerEntity.items.indexOf(b.SHARPENED_PENCIL)){this.delegator.onItemUsed(t,e,this.playerEntity.items);var p=this.playerEntity.items.indexOf(b.SHARPENED_PENCIL);this.playerEntity.items.splice(p,1);var f=this.playerEntity.items.indexOf(b.CROSSBOW);this.playerEntity.items.splice(f,1),this.playerEntity.items.push(b.NAIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items)}else this.delegator.onItemUsed(t,e,this.playerEntity.items);if(t===bt.UseCarKey){if(this.playerEntity.checkingObject===O.RoomObjects.CAR){var d=this.playerEntity.items.indexOf(b.CAR_KEY);this.playerEntity.items.splice(d,1),this.delegator.onPlayerItemsChanged(this.playerEntity.items),mt.init(this.stageMaster.carMovedMapData),this.playerEntity.positionRow=7,this.playerEntity.positionColumn=7,this.playerEntity.distanceRow=192,this.playerEntity.distanceColumn=0}this.delegator.onItemUsed(t,e)}t===bt.GetSalt&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(b.SALT),this.delegator.onPlayerItemsChanged(this.playerEntity.items)),t===bt.GetCrossbow&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(b.CROSSBOW),this.delegator.onPlayerItemsChanged(this.playerEntity.items)),t===bt.GetPenCil&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(b.PENCIL),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(vt.HasNoPencil),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()),t===bt.GetDVD&&(this.delegator.onRoomObjectOptionSelected(e,t),this.playerEntity.items.push(b.DVD),this.delegator.onPlayerItemsChanged(this.playerEntity.items),e.states.push(vt.HasNoDVD),this.saveData.roomObjectState=this.changeRoomObjectEntitiesIntoArray(),this.saveProgressToDB()),t===bt.SetTime&&(mt.init(this.stageMaster.pigMovedMapData),this.delegator.onRoomObjectOptionSelected(e,t))}}},e.onChackingEnd=function(){this.playerEntity.checkingObject=null},e.setRoomObjectEntities=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=new gt(s.id);a.states=s.states.concat(),this.roomObjectEntities.set(s.id,a)}}catch(u){i=!0,n=u}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},e.requestWalk=function(t){this.walkRequests=mt.getRoutePlan([this.playerEntity.positionRow,this.playerEntity.positionColumn],t)},e.changeRoomObjectEntitiesIntoArray=function(){var t=[];return this.roomObjectEntities.forEach((function(e,i){var n={id:i,states:e.states};t.push(n)})),t},e.saveProgressToDB=function(){p.put("saveData",this.saveData)},t}(),Ot=Object.freeze({LOADING_RESOURCES:1,RESOURCE_LOADED:2,READY:3,INGAME:4,FINISHED:5});var St=function(){function t(e,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.elapsedFrameCount=0,this.destroyed=!1,this.animationFrameId=0,this.requestedAnimationType=null,this.sprite=new a.jyi;var o=a.P6Y.kN[e.types.wait.frames[0]];this.sprite.texture=o,this.reSizeSprite(i);var r=i-this.sprite.width,s=i-this.sprite.height;this.sprite.position.set(n.x+r/2,n.y+s/2),this.spawnedPosition=new a.E9j(this.sprite.position.x,this.sprite.position.y),this.animationMaster=e,this.animationType=O.AnimationTypes.Player.WAIT}var e=t.prototype;return e.isDestroyed=function(){return this.destroyed},e.update=function(t){this.requestedAnimationType&&this.requestedAnimationType!==this.animationType&&(this.animationType=this.requestedAnimationType,this.resetAnimation()),this.updateAnimation()},e.requestAnimation=function(t){this.requestedAnimationType=t},e.resetAnimation=function(){this.requestedAnimationType=null,this.elapsedFrameCount=0,this.animationFrameId=0},e.updateAnimation=function(){var t=this.animationType,e=this.animationMaster.types[t];if(e){if(this.elapsedFrameCount%e.updateDuration===0){this.isAnimationLastFrameTime()&&this.resetAnimation();var i=e.frames[this.animationFrameId];this.sprite.texture=a.P6Y.kN[i],this.animationFrameId++}this.elapsedFrameCount++}},e.isAnimationLastFrameTime=function(){var t=this.animationType,e=this.animationMaster.types[t];if(!e)return!1;var i=e.updateDuration*e.frames.length;return this.elapsedFrameCount===i},e.destroy=function(){this.sprite.destroy(),this.destroyed=!0},e.reSizeSprite=function(t){t/t>this.sprite.width/this.sprite.height?(this.sprite.scale.x=t/this.sprite.width*(this.sprite.width/this.sprite.height),this.sprite.scale.y=t/this.sprite.height):(this.sprite.scale.x=t/this.sprite.width,this.sprite.scale.y=t/this.sprite.height*(this.sprite.height/this.sprite.width))},t}();function _t(t){return(_t=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Et(t,e){return!e||"object"!==Rt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Tt(t,e){return(Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Rt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function It(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=_t(t);if(e){var o=_t(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Et(this,i)}}var jt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tt(t,e)}(i,t);var e=It(i);function i(t,n,o){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(r=e.call(this)).isActive=!1,r.touchable=!1,r.tilePosition=n,r.tileSprite=new a.jyi,r.tileFrameSprite=new a.jyi;var s=m.game.loader.resources[O.Dynamic.tiles(t)].texture,u=m.game.loader.resources[O.UI.TileFrame].texture;return s&&(r.tileSprite.texture=s),r.tileSprite.scale.set(o/r.tileSprite.width,o/r.tileSprite.height),u&&(r.tileFrameSprite.texture=u),r.tileFrameSprite.scale.set(o/r.tileFrameSprite.width,o/r.tileFrameSprite.height),r.tileFrameSprite.visible=!1,r.addChild(r.tileSprite),r.addChild(r.tileFrameSprite),r}return i.prototype.toggleFrame=function(){this.touchable&&(d.playSe(O.Audio.Se.TileTap),this.isActive=!this.isActive,this.tileFrameSprite.visible=!this.tileFrameSprite.visible)},i}(a.W20);function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function xt(t){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pt(t,e){return!e||"object"!==Dt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function At(t,e){return(At=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Bt(t){return function(t){if(Array.isArray(t))return Ct(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return Ct(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ct(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Dt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Nt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=xt(t);if(e){var o=xt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Pt(this,i)}}var kt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&At(t,e)}(i,t);var e=Nt(i);function i(t,n){var o,r,s;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(o=e.call(this)).messageIds=o.copyMessageIds(n.messageIds),o.downTiles=n.downTiles.concat(),o.sprite=new a.jyi,o.sprite.texture=t,n.anchor)&&(r=o.sprite.anchor).set.apply(r,Bt(n.anchor));n.scale&&(s=o.sprite.scale).set.apply(s,Bt(n.scale));return o.addChild(o.sprite),o}return i.prototype.copyMessageIds=function(t){var e,i,n=[],o=!0,r=!1,s=void 0;try{for(var a,u=t[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;e=c,(null!=(i=String)&&"undefined"!==typeof Symbol&&i[Symbol.hasInstance]?i[Symbol.hasInstance](e):e instanceof i)?n.push(c):n.push(c.concat())}}catch(l){r=!0,s=l}finally{try{o||null==u.return||u.return()}finally{if(r)throw s}}return n},i}(a.W20);function Ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mt(t){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gt(t,e){return!e||"object"!==Lt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wt(t,e){return(Wt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Lt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Ft(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Mt(t);if(e){var o=Mt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Gt(this,i)}}var Vt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wt(t,e)}(i,t);var e=Ft(i);function i(){return Ut(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e;if(t){var i=t.textureName;i&&a.P6Y.kN[i]&&(e=a.P6Y.kN[i])}return e?new kt(e,t):null},i}(E);function Ht(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function zt(t){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Kt(t,e){return!e||"object"!==qt(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yt(t,e){return(Yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var qt=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Jt(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=zt(t);if(e){var o=zt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Kt(this,i)}}var Zt=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yt(t,e)}(i,t);var e=Jt(i);function i(t,n){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(o=e.call(this)).isActive=!1,o.optionButton=t,o.optionType=n,o.frameSprite=new a.jyi;var r,s,u=m.game.loader.resources[O.UI.OptionFrame].texture;return u&&(o.frameSprite.texture=u),r=t,(null!=(s=a.xvT)&&"undefined"!==typeof Symbol&&s[Symbol.hasInstance]?s[Symbol.hasInstance](r):r instanceof s)?o.frameSprite.scale.set((o.optionButton.width+40)/o.frameSprite.width,(o.optionButton.height+10)/o.frameSprite.height):o.frameSprite.scale.set(o.optionButton.texture.width/o.frameSprite.width,o.optionButton.texture.height/o.frameSprite.height),o.frameSprite.anchor.set(.5,.5),o.frameSprite.visible=!1,o.optionButton.addChild(o.frameSprite),o.addChild(o.optionButton),o}var n,o,r,s=i.prototype;return s.activate=function(){this.isActive=!0,this.frameSprite.visible=!0},s.deactivate=function(){this.isActive=!1,this.frameSprite.visible=!1},n=i,r=[{key:"resourceList",get:function(){return[O.UI.OptionFrame,O.UI.ItemSelectFrame]}}],(o=null)&&Ht(n.prototype,o),r&&Ht(n,r),i}(a.W20);function Xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function $t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qt(t){return(Qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function te(t,e){return!e||"object"!==ne(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ee(t,e){return(ee=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ie(t){return function(t){if(Array.isArray(t))return Xt(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return Xt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Xt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ne=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function oe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Qt(t);if(e){var o=Qt(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return te(this,i)}}var re=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ee(t,e)}(i,t);var e=oe(i);function i(){return $t(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e={};t&&(void 0!==t.family&&(e.fontFamily=t.family),void 0!==t.size&&(e.fontSize=t.size),void 0!==t.color&&(e.fill=t.color),void 0!==t.padding&&(e.padding=t.padding),void 0!==t.wordWrap&&(e.wordWrap=t.wordWrap),void 0!==t.wordWrapWidth&&(e.wordWrapWidth=t.wordWrapWidth));var i,n=new a.pn8(e),o=new a.xvT(t&&t.text?t.text:"",n);t&&void 0!==t.anchor&&(i=o.anchor).set.apply(i,ie(t.anchor));var r=t.optionType;return new Zt(o,r)},i}(E);function se(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ae(t){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ue(t,e){return null!=e&&"undefined"!==typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function ce(t,e){return!e||"object"!==he(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function le(t,e){return(le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var he=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function pe(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ae(t);if(e){var o=ae(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ce(this,i)}}var fe=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&le(t,e)}(i,t);var e=pe(i);function i(t,n){var o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(o=e.call(this)).currentTextIndex=0;var r=!0,s=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){var h=c.value;if(!ue(h,a.xvT)){var p=!0,f=!1,d=void 0;try{for(var y,g=function(t,e){var i=e.value;i.deactivate(),i.on("pointertap",(function(){o.onOptionButtonTapped(i)}))},v=h[Symbol.iterator]();!(p=(y=v.next()).done);p=!0)g(0,y)}catch(w){f=!0,d=w}finally{try{p||null==v.return||v.return()}finally{if(f)throw d}}h[0].activate()}}}catch(w){s=!0,u=w}finally{try{r||null==l.return||l.return()}finally{if(s)throw u}}o.delegate=n,o.textsAndOptions=t;var b=a.P6Y.kN[O.UI.MessageWindow];return o.window=new a.jyi(b),o.window.interactive=!0,o.window.on("pointertap",(function(){o.showNextText()})),o.window.scale.set((m.game.view.width-10)/o.window.width,(m.game.view.height/3-10)/o.window.height),o.window.anchor.set(.5,.5),o.window.position.set(m.game.view.width/2,m.game.view.height-o.window.height/2-5),o.windowScaleX=o.window.scale.x,o.windowScaleY=o.window.scale.y,o.windowSizeUpRateX=o.windowScaleX/i.WindowSizeUpFrame,o.windowSizeUpRateY=o.windowScaleY/i.WindowSizeUpFrame,o.window.scale.set(0,0),ue(o.textsAndOptions[0],a.xvT)&&o.window.addChild(o.textsAndOptions[0]),o.addChild(o.window),o}var n,o,r,s=i.prototype;return s.isDestroyed=function(){return this._destroyed},s.update=function(t){this.isDestroyed()||this.window.scale.x===this.windowScaleX&&this.window.scale.y===this.windowScaleY||(this.window.scale.set(this.window.scale.x+this.windowSizeUpRateX,this.window.scale.y+this.windowSizeUpRateY),this.window.scale.x>=this.windowScaleX&&(this.window.scale.x=this.windowScaleX),this.window.scale.y>=this.windowScaleY&&(this.window.scale.y=this.windowScaleY))},s.showNextText=function(){if(d.playSe(O.Audio.Se.ShowNextText),this.window.interactive=!0,this.currentTextIndex!==this.textsAndOptions.length-1){var t=this.textsAndOptions[this.currentTextIndex];if(ue(t,a.xvT))t.visible=!1;else{var e=!0,i=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){o.value.visible=!1}}catch(I){i=!0,n=I}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}}var s=this.textsAndOptions[++this.currentTextIndex];if(ue(s,a.xvT))this.window.addChild(s);else{this.window.interactive=!1,2===s.length?(s[0].position.set(-190,0),s[1].position.set(190,0)):3===s.length?(s[0].position.set(-300,0),s[1].position.set(0,0),s[2].position.set(300,0)):4===s.length?(s[0].position.set(-190,-35),s[1].position.set(-190,35),s[2].position.set(190,-35),s[3].position.set(190,35)):5===s.length?(s[0].position.set(-300,-35),s[1].position.set(-300,35),s[2].position.set(0,-35),s[3].position.set(0,35),s[4].position.set(300,-35)):6===s.length?(s[0].position.set(-300,-35),s[1].position.set(-300,35),s[2].position.set(0,-35),s[3].position.set(0,35),s[4].position.set(300,-35),s[5].position.set(300,35)):s[0].position.set(0,0);var u=!0,c=!1,l=void 0;try{for(var h,p=s[Symbol.iterator]();!(u=(h=p.next()).done);u=!0){var f=h.value;f.visible=!0,this.window.addChild(f)}}catch(I){c=!0,l=I}finally{try{u||null==p.return||p.return()}finally{if(c)throw l}}}}else{this.delegate.onMessageWindowClosed();var m=!0,y=!1,g=void 0;try{for(var v,b=this.textsAndOptions[Symbol.iterator]();!(m=(v=b.next()).done);m=!0){var w=v.value;if(!ue(w,a.xvT)){var S=!0,_=!1,E=void 0;try{for(var T,R=w[Symbol.iterator]();!(S=(T=R.next()).done);S=!0){T.value.removeListener("pointertap")}}catch(I){_=!0,E=I}finally{try{S||null==R.return||R.return()}finally{if(_)throw E}}}}}catch(I){y=!0,g=I}finally{try{m||null==b.return||b.return()}finally{if(y)throw g}}this.destroy()}},s.onOptionButtonTapped=function(t){if(t.isActive)t.optionType&&this.delegate.onOptionSelected(t.optionType),this.showNextText();else{var e=this.textsAndOptions[this.currentTextIndex];if(!ue(e,a.xvT)){var i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){r.value.deactivate()}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}}d.playSe(O.Audio.Se.OptionTap),t.activate()}},s.addText=function(t,e){if(!ue(t,a.xvT)){var i=!0,n=!1,o=void 0;try{for(var r,s=this,u=function(t,e){var i=e.value,n=s;i.removeListener("pointertap"),i.deactivate(),i.on("pointertap",(function(){n.onOptionButtonTapped(i)}))},c=t[Symbol.iterator]();!(i=(r=c.next()).done);i=!0)u(0,r)}catch(l){n=!0,o=l}finally{try{i||null==c.return||c.return()}finally{if(n)throw o}}t[0].activate()}this.textsAndOptions.splice(this.currentTextIndex+e,0,t)},n=i,r=[{key:"resourceList",get:function(){return[O.UI.MessageWindow]}}],(o=null)&&se(n.prototype,o),r&&se(n,r),i}(a.W20);function de(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function me(t){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ye(t,e){return null!=e&&"undefined"!==typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function ge(t,e){return!e||"object"!==be(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ve(t,e){return(ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}fe.WindowSizeUpFrame=10;var be=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function we(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=me(t);if(e){var o=me(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ge(this,i)}}var Oe=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ve(t,e)}(i,t);var e=we(i);function i(t,n,o,r,s){var u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(u=e.call(this)).isOpen=!1,u.menuOptionButtons=[],u.itemPanels=new Map,u.texts=new Map,u.optionButtons=new Map,u.delegate=s,u.menuOptionButtons=t,u.texts=r,u.soundOption=o,r.forEach((function(t,e){ye(t,Zt)&&u.optionButtons.set(e,t)}));var c=a.P6Y.kN[O.UI.MenuBar],l=a.P6Y.kN[O.UI.MenuButton],h=a.P6Y.kN[O.UI.ItemPanelFrame],p=a.P6Y.kN[O.UI.MessageWindow];return u.menuBar=new a.jyi(c),u.menuButton=new a.jyi(l),u.itemPanelFrame=new a.jyi(h),u.messageWindow=new a.jyi(p),u.initMenuBarAndMenuButton(),u.initItemPanelFrameAndItemPanels(n),u.initMessageWindow(r),u}var n,o,r,s=i.prototype;return s.initMessageWindow=function(t){var e=this;t.forEach((function(t,i){if(!ye(t,a.xvT)){var n=e;t.on("pointertap",(function(){n.onOptionButtonTapped(t)}))}})),this.messageWindow.scale.set((.8*m.game.view.width+20)/this.messageWindow.width,m.game.view.height/6/this.messageWindow.height),this.messageWindow.anchor.set(.5,.5),this.messageWindow.position.x=367,t.forEach((function(t,i){t.visible=!1,e.messageWindow.addChild(t)})),this.messageWindow.visible=!1,this.addChild(this.messageWindow)},s.initItemPanelFrameAndItemPanels=function(t){this.itemPanelFrame.scale.set((.8*m.game.view.width+20)/this.itemPanelFrame.width,(m.game.view.height/4+30)/this.itemPanelFrame.height),this.itemPanelFrame.position.set(100,10);var e=!0,i=!1,n=void 0;try{for(var o,r=this,s=function(t,e){var i=e.value,n=r;i.on("pointertap",(function(){n.onItemPanelTapped(i)})),r.itemPanels.set(i.itemType,i),i.scale.set((r.itemPanelFrame.texture.width-8)/6/i.width,(r.itemPanelFrame.texture.height/2-5)/i.height),r.itemPanelFrame.addChild(i)},a=t[Symbol.iterator]();!(e=(o=a.next()).done);e=!0)s(0,o)}catch(u){i=!0,n=u}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}this.itemPanelFrame.visible=!1,this.addChild(this.itemPanelFrame)},s.initMenuBarAndMenuButton=function(){var t=this;this.menuButton.interactive=!0,this.menuButton.on("pointertap",(function(){t.onMenuButtonTapped()})),this.menuBar.scale.set(m.game.view.width/7/this.menuBar.width,m.game.view.height/2/this.menuBar.height),this.menuButton.scale.set(this.menuBar.width/this.menuButton.width,this.menuBar.height/6/this.menuButton.height),this.menuBar.scale.y=(m.game.view.height/2-this.menuButton.height)/this.menuBar.texture.height,this.menuBar.position.y=this.menuButton.height,this.menuMoveRate=this.menuBar.width/i.menuMoveFrame,this.menuBar.addChild(this.menuButton);var e=!0,n=!1,o=void 0;try{for(var r,s=this,a=function(t,e){var i=e.value,n=s;i.on("pointertap",(function(){n.onMenuOptionButtonTapped(i)})),i.position.x=s.menuBar.texture.width/2,i.interactive=!0,s.menuBar.addChild(i)},u=this.menuOptionButtons[Symbol.iterator]();!(e=(r=u.next()).done);e=!0)a(0,r)}catch(c){n=!0,o=c}finally{try{e||null==u.return||u.return()}finally{if(n)throw o}}this.addChild(this.menuBar),this.addChild(this.menuButton)},s.isDestroyed=function(){return this._destroyed},s.update=function(t){this.isDestroyed()||(this.isOpen&&this.menuBar.position.x<0&&(this.menuBar.position.x+=this.menuMoveRate),!this.isOpen&&this.menuBar.position.x>-this.menuBar.width&&(this.menuBar.position.x-=this.menuMoveRate))},s.updateItemPanels=function(t){this.itemPanels.forEach((function(t,e){t.removeItem()}));var e=!0,i=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value;if(s===b.FROZEN_BANANA){var u=this.itemPanels.get(b.BANANA);if(!u)continue;u.hasItem=!0;var c=a.P6Y.kN[O.Dynamic.items(b.FROZEN_BANANA)];u.optionButton.texture=c,u.itemType=b.FROZEN_BANANA,u.itemTextId="frozen_banana_text",u.optionId="use_frozen_banana"}if(s===b.SHARPENED_PENCIL){var l=this.itemPanels.get(b.PENCIL);if(!l)continue;l.hasItem=!0;var h=a.P6Y.kN[O.Dynamic.items(b.SHARPENED_PENCIL)];l.optionButton.texture=h,l.itemType=b.SHARPENED_PENCIL,l.itemTextId="sharpened_pencil_text",l.optionId="use_sharpened_pencil"}var p=this.itemPanels.get(s);p&&p.addItem()}}catch(f){i=!0,n=f}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},s.onOptionButtonTapped=function(t){d.playSe(O.Audio.Se.OptionTap),t.isActive?(t.optionType===bt.DoNoting&&(this.messageWindow.visible=!1,this.menuOptionButtons.forEach((function(t,e){t.deactivate()}))),this.delegate.onOptionSelected(t.optionType)):(this.optionButtons.forEach((function(t,e){t.deactivate()})),t.activate())},s.onItemPanelTapped=function(t){if(d.playSe(O.Audio.Se.OptionTap),this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1})),this.messageWindow.visible=!1,t.activate(),t.hasItem){var e=this.texts.get(t.itemTextId);if(!e)return;this.messageWindow.position.y=260,this.messageWindow.visible=!0,e.visible=!0}},s.onMenuOptionButtonTapped=function(t){if(d.playSe(O.Audio.Se.OptionTap),t.isActive)t.deactivate(),this.toggleDisplay(t.optionType,!1);else{var e=this;this.menuOptionButtons.forEach((function(t,i){t.deactivate(),e.toggleDisplay(t.optionType,!1)})),this.toggleDisplay(t.optionType,!0),t.activate()}},s.onMenuButtonTapped=function(){if(d.playSe(O.Audio.Se.OptionTap),this.isOpen=!this.isOpen,!this.isOpen){var t=this;this.menuOptionButtons.forEach((function(e,i){e.deactivate(),t.toggleDisplay(e.optionType,!1)})),this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1})),this.messageWindow.visible=!1}},s.toggleDisplay=function(t,e){if(t===bt.ShowItems&&(this.itemPanelFrame.visible=e,e||(this.itemPanels.forEach((function(t,e){t.deactivate()})),this.texts.forEach((function(t,e){t.visible=!1,ye(t,Zt)&&t.deactivate()})),this.messageWindow.visible=!1)),t===bt.ShowBackToTitle){this.messageWindow.position.y=270,this.messageWindow.visible=e;var i=this.texts.get(O.MessageIds.BackToTitle),n=this.texts.get(O.MessageIds.ContinueGame);if(!i)return;if(!n)return;i.visible=e,ye(i,Zt)&&i.activate(),n.visible=e}t===bt.ShowSoundVolume&&(this.soundOption.visible=e)},n=i,r=[{key:"resourceList",get:function(){return[O.UI.MenuBar,O.UI.MenuButton,O.UI.ItemPanelFrame]}}],(o=null)&&de(n.prototype,o),r&&de(n,r),i}(a.W20);function Se(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function _e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ee(t){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Te(t,e){return!e||"object"!==je(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Re(t,e){return(Re=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ie(t){return function(t){if(Array.isArray(t))return Se(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return Se(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Se(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Oe.menuMoveFrame=10;var je=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Ce(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ee(t);if(e){var o=Ee(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Te(this,i)}}var xe=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Re(t,e)}(i,t);var e=Ce(i);function i(){return _e(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e=new a.jyi;if(t){var i,n,o=t.textureName;if(o&&a.P6Y.kN[o]&&(e.texture=a.P6Y.kN[o]),t.anchor)(i=e.anchor).set.apply(i,Ie(t.anchor));if(t.scale)(n=e.scale).set.apply(n,Ie(t.scale))}var r=t.optionType;return new Zt(e,r)},i}(E);function Pe(t){return(Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ae(t,e){return!e||"object"!==De(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Be(t,e){return(Be=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var De=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function Ne(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Pe(t);if(e){var o=Pe(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Ae(this,i)}}var ke=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Be(t,e)}(i,t);var e=Ne(i);function i(t,n,o,r,s){var a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(a=e.call(this,t,r)).hasItem=!1,a.itemType=n,a.optionButton=t,a.itemTextId=o,a.optionId=s;var u=m.game.loader.resources[O.UI.ItemSelectFrame].texture;return u&&(a.frameSprite.texture=u),a.frameSprite.scale.set(1,1),a}var n=i.prototype;return n.addItem=function(){this.hasItem=!0,this.optionButton.texture=a.P6Y.kN[O.Dynamic.items(this.itemType)]},n.removeItem=function(){this.hasItem=!1,this.optionButton.texture=a.P6Y.kN[O.Dynamic.items(0)]},i}(Zt);function Ue(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Me(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ge(t){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function We(t,e){return!e||"object"!==Ve(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Le(t,e){return(Le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Fe(t){return function(t){if(Array.isArray(t))return Ue(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return Ue(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Ue(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ve=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function He(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=Ge(t);if(e){var o=Ge(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return We(this,i)}}var ze=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Le(t,e)}(i,t);var e=He(i);function i(){return Me(this,i),e.apply(this,arguments)}return i.prototype.createUiNode=function(t){var e=new a.jyi;if(t){var i,n,o=t.textureName;if(o&&a.P6Y.kN[o]&&(e.texture=a.P6Y.kN[o]),t.anchor)(i=e.anchor).set.apply(i,Fe(t.anchor));if(t.scale)(n=e.scale).set.apply(n,Fe(t.scale))}return new ke(e,t.itemType,t.itemTextId,t.optionType,t.optionId)},i}(E),Ke=Object.freeze({DownTiles:"downTiles",Position:"position",MessageIds:"messageIds",TextureName:"textureName",Visible:"visible"});function Ye(t,e,i){return(Ye="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qe(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function qe(t){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Je(t,e){return!e||"object"!==Xe(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ze(t,e){return(Ze=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xe=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function $e(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=qe(t);if(e){var o=qe(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return Je(this,i)}}var Qe=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ze(t,e)}(i,t);var e=$e(i);function i(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(n=e.call(this)).isPaused=!1,n.tiles=new Map,n.roomObjects=new Map,n.messages=new Map,n.options=new Map,n.messageWindow=null,n.itemPanels=[],n.menuTexts=new Map,n.soundOption=new a.W20,n.pinPad=new a.W20,n.code=[],n.correctCode=[],n.transitionIn=new v(1,0,-.02),n.transitionOut=new v(0,1,.02),n.state=Ot.LOADING_RESOURCES,n.sceneName="escape_scene",n.language=t,n.saveData={roomObject:[],mapData:void 0,playerItems:[],roomObjectState:[],code:[],isBalloonExist:!0},n.gameLogic=new wt,n}var n=i.prototype;return n.beginTransitionIn=function(t,e){var n=this;Ye(qe(i.prototype),"beginTransitionIn",this).call(this,(function(){n.state===Ot.RESOURCE_LOADED&&(n.state=Ot.READY,t(n),d.playBgm(O.Audio.Bgm.EscapeBGM))}),e)},n.createInitialResourceList=function(){return Ye(qe(i.prototype),"createInitialResourceList",this).call(this).concat(O.UI.Tiles,O.UI.TileFrame,O.UI.PlayerAnimation,O.UI.Player,O.UI.RoomObjectMaster,O.UI.Items,O.UI.RoomObjects,fe.resourceList,Zt.resourceList,Oe.resourceList,[O.UI.Stage,O.Audio.Se.OptionTap,O.Audio.Se.ShowNextText,O.Audio.Se.TileTap,O.Audio.Bgm.EscapeBGM,O.Audio.Bgm.EndingBGM])},n.loadInitialResource=function(t){var e,i,n=this.createInitialResourceList(),o=O.UI.SceneUiGraph(this.sceneName);e="japanese"===this.language?O.UI.EscapeSceneMessage:O.UI.EscapeSceneEnglishMessage,i="japanese"===this.language?O.UI.EscapeSceneOption:O.UI.EscapeSceneEnglishOption;var r=O.UI.EscapeSceneRoomObject;n.push(o),n.push(e),n.push(i),n.push(r);var s=this.filterLoadedAssets(n);s.length>0?m.game.loader.add(s).load(t):t()},n.onInitialResourceLoaded=function(){var t,e=[],i=O.UI.SceneUiGraph(this.sceneName);t="japanese"===this.language?O.UI.EscapeSceneOption:O.UI.EscapeSceneEnglishOption;var n=O.UI.EscapeSceneRoomObject,o=m.game.loader.resources[i].data.nodes;o=(o=o.concat(m.game.loader.resources[t].data.nodes)).concat(m.game.loader.resources[n].data.nodes);var r=!0,s=!1,a=void 0;try{for(var u,c=o[Symbol.iterator]();!(r=(u=c.next()).done);r=!0){var l=u.value;"sprite"!==l.type&&"sprite_option"!==l.type&&"room_object"!==l.type&&"item_panel"!==l.type||e.push({name:l.params.textureName,url:l.params.url})}}catch(h){s=!0,a=h}finally{try{r||null==c.return||c.return()}finally{if(s)throw a}}return e},n.onResourceLoaded=function(){var t,e,i=m.game.loader.resources[O.UI.SceneUiGraph(this.sceneName)].data;t="japanese"===this.language?O.UI.EscapeSceneMessage:O.UI.EscapeSceneEnglishMessage,e="japanese"===this.language?O.UI.EscapeSceneOption:O.UI.EscapeSceneEnglishOption;var n=m.game.loader.resources[t].data,o=m.game.loader.resources[e].data,r=m.game.loader.resources[O.UI.EscapeSceneRoomObject].data;this.prepareUiGraphContainer(i),this.prepareUiGraphContainer(n),this.prepareUiGraphContainer(o),this.prepareUiGraphContainer(r);var s=m.game.loader.resources,a=s[O.UI.Stage].data,u=s[O.UI.RoomObjectMaster].data;this.playerAnimationMaster=s[O.UI.PlayerAnimation].data,this.tileSize=a.tileSize,this.initTiles(a,this.tileSize),this.uiGraphContainer.zIndex=1,this.addChild(this.uiGraphContainer),this.initSound(),this.initPinPad(),this.setHitArea(),this.initMenu(),this.initVolumeText(),this.initSoundOption(),this.loadSaveDataFromDB(a,u)},n.setHitArea=function(){var t=this.roomObjects.get("bowl");if(t){t.hitArea=new a.Cdc(t.width/2,t.height/2,30);var e=this.options.get("use_salt");e&&(e.hitArea=new a.AeJ(-75,-25,150,50))}},n.initMenu=function(){var t=[],e=!0,i=!1,n=void 0;try{for(var o,r=O.MenuOptionIds[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=this.options.get(s);a&&t.push(a)}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}var u=new Oe(t,this.itemPanels,this.soundOption,this.menuTexts,this);this.menu=u,this.menu.zIndex=3,this.registerUpdatingObject(u),this.addChild(this.menu)},n.initSoundOption=function(){var t=!0,e=!1,i=void 0;try{for(var n,o=O.SoundOptionIds[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var r=n.value,s=this.uiGraph.get(r);s&&this.soundOption.addChild(s)}}catch(a){e=!0,i=a}finally{try{t||null==o.return||o.return()}finally{if(e)throw i}}this.soundOption.visible=!1,this.soundOption.zIndex=3,this.addChild(this.soundOption)},n.initCode=function(){var t=this.messages.get("mirror_message_4");t&&("japanese"===this.language?t.text="\u624b\u93e1\u3067\u9996\u306e\u5f8c\u308d\u3092\u898b\u308b\u3068            \u5c0f\u3055\u304f\u300c".concat(this.correctCode[0].toString()+this.correctCode[1].toString()+this.correctCode[2].toString(),"\u300d\u3068\u66f8\u304b\u308c\u3066\u3044\u308b\u3002"):t.text="when you looked at the back of your neck             with the hand mirror, it was written as '".concat(this.correctCode[0].toString()+this.correctCode[1].toString()+this.correctCode[2].toString(),"'"))},n.initPinPad=function(){var t=!0,e=!1,i=void 0;try{for(var n,o=O.PinPadIds[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var r=n.value,s=this.uiGraph.get(r);s&&this.pinPad.addChild(s)}}catch(a){e=!0,i=a}finally{try{t||null==o.return||o.return()}finally{if(e)throw i}}this.pinPad.visible=!1,this.pinPad.zIndex=3,this.addChild(this.pinPad)},n.initVolumeText=function(){var t=Math.round(100*d.bgmVolume),e=Math.round(10*d.seVolume);this.uiGraph.get("bgm_volume").text=t.toString();this.uiGraph.get("se_volume").text=e.toString()},n.initSound=function(){var t=m.game.loader.resources,e=[O.Audio.Se.OptionTap,O.Audio.Se.ShowNextText,O.Audio.Se.TileTap,O.Audio.Bgm.EscapeBGM,O.Audio.Bgm.EndingBGM],i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;d.createSound(a,t[a].buffer)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},n.update=function(t){if(!this.isPaused)switch(this.state){case Ot.LOADING_RESOURCES:break;case Ot.READY:this.state=Ot.INGAME;break;case Ot.INGAME:case Ot.FINISHED:this.gameLogic.update()}this.updateRegisteredObjects(t),this.transitionIn.isActive()?this.transitionIn.update(t):this.transitionOut.isActive()&&this.transitionOut.update(t)},n.onRoomObjectTapped=function(t){if(!this.messageWindow){d.playSe(O.Audio.Se.OptionTap),this.roomObjects.forEach((function(t,e){t.interactive=!1})),this.tiles.forEach((function(t,e){t.isActive&&t.toggleFrame(),t.interactive=!1}));var e=this.roomObjects.get(t);e&&(this.spawnMessageWindow(e.messageIds),this.gameLogic.onRoomObjectTapped(t))}},n.onPlayerSpawned=function(t){this.tiles.forEach((function(e){e.tilePosition[0]===t.positionRow&&e.tilePosition[1]===t.positionColumn&&(e.interactive=!1)})),this.player=new St(this.playerAnimationMaster,this.tileSize,{x:t.positionColumn*this.tileSize,y:t.positionRow*this.tileSize-this.tileSize/3}),this.player.sprite.zIndex=2,this.addChild(this.player.sprite),this.registerUpdatingObject(this.player),this.sortChildren()},n.onPlayerEntityStateChanged=function(t){if(t.state===yt.IDLE&&(this.player.requestAnimation(O.AnimationTypes.Player.WAIT),this.tiles.forEach((function(e){t.positionRow===e.tilePosition[0]&&t.positionColumn===e.tilePosition[1]?e.interactive=!1:e.interactive=!0})),this.roomObjects.forEach((function(e,i){var n=!0,o=!1,r=void 0;try{for(var s,a=e.downTiles[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;(u[0]===t.positionRow-1&&u[1]===t.positionColumn||u[0]===t.positionRow+1&&u[1]===t.positionColumn||u[0]===t.positionRow&&u[1]===t.positionColumn-1||u[0]===t.positionRow&&u[1]===t.positionColumn+1)&&(e.interactive=!0)}}catch(c){o=!0,r=c}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}}))),t.state===yt.WALK&&this.roomObjects.forEach((function(t,e){t.interactive=!1})),t.state===yt.CHECKING){if(t.checkingObject===O.RoomObjects.CLOCK)return void this.player.requestAnimation(O.AnimationTypes.Player.CHACKUP);if(null===t.checkingObject)return;var e=this.roomObjects.get(t.checkingObject);if(!e)return;var i=0,n=0,o=0,r=0,s=!0,a=!1,u=void 0;try{for(var c,l=e.downTiles[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var h=c.value;h[0]<t.positionRow?i++:h[0]>t.positionRow&&n++,h[1]<t.positionColumn?o++:h[1]>t.positionColumn&&r++}}catch(p){a=!0,u=p}finally{try{s||null==l.return||l.return()}finally{if(a)throw u}}i===e.downTiles.length?this.player.requestAnimation(O.AnimationTypes.Player.CHACKUP):n===e.downTiles.length?this.player.requestAnimation(O.AnimationTypes.Player.CHACKDOWN):o===e.downTiles.length?this.player.requestAnimation(O.AnimationTypes.Player.CHACKLEFT):r===e.downTiles.length&&this.player.requestAnimation(O.AnimationTypes.Player.CHACKRIGHT)}},n.onBgmArrowTapped=function(t){var e=d.bgmVolume;(e+=t)<0?e=0:e>.1&&(e=.1);this.uiGraph.get("bgm_volume").text=Math.round(100*e).toString(),d.bgmVolume=e,d.playSe(O.Audio.Se.OptionTap),this.saveBgmVolumeToDB(d.bgmVolume),d.setSoundVolume(d.bgmVolume,d.seVolume)},n.onSeArrowTapped=function(t){var e=d.seVolume;(e+=t)<0?e=0:e>1&&(e=1);this.uiGraph.get("se_volume").text=Math.round(10*e).toString(),d.seVolume=e,d.playSe(O.Audio.Se.OptionTap),this.saveSeVolumeToDB(d.seVolume)},n.onPinPadTapped=function(t){if(d.playSe(O.Audio.Se.OptionTap),!(this.code.length>=3)){var e;this.code.push(t),e=1===this.code.length?"first":2===this.code.length?"second":"third";var i=this.uiGraph.get("code_".concat(e));i&&(i.text=t.toString())}},n.onPinPadCancelTapped=function(){if(d.playSe(O.Audio.Se.OptionTap),0!==this.code.length){var t;this.code.pop(),t=0===this.code.length?"first":1===this.code.length?"second":"third";var e=this.uiGraph.get("code_".concat(t));e&&(e.text="")}},n.onPinPadEnterTapped=function(){this.gameLogic.onRoomObjectTapped("safe"),d.playSe(O.Audio.Se.OptionTap),this.isPaused=!1;var t=this.uiGraph.get("code_first"),e=this.uiGraph.get("code_second"),i=this.uiGraph.get("code_third");if(t&&e&&i){if(t.text="",e.text="",i.text="",this.code[0]===this.correctCode[0]&&this.code[1]===this.correctCode[1]&&this.code[2]===this.correctCode[2]){this.spawnMessageWindow(["safe_opened","there_is_crossbow",["get_crossbow","do_nothing"]]);var n=this.roomObjects.get("safe");if(!n)return;n.messageIds.pop(),n.messageIds=["safe_message_1","there_is_crossbow",["get_crossbow","do_nothing"]],this.saveRoomObjectToDB(O.RoomObjects.SAFE,Ke.MessageIds,n.messageIds)}else{this.spawnMessageWindow(["wrong_code"])}this.pinPad.visible=!1,this.code=[]}},n.spawnMessageWindow=function(t){this.messages.forEach((function(t,e){t.visible=!0})),this.options.forEach((function(t,e){t.visible=!0}));var e=this.createMessages(t),i=new fe(e,this);i.zIndex=3,this.messageWindow=i,this.addChild(i),this.registerUpdatingObject(i)},n.createMessages=function(t){var e=[],i=!0,n=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value,u=[];if("string"===typeof a){var c=this.messages.get(a);if(!c)continue;e.push(c)}else{var l=!0,h=!1,p=void 0;try{for(var f,d=a[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var m=f.value,y=this.options.get(m);y&&u.push(y)}}catch(g){h=!0,p=g}finally{try{l||null==d.return||d.return()}finally{if(h)throw p}}e.push(u)}}}catch(g){n=!0,o=g}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return e},n.onMessageWindowClosed=function(){this.gameLogic.onChackingEnd(),this.messageWindow=null},n.onOptionSelected=function(t){if(t!==bt.DoNoting){if(t!==bt.ShowItemOption)return t===bt.ShowPinPad?(this.isPaused=!0,void(this.pinPad.visible=!0)):t===bt.BackToTitle?(this.visible=!1,void this.showTitleScene()):void this.gameLogic.onOptionSelected(t);var e=this,i=[];if(this.itemPanels.forEach((function(t,n){if(t.hasItem){var o=e.options.get(t.optionId);if(!o)return;i.push(o)}})),0===i.length){var n,o=this.messages.get("has_no_item");if(!o)return;null===(n=this.messageWindow)||void 0===n||n.addText(o,1)}else{var r;null===(r=this.messageWindow)||void 0===r||r.addText(i,1)}}},n.onItemUsed=function(t,e,i){var n=this.roomObjects.get(e.id);if(n)if(t===bt.UseTinStatue&&e.id===O.RoomObjects.GAS_STOVE){var o,r,s=this.messages.get("tin_statue_melted"),u=this.messages.get("get_coin");if(!s)return;if(!u)return;null===(o=this.messageWindow)||void 0===o||o.addText(s,1),null===(r=this.messageWindow)||void 0===r||r.addText(u,2),n.messageIds.pop(),n.messageIds.pop(),this.saveRoomObjectToDB(O.RoomObjects.GAS_STOVE,Ke.MessageIds,n.messageIds)}else if(t===bt.UseDVD&&e.id===O.RoomObjects.TV){var c,l,h=this.messages.get("serching"),p=this.messages.get("watched_dvd");if(!h)return;if(!p)return;null===(c=this.messageWindow)||void 0===c||c.addText(h,1),null===(l=this.messageWindow)||void 0===l||l.addText(p,2)}else if(t===bt.UseCoin&&e.id===O.RoomObjects.VENDING_MACHINE){var f,d=this.messages.get("get_banana");if(!d)return;null===(f=this.messageWindow)||void 0===f||f.addText(d,1),n.messageIds.pop(),this.saveRoomObjectToDB(O.RoomObjects.VENDING_MACHINE,Ke.MessageIds,n.messageIds)}else if(t===bt.UseBanana&&e.id===O.RoomObjects.FREEZER){var y,g=this.messages.get("freeze_banana");if(!g)return;null===(y=this.messageWindow)||void 0===y||y.addText(g,1),n.messageIds.pop(),this.saveRoomObjectToDB(O.RoomObjects.FREEZER,Ke.MessageIds,n.messageIds)}else if(t===bt.UseSalt&&e.id===O.RoomObjects.BARREL){var v,w,S=this.messages.get("put_salt_in_barrel"),_=this.messages.get("get_desk_key");if(!S)return;if(!_)return;null===(v=this.messageWindow)||void 0===v||v.addText(S,1),null===(w=this.messageWindow)||void 0===w||w.addText(_,2),n.messageIds.pop(),n.messageIds.pop(),this.saveRoomObjectToDB(O.RoomObjects.BARREL,Ke.MessageIds,n.messageIds)}else if(t===bt.UseDeskKey&&e.id===O.RoomObjects.DESK){var E,T,R,I=[],j=this.messages.get("unlock"),C=this.messages.get("there_is_pencil"),x=this.options.get("get_pencil"),P=this.options.get("do_nothing");if(!j)return;if(!C)return;if(!x)return;if(!P)return;I.push(x),I.push(P),null===(E=this.messageWindow)||void 0===E||E.addText(j,1),null===(T=this.messageWindow)||void 0===T||T.addText(C,2),null===(R=this.messageWindow)||void 0===R||R.addText(I,3)}else if(t===bt.UsePencil&&e.id===O.RoomObjects.GRINDER){var A,B,D=this.messages.get("grind_pencil"),N=this.messages.get("get_sharpened_pencil");if(!D)return;if(!N)return;null===(A=this.messageWindow)||void 0===A||A.addText(D,1),null===(B=this.messageWindow)||void 0===B||B.addText(N,2),n.messageIds.pop(),this.saveRoomObjectToDB(O.RoomObjects.GRINDER,Ke.MessageIds,n.messageIds)}else if(t===bt.UseDetergent&&e.id===O.RoomObjects.MIRROR){var k,U,M,G=[],W=this.messages.get("washed_mirror"),L=this.messages.get("mirror_message_3"),F=this.options.get("use_item"),V=this.options.get("do_nothing");if(!W)return;if(!L)return;if(!F)return;if(!V)return;G.push(F),G.push(V),null===(k=this.messageWindow)||void 0===k||k.addText(W,1),null===(U=this.messageWindow)||void 0===U||U.addText(L,2),null===(M=this.messageWindow)||void 0===M||M.addText(G,3),n.messageIds[1]="mirror_message_3",this.saveRoomObjectToDB(O.RoomObjects.MIRROR,Ke.MessageIds,n.messageIds);var H=a.P6Y.kN["room_object/mirror.png"];n.sprite.texture=H,this.saveRoomObjectToDB(O.RoomObjects.MIRROR,Ke.TextureName,"room_object/mirror.png")}else if(t===bt.UseHandMirror&&e.id===O.RoomObjects.MIRROR&&-1!==e.states.indexOf(vt.Washed)){var z,K=this.messages.get("mirror_message_4");if(!K)return;null===(z=this.messageWindow)||void 0===z||z.addText(K,1)}else if(t===bt.UseCarKey&&e.id===O.RoomObjects.CAR){var Y=this;this.isPaused=!0,this.beginTransitionOut((function(){Y.isPaused=!1,Y.player.sprite.position.set(456.4,426.6);var t=m.game.loader.resources[O.UI.Stage].data.carMovedMapData;Y.resetTiles(t),Y.saveData.mapData=t,Y.saveProgressToDB(),n.position.x=380,Y.saveRoomObjectToDB(O.RoomObjects.CAR,Ke.Position,[n.position.x,n.position.y]),n.downTiles=[[8,6],[8,7],[8,8],[9,6],[9,7],[9,8]],Y.saveRoomObjectToDB(O.RoomObjects.CAR,Ke.DownTiles,n.downTiles),Y.spawnMessageWindow(["moved_car"]),Y.beginTransitionIn((function(){})),n.messageIds.pop(),Y.saveRoomObjectToDB(O.RoomObjects.CAR,Ke.MessageIds,n.messageIds)}),!1)}else if(t===bt.UseCrossBow&&e.id===O.RoomObjects.BALLOON&&-1!==(null===i||void 0===i?void 0:i.indexOf(b.SHARPENED_PENCIL))){var q=this;this.isPaused=!0,this.beginTransitionOut((function(){q.isPaused=!1,n.sprite.visible=!1,q.saveRoomObjectToDB(O.RoomObjects.BALLOON,Ke.Visible,n.sprite.visible);var t=q.tiles.get(65);t&&(t.tileSprite.texture=a.P6Y.kN["stage/floor.png"],q.saveData.isBalloonExist=!1,q.saveProgressToDB(),q.spawnMessageWindow(["find_nail","get_nail"]),q.gameLogic.onRoomObjectTapped(O.RoomObjects.BALLOON),q.beginTransitionIn((function(){})))}),!1)}else if(t===bt.UseFrozenBanana&&e.id===O.RoomObjects.CHAIR&&-1!==(null===i||void 0===i?void 0:i.indexOf(b.NAIL))){var J=this;this.isPaused=!0,this.beginTransitionOut((function(){J.isPaused=!1;var t=a.P6Y.kN["room_object/chair.png"];n.sprite.texture=t,J.saveRoomObjectToDB(O.RoomObjects.CHAIR,Ke.TextureName,"room_object/chair.png"),n.position.set(205,85),J.saveRoomObjectToDB(O.RoomObjects.CHAIR,Ke.Position,[n.position.x,n.position.y]),n.messageIds=["chair_message_1"],J.saveRoomObjectToDB(O.RoomObjects.CHAIR,Ke.MessageIds,n.messageIds),J.spawnMessageWindow(["fix_chair"]),J.gameLogic.onRoomObjectTapped(O.RoomObjects.CHAIR),J.beginTransitionIn((function(){}))}),!1);var Z=this.roomObjects.get("clock");if(!Z)return;Z.messageIds=["clock_message_2","clock_message_3",["set_clock","do_nothing"]],this.saveRoomObjectToDB(O.RoomObjects.CLOCK,Ke.MessageIds,Z.messageIds)}else{var X,$=this.messages.get("can_not_use");if(!$)return;null===(X=this.messageWindow)||void 0===X||X.addText($,1)}},n.onPlayerItemsChanged=function(t){this.saveData.playerItems=t,this.saveProgressToDB(),this.menu.updateItemPanels(t)},n.onRoomObjectOptionSelected=function(t,e){var i=this.roomObjects.get(t.id);if(i){if(e===bt.CheckUnderBed)if(-1===t.states.indexOf(vt.CheckedUnderBed)){var n,o,r=this.messages.get("serching"),s=this.messages.get("get_tin_statue");if(!r)return;if(!s)return;null===(n=this.messageWindow)||void 0===n||n.addText(r,1),null===(o=this.messageWindow)||void 0===o||o.addText(s,2)}else{var u,c=this.messages.get(O.MessageIds.NothingSpecial);if(!c)return;null===(u=this.messageWindow)||void 0===u||u.addText(c,1)}if(e===bt.CheckUnderPillow)if(-1===t.states.indexOf(vt.CheckedUnderPillow)){var l,h,p=this.messages.get("serching"),f=this.messages.get("get_hand_mirror");if(!p)return;if(!f)return;null===(l=this.messageWindow)||void 0===l||l.addText(p,1),null===(h=this.messageWindow)||void 0===h||h.addText(f,2)}else{var d,y=this.messages.get(O.MessageIds.NothingSpecial);if(!y)return;null===(d=this.messageWindow)||void 0===d||d.addText(y,1)}if(e===bt.JumpOnBed)if(-1===t.states.indexOf(vt.JumpedOnBed)){var g,v=this.messages.get("something_on_closet");if(!v)return;null===(g=this.messageWindow)||void 0===g||g.addText(v,1);var b=this.roomObjects.get(O.RoomObjects.CLOSET),w=null===b||void 0===b?void 0:b.messageIds[b.messageIds.length-1];R=w,(null!=(I=Array)&&"undefined"!==typeof Symbol&&I[Symbol.hasInstance]?I[Symbol.hasInstance](R):R instanceof I)&&w.unshift("check_on_closet"),this.saveRoomObjectToDB(O.RoomObjects.CLOSET,Ke.MessageIds,null===b||void 0===b?void 0:b.messageIds)}else if(-1===t.states.indexOf(vt.GotCarKey)){var S,_=this.messages.get("something_on_closet");if(!_)return;null===(S=this.messageWindow)||void 0===S||S.addText(_,1)}else{var E,T=this.messages.get("have_a_fun");if(!T)return;null===(E=this.messageWindow)||void 0===E||E.addText(T,1)}var R,I;if(e===bt.CheckInCloset)if(-1===t.states.indexOf(vt.CheckedInCloset)){var j,C,x=this.messages.get("serching"),P=this.messages.get("get_detergent");if(!x)return;if(!P)return;null===(j=this.messageWindow)||void 0===j||j.addText(x,1),null===(C=this.messageWindow)||void 0===C||C.addText(P,2)}else{var A,B=this.messages.get(O.MessageIds.NothingSpecial);if(!B)return;null===(A=this.messageWindow)||void 0===A||A.addText(B,1)}if(e===bt.CheckOnCloset)if(-1===t.states.indexOf(vt.CheckedOnCloset)){var D,N,k=this.messages.get("serching"),U=this.messages.get("get_car_key");if(!k)return;if(!U)return;null===(D=this.messageWindow)||void 0===D||D.addText(k,1),null===(N=this.messageWindow)||void 0===N||N.addText(U,2)}else{var M,G=this.messages.get(O.MessageIds.NothingSpecial);if(!G)return;null===(M=this.messageWindow)||void 0===M||M.addText(G,1)}if(e===bt.GetSalt){var W,L=this.messages.get("get_salt");if(!L)return;null===(W=this.messageWindow)||void 0===W||W.addText(L,1),i.messageIds.pop(),i.messageIds.pop(),this.saveRoomObjectToDB(O.RoomObjects.CABINET,Ke.MessageIds,i.messageIds)}if(e===bt.GetCrossbow){var F,V=this.messages.get("get_crossbow");if(!V)return;null===(F=this.messageWindow)||void 0===F||F.addText(V,1),i.messageIds.pop(),i.messageIds.pop(),this.saveRoomObjectToDB(O.RoomObjects.SAFE,Ke.MessageIds,i.messageIds)}if(e===bt.GetDVD){var H,z=this.messages.get("get_dvd");if(!z)return;null===(H=this.messageWindow)||void 0===H||H.addText(z,1)}if(e===bt.CheckRightDrawer)if(-1===t.states.indexOf(vt.UsedKey)){var K,Y,q=[],J=this.messages.get("locked"),Z=this.options.get("use_item"),X=this.options.get("do_nothing");if(!J)return;if(!Z)return;if(!X)return;q.push(Z),q.push(X),null===(K=this.messageWindow)||void 0===K||K.addText(J,1),null===(Y=this.messageWindow)||void 0===Y||Y.addText(q,2)}else if(-1===t.states.indexOf(vt.HasNoPencil)){var $,Q,tt=[],et=this.messages.get("there_is_pencil"),it=this.options.get("get_pencil"),nt=this.options.get("do_nothing");if(!et)return;if(!it)return;if(!nt)return;tt.push(it),tt.push(nt),null===($=this.messageWindow)||void 0===$||$.addText(et,1),null===(Q=this.messageWindow)||void 0===Q||Q.addText(tt,2)}else{var ot,rt=this.messages.get(O.MessageIds.NothingSpecial);if(!rt)return;null===(ot=this.messageWindow)||void 0===ot||ot.addText(rt,1)}if(e===bt.CheckLeftDrawer)if(-1===t.states.indexOf(vt.HasNoDVD)){var st,at,ut=[],ct=this.messages.get("there_is_dvd"),lt=this.options.get("get_dvd"),ht=this.options.get("do_nothing");if(!ct)return;if(!lt)return;if(!ht)return;ut.push(lt),ut.push(ht),null===(st=this.messageWindow)||void 0===st||st.addText(ct,1),null===(at=this.messageWindow)||void 0===at||at.addText(ut,2)}else{var pt,ft=this.messages.get(O.MessageIds.NothingSpecial);if(!ft)return;null===(pt=this.messageWindow)||void 0===pt||pt.addText(ft,1)}if(e===bt.GetPenCil){var dt,mt=this.messages.get("get_pencil");if(!mt)return;null===(dt=this.messageWindow)||void 0===dt||dt.addText(mt,1)}if(e===bt.MovePig){var yt,gt=this.messages.get("not_move");if(!gt)return;null===(yt=this.messageWindow)||void 0===yt||yt.addText(gt,1)}if(e===bt.ReadHint){var wt,Ot=[],St=this.options.get("hint_1"),_t=this.options.get("hint_2");if(!St)return;if(!_t)return;Ot.push(St),Ot.push(_t),null===(wt=this.messageWindow)||void 0===wt||wt.addText(Ot,1)}if(e===bt.ReadHint1){var Et,Tt=this.messages.get("hint_1");if(!Tt)return;null===(Et=this.messageWindow)||void 0===Et||Et.addText(Tt,1)}if(e===bt.ReadHint2){var Rt,It=this.messages.get("hint_2");if(!It)return;null===(Rt=this.messageWindow)||void 0===Rt||Rt.addText(It,1)}if(e===bt.SetTime){var jt=this;this.isPaused=!0,this.beginTransitionOut((function(){jt.isPaused=!1;var t=m.game.loader.resources[O.UI.Stage].data.pigMovedMapData;jt.resetTiles(t),jt.saveData.mapData=t,jt.saveProgressToDB();var e=jt.roomObjects.get("pig");if(e){var n=a.P6Y.kN["room_object/pig2.png"],o=a.P6Y.kN["room_object/clock_12_00.png"];e.sprite.texture=n,jt.saveRoomObjectToDB(O.RoomObjects.PIG,Ke.TextureName,"room_object/pig2.png"),i.sprite.texture=o,jt.saveRoomObjectToDB(O.RoomObjects.CLOCK,Ke.TextureName,"room_object/clock_12_00.png"),e.position.set(40,565),jt.saveRoomObjectToDB(O.RoomObjects.PIG,Ke.Position,[e.position.x,e.position.y]),e.downTiles=[[9,1]],jt.saveRoomObjectToDB(O.RoomObjects.PIG,Ke.DownTiles,e.downTiles),e.messageIds=["pig_message_2"],jt.saveRoomObjectToDB(O.RoomObjects.PIG,Ke.MessageIds,e.messageIds),jt.spawnMessageWindow(["moved_pig"]),jt.beginTransitionIn((function(){})),i.messageIds.pop(),i.messageIds.pop(),jt.saveRoomObjectToDB(O.RoomObjects.CLOCK,Ke.MessageIds,i.messageIds)}}),!1)}}},n.onPlayerEntityWalked=function(t){switch(t.walkDirection){case dt.UP:this.player.requestAnimation(O.AnimationTypes.Player.WALKUP);break;case dt.DOWN:this.player.requestAnimation(O.AnimationTypes.Player.WALKDOWN);break;case dt.LEFT:this.player.requestAnimation(O.AnimationTypes.Player.WALKLEFT);break;case dt.RIGHT:this.player.requestAnimation(O.AnimationTypes.Player.WALKRIGHT)}if(this.tiles.forEach((function(e){t.positionRow===e.tilePosition[0]&&t.positionColumn===e.tilePosition[1]?e.interactive=!1:e.interactive=!0})),t.walkDirection===dt.UP||t.walkDirection===dt.DOWN?this.player.sprite.y=this.player.spawnedPosition.y+t.distanceRow:this.player.sprite.x=this.player.spawnedPosition.x+t.distanceColumn,3===t.positionRow&&4===t.positionColumn||3===t.positionRow&&5===t.positionColumn||3===t.positionRow&&6===t.positionColumn||4===t.positionRow&&4===t.positionColumn||4===t.positionRow&&5===t.positionColumn||4===t.positionRow&&6===t.positionColumn||5===t.positionRow&&5===t.positionColumn){if(0===this.player.sprite.zIndex)return;this.player.sprite.zIndex=0,this.sortChildren()}else{if(2===this.player.sprite.zIndex)return;this.player.sprite.zIndex=2,this.sortChildren()}},n.onTileTapped=function(t){var e=this;if(!this.isPaused&&!this.messageWindow){var i=!1;this.tiles.forEach((function(n){n.isActive&&t.tilePosition[0]===n.tilePosition[0]&&t.tilePosition[1]===n.tilePosition[1]?(e.gameLogic.requestWalk(t.tilePosition),t.toggleFrame(),i=!0):n.isActive&&(n.toggleFrame(),i=!0)})),!1===i&&t.toggleFrame()}},n.initRoomObject=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,u=this.roomObjects.get(s.id);if(!u)return;if(s.downTiles&&(u.downTiles=s.downTiles),s.messageIds&&(u.messageIds=s.messageIds),s.position&&u.position.set(s.position[0],s.position[1]),s.textureName){var c=a.P6Y.kN[s.textureName];u.sprite.texture=c}void 0!==s.visible&&(u.sprite.visible=s.visible)}}catch(l){i=!0,n=l}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.initTiles=function(t,e){for(var i=this,n=function(n){for(var r=i,s=function(i){var o=r,s=a[i],u=new jt(s,[n,i],e);u.position.set(i*r.tileSize,n*r.tileSize),1!==t.mapData[n][i]&&(u.touchable=!0,u.interactive=!0),u.on("pointertap",(function(){o.onTileTapped(u)}));var c=n.toString(),l=i.toString();r.tiles.set(Number(c+l),u),r.addChild(u)},a=o[n],u=0;u<a.length;u++)s(u)},o=t.tileData,r=0;r<o.length;r++)n(r)},n.onGameOver=function(){var t=this;this.isPaused=!0,this.menu.visible=!1,this.soundOption.visible=!1,this.deleteSaveData(),d.destroySound(O.Audio.Bgm.EscapeBGM),this.beginTransitionOut((function(){d.playBgm(O.Audio.Bgm.EndingBGM,6),t.spawnMessageWindow(["serching","wake_message_1","wake_message_2","wake_message_3","thanks_message",["back_to_title_2"]])})),this.state=Ot.FINISHED},n.getCustomUiGraphFactory=function(t){return"room_object"===t?new Vt:"text_option"===t||"menu_text_option"===t?new re:"sprite_option"===t?new xe:"item_panel"===t?new ze:null},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=V.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),"room_object"===s.type?(this.roomObjects.set(s.id,u),this.saveData.roomObject.push({id:s.id})):"message"===s.type?this.messages.set(s.id,u):"menu_text"===s.type||"menu_text_option"===s.type?this.menuTexts.set(s.id,u):"text_option"===s.type||"sprite_option"===s.type?this.options.set(s.id,u):"item_panel"===s.type?this.itemPanels.push(u):this.uiGraph.set(s.id,u),"room_object"===s.type&&this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.resetTiles=function(t){for(var e=0;e<t.length;e++)for(var i=t[e],n=0;n<i.length;n++){var o=t[e][n],r=e.toString(),s=n.toString(),a=this.tiles.get(Number(r+s));a&&(0===o?(a.touchable=!0,a.interactive=!0):(a.touchable=!1,a.interactive=!1))}},n.showTitleScene=function(){d.paused=!1,d.sceneIsPaused=!1,this.destroySound(),m.loadScene(new si)},n.saveRoomObjectToDB=function(t,e,i){var n=!0,o=!1,r=void 0;try{for(var s,a=this.saveData.roomObject[Symbol.iterator]();!(n=(s=a.next()).done);n=!0){var u=s.value;if(u.id===t)switch(e){case"downTiles":u.downTiles=i;break;case"messageIds":u.messageIds=i;break;case"position":u.position=i;break;case"textureName":u.textureName=i;break;case"visible":u.visible=i}}}catch(c){o=!0,r=c}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}this.saveProgressToDB()},n.saveProgressToDB=function(){p.put("saveData",this.saveData)},n.loadSaveDataFromDB=function(t,e){var i=this;p.get("saveData",(function(n){if(n){if(i.saveData=n,i.initRoomObject(i.saveData.roomObject),void 0!==i.saveData.mapData&&i.resetTiles(i.saveData.mapData),0!==i.saveData.playerItems.length&&i.menu.updateItemPanels(i.saveData.playerItems),0!==i.saveData.code.length&&(i.correctCode=i.saveData.code),!i.saveData.isBalloonExist){var o=i.tiles.get(65);if(!o)return;o.tileSprite.texture=a.P6Y.kN["stage/floor.png"]}}else{i.spawnMessageWindow(["start_escape"]);for(var r=0;r<3;r++){var s=Math.floor(10*Math.random());i.correctCode.push(s)}i.saveData.code=i.correctCode,i.saveProgressToDB()}i.initCode(),i.gameLogic.init({delegator:i,stageMaster:t,roomObjectMaster:e,saveData:i.saveData}),i.transitionIn.isFinished()?i.state=Ot.READY:i.state=Ot.RESOURCE_LOADED}))},n.saveBgmVolumeToDB=function(t){p.put("bgmVolume",t)},n.saveSeVolumeToDB=function(t){p.put("seVolume",t)},n.deleteSaveData=function(){p.delete("saveData")},i}(X);function ti(t,e,i){return(ti="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ei(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function ei(t){return(ei=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ii(t,e){return!e||"object"!==oi(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ni(t,e){return(ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var oi=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function ri(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ei(t);if(e){var o=ei(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ii(this,i)}}var si=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ni(t,e)}(i,t);var e=ri(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=e.call(this)).title1MoveRate=0,t.title2MoveRate=0,t.title3MoveRate=0,t.languageOption=new a.W20,t.confirmation=new a.W20,t.hasSaveData=!1,t.sceneName="title_scene",t.transitionIn=new v(1,0,-.02),t.transitionOut=new v(0,1,.02),t.loadSaveDataFromDB(),t}var n=i.prototype;return n.createInitialResourceList=function(){var t=ti(ei(i.prototype),"createInitialResourceList",this).call(this);return t.push(O.Audio.Bgm.TitleBgm),t.push(O.Audio.Se.OptionTap),t},n.update=function(t){ti(ei(i.prototype),"update",this).call(this,t),this.language?(this.updateTitles(),this.updateButtons()):this.elapsedFrameCount=0,90===this.elapsedFrameCount&&this.playBgmIfNeeded()},n.onResourceLoaded=function(){ti(ei(i.prototype),"onResourceLoaded",this).call(this),this.setTitleMoveDistance(),this.languageOption.visible=!1,this.confirmation.visible=!1,this.uiGraphContainer.addChild(this.languageOption),this.uiGraphContainer.addChild(this.confirmation),this.addChild(this.uiGraphContainer),this.loadLanguageFromDB(),this.initSound()},n.initSound=function(){var t=m.game.loader.resources,e=[O.Audio.Se.OptionTap],i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;d.createSound(a,t[a].buffer)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},n.onLanguageSelected=function(t){d.playSe(O.Audio.Se.OptionTap);var e=this.uiGraph.get("new_game"),i=this.uiGraph.get("continue"),n=this.uiGraph.get("option"),o=this.uiGraph.get("credit");e&&i&&n&&o&&(e.interactive=!0,i.interactive=!0,n.interactive=!0,o.interactive=!0,this.languageOption.visible=!1,this.language=t,this.saveLanguageToDB(t))},n.easeOutQuint=function(t){return 1-Math.pow(1-t,5)},n.updateTitles=function(){var t=this.uiGraph.get("title_1"),e=this.uiGraph.get("title_2"),i=this.uiGraph.get("title_3");t&&e&&i&&(t.position.x===this.title1MoveDistance&&e.position.x===this.title2MoveDistance&&i.position.x===this.title3MoveDistance||(t.position.x>=this.title1MoveDistance?t.position.x=this.title1MoveDistance:(this.title1MoveRate+=10/this.title1MoveDistance,t.position.x=this.title1MoveDistance*this.easeOutQuint(this.title1MoveRate)),e.position.x>=this.title2MoveDistance?e.position.x=this.title2MoveDistance:this.elapsedFrameCount>=20&&(this.title2MoveRate+=10/this.title2MoveDistance,e.position.x=this.title2MoveDistance*this.easeOutQuint(this.title2MoveRate)),i.position.x>=this.title3MoveDistance?i.position.x=this.title3MoveDistance:this.elapsedFrameCount>=40&&(this.title3MoveRate+=10/this.title3MoveDistance,i.position.x=this.title3MoveDistance*this.easeOutQuint(this.title3MoveRate))))},n.updateButtons=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("continue_2"),n=this.uiGraph.get("option"),o=this.uiGraph.get("credit");t&&e&&i&&n&&o&&(t.visible&&e.visible||i.visible&&n.visible&&o.visible||this.elapsedFrameCount>=80&&(t.visible=!0,this.hasSaveData?e.visible=!0:i.visible=!0,n.visible=!0,o.visible=!0))},n.setTitleMoveDistance=function(){var t=this.uiGraph.get("title_1"),e=this.uiGraph.get("title_2"),i=this.uiGraph.get("title_3");t&&e&&i&&(this.title1MoveDistance=320+t.width/2,this.title2MoveDistance=320+e.width/2,this.title3MoveDistance=320+i.width/2)},n.newGame=function(){this.isOver||(d.playSe(O.Audio.Se.OptionTap),this.deleteSaveData(),this.onContinueButtonTouched())},n.cancelNewGame=function(){if(!this.isOver){d.playSe(O.Audio.Se.OptionTap);var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("option"),n=this.uiGraph.get("credit");t&&e&&i&&n&&(t.interactive=!0,e.interactive=!0,i.interactive=!0,n.interactive=!0,this.confirmation.visible=!1)}},n.onNewGameButtonTouched=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(d.playSe(O.Audio.Se.OptionTap),this.hasSaveData?this.showConfirmation():this.onContinueButtonTouched())},n.onContinueButtonTouched=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(d.destroySound(O.Audio.Bgm.TitleBgm),d.playSe(O.Audio.Se.OptionTap),m.loadScene(new Qe(this.language)),this.isOver=!0)},n.showOptionScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,d.playSe(O.Audio.Se.OptionTap),m.loadScene(new ot(this.language)))},n.showCreditScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,d.playSe(O.Audio.Se.OptionTap),m.loadScene(new ht))},n.showLanguageOption=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("option"),n=this.uiGraph.get("credit");t&&e&&i&&n&&(t.interactive=!1,e.interactive=!1,i.interactive=!1,n.interactive=!1,this.languageOption.visible=!0)},n.showConfirmation=function(){var t=this.uiGraph.get("new_game"),e=this.uiGraph.get("continue"),i=this.uiGraph.get("option"),n=this.uiGraph.get("credit");t&&e&&i&&n&&(t.interactive=!1,e.interactive=!1,i.interactive=!1,n.interactive=!1,this.confirmation.visible=!0)},n.saveLanguageToDB=function(t){p.put("language",t)},n.loadLanguageFromDB=function(){var t=this;p.get("language",(function(e){if(e?t.language=e:t.showLanguageOption(),"japanese"===e){var i=t.uiGraph.get("confirm_message_english");if(!i)return;i.visible=!1}else{var n=t.uiGraph.get("confirm_message");if(!n)return;n.visible=!1}}))},n.prepareUiGraphContainer=function(t){var e=!0,i=!1,n=void 0;try{for(var o,r=t.nodes[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var s=o.value,a=V.getFactory(s.type)||this.getCustomUiGraphFactory(s.type);if(a){var u=a.createUiNodeByGraphElement(s);u&&(s.events&&a.attachUiEventByGraphElement(s.events,u,this),this.uiGraph.set(s.id,u),"language_option_sprite"===s.type||"language_option_text"===s.type?this.languageOption.addChild(u):"confirmation_sprite"===s.type||"confirmation_text"===s.type?this.confirmation.addChild(u):this.uiGraphContainer.addChild(u))}}}catch(c){i=!0,n=c}finally{try{e||null==r.return||r.return()}finally{if(i)throw n}}},n.playBgmIfNeeded=function(){var t=O.Audio.Bgm.TitleBgm;if(!d.hasSound(t)){var e=m.game.loader.resources[t];d.createSound(t,e.buffer),d.playBgm(t,1.5)}},n.loadSaveDataFromDB=function(){var t=this;p.get("saveData",(function(e){e&&(t.hasSaveData=!0)}))},n.deleteSaveData=function(){p.delete("saveData")},i}(X);function ai(t,e,i){return(ai="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ui(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}function ui(t){return(ui=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ci(t,e){return!e||"object"!==hi(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function li(t,e){return(li=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var hi=function(t){return t&&"undefined"!==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function pi(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=ui(t);if(e){var o=ui(this).constructor;i=Reflect.construct(n,arguments,o)}else i=n.apply(this,arguments);return ci(this,i)}}var fi=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&li(t,e)}(i,t);var e=pi(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(t=e.call(this)).sceneName="start_scene",t.transitionIn=new v(1,0,-.02),t.transitionOut=new v(0,1,.02),t.interactive=!0,t.on("pointerdown",(function(){t.showTitleScene()})),t}var n=i.prototype;return n.createInitialResourceList=function(){var t=ai(ui(i.prototype),"createInitialResourceList",this).call(this);return t.push(O.Audio.Se.OptionTap),t},n.update=function(t){ai(ui(i.prototype),"update",this).call(this,t),this.elapsedFrameCount%40===0&&(this.startButton.visible=!this.startButton.visible)},n.onResourceLoaded=function(){ai(ui(i.prototype),"onResourceLoaded",this).call(this),this.addChild(this.uiGraphContainer);var t=this.uiGraph.get("start_button");t&&(this.startButton=t,this.initSound())},n.initSound=function(){var t=m.game.loader.resources,e=[O.Audio.Se.OptionTap],i=!0,n=!1,o=void 0;try{for(var r,s=e[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var a=r.value;d.createSound(a,t[a].buffer)}}catch(u){n=!0,o=u}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}},n.showTitleScene=function(){this.isOver||this.transitionIn.isActive()||this.transitionOut.isActive()||(this.isOver=!0,d.playSe(O.Audio.Se.OptionTap),m.loadScene(new si))},i}(X);var di=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return t.startGame=function(){t.initGame()},t.initGame=function(){m.start({width:640,height:640,backgroundColor:0}),m.loadScene(new fi)},t}(),mi=i(7294);function yi(){return(0,mi.useEffect)((function(){di.startGame()})),(0,n.jsx)("div",{id:"play-game"})}}}]);